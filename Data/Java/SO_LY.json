[
  "Title: How do I resolve an “externally managed environment” restriction when installing Java libraries on Debian/Ubuntu?\nBody: <p>Error message (paraphrased):</p>\n<blockquote>\n<pre class=\"lang-none prettyprint-override\"><code>The Java environment is externally managed. To install system-wide packages, use the OS package manager. For non-packaged libraries, use a project-specific build tool or a local environment. Overriding this may break the system Java installation.</code></pre>\n</blockquote>\n<p>I use apt update and apt upgrade. How should I install third‑party Java libraries without breaking the system?</p>",
  "Title: Error \"cannot find symbol: method append(Map<String, ?>)\" when adding a row to a Tablesaw Table  \nBody: <p>I’m trying to add a row represented by a <code>Map</code> to a Tablesaw <code>Table</code>, but I get a compile error:</p>\n<blockquote>\n<p>error: cannot find symbol<br/>\nsymbol: method append(java.util.Map&lt;java.lang.String, ?&gt;)</p>\n</blockquote>\n<p>Code snippet:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Table df = ...;\nMap&lt;String, Object&gt; newRow = ...;\n\ndf = df.append(newRow);\n</code></pre>\n<p>I was expecting <code>newRow</code> to be added as a new row.</p>\n<p>How can I fix it?</p>",
  "Title: Why did Spring Boot start failing with “cannot find symbol: method urlQuote in WerkzeugUrls”?\nBody: <p>Environment:</p>\n<pre class=\"lang-none prettyprint-override\"><code>Java 17\nSpring Boot 3.1.2\n</code></pre>\n<p>I run my backend code in a Docker container, with base image:\n<code>FROM eclipse-temurin:17-jre</code></p>\n<p>But when I run tests with <code>JUnit 5.10.0</code>,</p>\n<pre class=\"lang-none prettyprint-override\"><code>mvn test\n</code></pre>\n<p>it raised an error, with logs:</p>\n<pre class=\"lang-none prettyprint-override\"><code>==================================== ERRORS ====================================\n_____________ ERROR collecting tests/test_fiftyone_utils_utils.py ______________\nImportError while importing test module '/builds/kw/data-auto-analysis-toolkit-backend/tests/test_fiftyone_utils_utils.py'.\nHint: make sure your test modules/packages have valid Python names.\nTraceback:\n/opt/conda/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\ntests/test_fiftyone_utils_utils.py:2: in &lt;module&gt;\n    import daat  # noqa: F401\n/opt/conda/lib/python3.10/site-packages/daat-1.0.0-py3.10.egg/daat/__init__.py:1: in &lt;module&gt;\n    from daat.app import app\n/opt/conda/lib/python3.10/site-packages/daat-1.0.0-py3.10.egg/daat/app/__init__.py:6: in &lt;module&gt;\n    from flask import Flask, jsonify, request\n/opt/conda/lib/python3.10/site-packages/flask/__init__.py:5: in &lt;module&gt;\n    from .app import Flask as Flask\n/opt/conda/lib/python3.10/site-packages/flask/app.py:30: in &lt;module&gt;\n    from werkzeug.urls import url_quote\nE   ImportError: cannot import name 'url_quote' from 'werkzeug.urls' (/opt/conda/lib/python3.10/site-packages/werkzeug/urls.py)\n</code></pre>\n<p>My code works well when I directly run it with <code>java -jar app.jar</code>.</p>\n<p><code>Application.java</code> shown below:</p>\n<pre><code>import org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n@SpringBootApplication\npublic class Application {\n    public static void main(String[] args) {\n        SpringApplication.run(Application.class, args);\n    }\n}\n</code></pre>\n<p>I guess it should be the test dependency versions issue, because it used to work well without changing any related code, and I use default versions pulled by Maven without pinning them.</p>\n<p>And my backend runs well without tests.</p>",
  "Title: OpenAI ChatGPT (GPT-3.5) API error 429: \"You exceeded your current quota, please check your plan and billing details\"\nBody: I'm making a Java program to call OpenAI's API. However, I'm getting this error:\n\n> HTTP 429: You exceeded your current quota, please check your plan and billing details\n\nMy code is the following:\n\n```java\nimport java.net.URI;\nimport java.net.http.HttpClient;\nimport java.net.http.HttpRequest;\nimport java.net.http.HttpResponse;\n\npublic class OpenAIChat {\n    public static void main(String[] args) throws Exception {\n        String apiKey = \"<My API Key>\";\n\n        String json = \"\"\"\n        {\n          \"model\": \"gpt-3.5-turbo\",\n          \"messages\": [\n            {\"role\": \"user\", \"content\": \"Tell the world about the ChatGPT API in the style of a pirate.\"}\n          ]\n        }\n        \"\"\";\n\n        HttpClient client = HttpClient.newHttpClient();\n        HttpRequest request = HttpRequest.newBuilder()\n                .uri(URI.create(\"https://api.openai.com/v1/chat/completions\"))\n                .header(\"Authorization\", \"Bearer \" + apiKey)\n                .header(\"Content-Type\", \"application/json\")\n                .POST(HttpRequest.BodyPublishers.ofString(json))\n                .build();\n\n        HttpResponse<String> response = client.send(request, HttpResponse.BodyHandlers.ofString());\n        System.out.println(response.statusCode());\n        System.out.println(response.body());\n    }\n}\n```\n\nI'm using Java 17 and haven't made any successful API requests yet, so I expected this to work. Is there something wrong with my code, or am I missing a billing or quota setup step?",
  "Title: SSL/TLS provider error after adding the OpenAI Java SDK: LibreSSL 2.8.3 vs OpenSSL 1.1.1+\n\nBody: <p>After adding the OpenAI Java SDK from Maven Central, my program fails at startup with an SSL/TLS provider error that mentions LibreSSL 2.8.3 and says it needs OpenSSL 1.1.1+.</p>\n<p>I just followed a tutorial and the very first step was to add the dependency and run a simple request, but I get stuck immediately. Here is the simplified code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class Main {\n    public static void main(String[] args) {\n        // minimal OpenAI SDK call here\n    }\n}</code></pre>\n<p>And here is the runtime error (abridged):</p>\n<pre class=\"lang-none prettyprint-override\"><code>Exception in thread \"main\" javax.net.ssl.SSLHandshakeException: ...\n... SSL provider is LibreSSL 2.8.3, requires OpenSSL 1.1.1+ ...\n</code></pre>\n<p>I tried upgrading the SDK dependency to the latest version, but the error persists. How can I fix this on macOS?</p>",
  "Title: Error updating Maven dependencies: java.lang.UnsatisfiedLinkError: no libssl in java.library.path\nBody: <p>I'm getting an error when resolving/updating any Maven dependency in Java. Purging and reinstalling <code>maven</code> and the JDK hasn't helped. Here's the error I get when running <code>mvn -U dependency:resolve</code> (but it's the same for any <code>mvn</code> build that downloads dependencies):</p>\n<pre><code>java.lang.UnsatisfiedLinkError: no libssl in java.library.path: [/usr/lib/jvm/java-11-openjdk-amd64/lib]\n    at java.base/java.lang.ClassLoader.loadLibrary(ClassLoader.java:2670)\n    at java.base/java.lang.Runtime.loadLibrary0(Runtime.java:830)\n    at java.base/java.lang.System.loadLibrary(System.java:1873)\n    at org.conscrypt.NativeCrypto.<clinit>(NativeCrypto.java:122)\n    at org.conscrypt.OpenSSLProvider.<init>(OpenSSLProvider.java:71)\n    at org.conscrypt.OpenSSLProvider.<init>(OpenSSLProvider.java:56)\n    at org.conscrypt.OpenSSLProvider.<init>(OpenSSLProvider.java:49)\n    at org.conscrypt.Conscrypt.newProvider(Conscrypt.java:111)\n    at org.conscrypt.Conscrypt.newProvider(Conscrypt.java:97)\n    at org.conscrypt.Conscrypt.newProvider(Conscrypt.java:75)\n    at org.conscrypt.Conscrypt.newProvider(Conscrypt.java:68)\n    at com.mycompany.build.MavenResolver.configureSsl(MavenResolver.java:42)\n    at com.mycompany.build.MavenResolver.resolve(MavenResolver.java:29)\n    at com.mycompany.build.Main.main(Main.java:15)\n</code></pre>\n<p>I'm running Ubuntu 20.04 in WSL. OpenSSL is already installed.</p>\n<pre><code>sudo apt install libssl-dev\nReading package lists... Done\nBuilding dependency tree       \nReading state information... Done\nlibssl-dev is already the newest version (1.1.1f-1ubuntu2.22).\n0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.\n</code></pre>\n<p>My assumption is that I need to reinstall some native libraries, but I'm not sure what. I've tried the obvious stuff like <code>libssl-dev</code>, <code>libffi-dev</code>, <code>maven</code>, and <code>openjdk-11-jdk</code> altogether.</p>",
  "Title: Error: Unable to extract uploader id - YouTube, JDA\nBody: <p>I have a Discord music bot written in Java (JDA) that plays audio in voice channels. It pulls audio from YouTube using <code>youtube-dl</code>. It <strong>worked perfectly before</strong> but now it fails with any video. I updated <code>youtube-dl</code> but the problem persists, and I can’t find a solution.</p>\n<p>This is the error: <code>Error: Unable to extract uploader id</code></p>\n<p>There’s no additional output before or after the error. Can anyone help?</p>\n<p>Here’s the relevant setup and code:</p>\n<pre><code>Map&lt;String, String&gt; ytdlOptions = new HashMap&lt;&gt;();\nytdlOptions.put(\"format\", \"bestaudio/best\");\nytdlOptions.put(\"outtmpl\", \"%(extractor)s-%(id)s-%(title)s.%(ext)s\");\nytdlOptions.put(\"restrictfilenames\", \"true\");\nytdlOptions.put(\"noplaylist\", \"true\");\nytdlOptions.put(\"nocheckcertificate\", \"true\");\nytdlOptions.put(\"ignoreerrors\", \"false\");\nytdlOptions.put(\"quiet\", \"true\");\nytdlOptions.put(\"no_warnings\", \"true\");\nytdlOptions.put(\"default_search\", \"auto\");\nytdlOptions.put(\"source_address\", \"0.0.0.0\"); // bind to ipv4 since ipv6 causes issues sometimes\n\n// Running youtube-dl via ProcessBuilder\nList&lt;String&gt; command = new ArrayList&lt;&gt;();\ncommand.add(\"youtube-dl\");\nfor (Map.Entry&lt;String, String&gt; e : ytdlOptions.entrySet()) {\n    command.add(\"--\" + e.getKey().replace(\"_\", \"-\"));\n    if (!\"true\".equals(e.getValue())) {\n        command.add(e.getValue());\n    }\n}\ncommand.add(url);\n\nProcessBuilder pb = new ProcessBuilder(command);\npb.redirectErrorStream(true);\nProcess process = pb.start();\n</code></pre>\n<p>Approximately how I start audio playback with JDA:</p>\n<pre><code>AudioChannel channel = member.getVoiceState().getChannel();\nguild.getAudioManager().openAudioConnection(channel);\n\nString url = matcher.group(1);\nString streamUrl = extractStreamUrl(url); // calls youtube-dl as shown above\n\nAudioPlayerManager playerManager = new DefaultAudioPlayerManager();\nAudioPlayer player = playerManager.createPlayer();\nplayerManager.loadItem(streamUrl, new AudioLoadResultHandler() {\n    @Override\n    public void trackLoaded(AudioTrack track) {\n        player.playTrack(track);\n    }\n    // other overrides omitted\n});\n</code></pre>",
  "Title: pre-commit fails to install google-java-format 1.15.0 with a build-configuration validation error  \nBody: <p><a href=\"https://pre-commit.com/\" rel=\"noreferrer\">pre-commit</a> suddenly started to fail installing the <a href=\"https://github.com/google/google-java-format\" rel=\"noreferrer\">google-java-format</a> hook in our builds today with the following error</p>\n<pre><code>[INFO] Installing environment for https://github.com/google/google-java-format.\n[INFO] Once installed this environment will be reused.\n[INFO] This may take a few minutes...\nProcess exited with code 1\nstderr:\n  java.lang.RuntimeException\n</code></pre>\n<p>It seems to be related to build configuration validation.</p>",
  "Title: Maven install on an existing project Error \"does not contain any element\".\nBody: <p>I am using Maven for the first time.\nI have a very simple project. Basically</p>\n<pre><code>a_project\n|\n|--src\n|   |--test\n|   |   |--java\n|   |       |--com\n|   |           |--example\n|   |               |--TestSomething.java\n|\n|--src\n|   |--main\n|   |   |--java\n|   |       |--com\n|   |           |--example\n|   |               |--ScriptToTest.java\n</code></pre>\n<p>From the project root I do <code>mvn -q archetype:generate</code> or create a <code>pom.xml</code> and then run <code>mvn install</code></p>\n<p>I get the following</p>\n<pre><code>mvn install\n[INFO] Scanning for projects...\n[INFO] \n[INFO] ---------------------&lt; com.example:a_project &gt;----------------------\n[INFO] Building a_project 1.0-SNAPSHOT\n[INFO] --------------------------------[ jar ]---------------------------------\n[INFO] \n[INFO] --- maven-resources-plugin:3.3.1:resources (default-resources) @ a_project ---\n[INFO] \n[INFO] --- maven-compiler-plugin:3.11.0:compile (default-compile) @ a_project ---\n[INFO] \n[INFO] --- maven-resources-plugin:3.3.1:testResources (default-testResources) @ a_project ---\n[INFO] \n[INFO] --- maven-compiler-plugin:3.11.0:testCompile (default-testCompile) @ a_project ---\n[INFO] \n[INFO] --- maven-surefire-plugin:3.2.5:test (default-test) @ a_project ---\n[INFO] \n[INFO] BUILD SUCCESS\n[INFO] ------------------------------------------------------------------------\n/home/me/MyStudy/2023/maven_practice/a_project/pom.xml does not contain any element\n</code></pre>\n<p>After this I can run <code>mvn test</code> without problem but what does that error message mean?</p>",
  "Title: Maven dependency download fails because the environment is OS‑managed\nBody: <p>Command:</p>\n<pre class=\"lang-none prettyprint-override\"><code>mvn -q -DskipTests package\n</code></pre>\n<p>Output:</p>\n<pre class=\"lang-none prettyprint-override\"><code>The build tool reports that the Java environment is managed by the OS\npackage manager and advises installing libraries via the OS or using a\nlocal tool-managed environment (for example, a user-specific Maven repository).\n</code></pre>\n<p>I wish someone would explain to me what to do and how to solve it.</p>",
  "Title: Why is ByteArrayOutputStream remove-at-0 over 200 times slower than System.arraycopy for a byte[]?\n\nBody: <p>Letting them compete three times (a million removes/copies each time):</p>\n<pre><code>import java.util.Arrays;\n\npublic class Main {\n    public static void main(String[] args) {\n        for (int i = 0; i &lt; 3; i++) {\n            long t1 = time(() -&gt; {\n                byte[] b = new byte[1_000_000];\n                for (int k = 0; k &lt; 1_000_000; k++) {\n                    b = removeFirst(b);\n                }\n            });\n            long t2 = time(() -&gt; {\n                byte[] b = new byte[1_000_000];\n                for (int k = 0; k &lt; 1_000_000; k++) {\n                    System.arraycopy(b, 1, b, 0, b.length - 1);\n                }\n            });\n            System.out.println((double) t1 / t2);\n        }\n    }\n\n    static byte[] removeFirst(byte[] b) {\n        if (b.length == 0) return b;\n        return Arrays.copyOfRange(b, 1, b.length);\n    }\n\n    static long time(Runnable r) {\n        long start = System.nanoTime();\n        r.run();\n        return System.nanoTime() - start;\n    }\n}\n</code></pre>\n<p>Why is <code>removeFirst</code> that much slower at doing the same thing?</p>",
  "Title: Why is the simpler loop slower?\nBody: <p>Called with <code>n = 10**8</code>, the simple loop is consistently significantly slower for me than the complex one, and I don't see why:</p>\n<pre><code>static void simple(long n) {\n    while (n != 0) {\n        n -= 1;\n    }\n}\n\nstatic void complex(long n) {\n    while (true) {\n        if (n == 0) {\n            break;\n        }\n        n -= 1;\n    }\n}\n</code></pre>\n<p>Some times in seconds:</p>\n<pre class=\"lang-none prettyprint-override\"><code>simple 4.340795516967773\ncomplex 3.6490490436553955\nsimple 4.374553918838501\ncomplex 3.639145851135254\nsimple 4.336690425872803\ncomplex 3.624480724334717\nJava: 21.0.2\n</code></pre>\n<p>So it looks like the complex one does more work per iteration (two branches instead of one). Then why is it faster?</p>\n<p>Benchmark script:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class Main {\n    static void simple(long n) {\n        while (n != 0) {\n            n -= 1;\n        }\n    }\n\n    static void complex(long n) {\n        while (true) {\n            if (n == 0) {\n                break;\n            }\n            n -= 1;\n        }\n    }\n\n    public static void main(String[] args) {\n        for (int i = 0; i &lt; 3; i++) {\n            long t1 = System.nanoTime();\n            simple(100_000_000L);\n            long t2 = System.nanoTime();\n            System.out.println(\"simple \" + (t2 - t1) / 1_000_000_000.0);\n\n            long t3 = System.nanoTime();\n            complex(100_000_000L);\n            long t4 = System.nanoTime();\n            System.out.println(\"complex \" + (t4 - t3) / 1_000_000_000.0);\n        }\n\n        System.out.println(\"Java: \" + System.getProperty(\"java.version\"));\n    }\n}\n</code></pre>",
  "Title: Error: cannot find symbol ANTIALIAS when resizing an image in Java\nBody: \n- Trying to display images in a Java Swing GUI, so I’m using `ImageIO` and `BufferedImage`.\n- I want to resize with antialiasing, but the constant `ANTIALIAS` doesn’t exist. Using bilinear interpolation works.\n\nHere’s some sample code:\n\n```java\nimport javax.swing.*;\nimport javax.imageio.ImageIO;\nimport java.awt.*;\nimport java.awt.image.BufferedImage;\nimport java.io.File;\n\npublic class Main {\n    public static void main(String[] args) throws Exception {\n        JFrame window = new JFrame();\n        window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n\n        BufferedImage image = ImageIO.read(new File(\"VC.png\"));\n        BufferedImage resized = new BufferedImage(20, 20, BufferedImage.TYPE_INT_ARGB);\n\n        Graphics2D g2d = resized.createGraphics();\n        g2d.setRenderingHint(RenderingHints.KEY_INTERPOLATION, RenderingHints.ANTIALIAS);\n        g2d.drawImage(image, 0, 0, 20, 20, null);\n        g2d.dispose();\n\n        JLabel imageLabel = new JLabel(new ImageIcon(resized));\n        window.add(imageLabel);\n        window.pack();\n        window.setVisible(true);\n    }\n}\n```\n\nHere’s the error:\n\n```\nerror: cannot find symbol\ng2d.setRenderingHint(RenderingHints.KEY_INTERPOLATION, RenderingHints.ANTIALIAS);\n```\n\n- I tried different interpolation options and `VALUE_INTERPOLATION_BILINEAR` works.\n- How do I get antialiasing when resizing images in Java?",
  "Title: \"java.lang.NoClassDefFoundError: org/apache/http/ssl/SSLContexts on AWS Lambda using a layer\"\n\nBody: <h1>What I want to achieve</h1>\n<p>Scrape a website using an AWS Lambda function written in Java and save the data to S3.</p>\n<h1>The issues I'm having</h1>\n<p>When I execute the Lambda, the following error message appears.</p>\n<blockquote>\n<p>{ \"errorMessage\": \"Unable to initialize class software.amazon.awssdk.http.apache.ApacheHttpClient: java.lang.NoClassDefFoundError: org/apache/http/ssl/SSLContexts\", \"errorType\": \"java.lang.NoClassDefFoundError\", \"requestId\": \"fb66bea9-cbad-4bd3-bd4d-6125454e21be\", \"stackTrace\": [] }</p>\n</blockquote>\n<h1>Code</h1>\n<p>The minimum Lambda code is as follows.</p>\n<pre><code>import com.amazonaws.services.lambda.runtime.Context;\nimport com.amazonaws.services.lambda.runtime.RequestHandler;\nimport software.amazon.awssdk.services.s3.S3Client;\nimport software.amazon.awssdk.services.s3.model.PutObjectRequest;\n\nimport java.nio.charset.StandardCharsets;\nimport java.util.Map;\n\npublic class Handler implements RequestHandler&lt;Map&lt;String, Object&gt;, Object&gt; {\n    @Override\n    public Object handleRequest(Map&lt;String, Object&gt; event, Context context) {\n        S3Client s3 = S3Client.builder().build();\n        s3.putObject(\n                PutObjectRequest.builder()\n                        .bucket(\"horserace-dx\")\n                        .key(\"raw/a.html\")\n                        .build(),\n                software.amazon.awssdk.core.sync.RequestBody.fromBytes(\"testtext\".getBytes(StandardCharsets.UTF_8))\n        );\n        return event;\n    }\n}\n</code></pre>\n<p>A layer was added to the Lambda. The dependencies were copied into a <code>java/lib</code> folder, zipped, and uploaded to AWS Lambda as a layer.</p>\n<pre><code>mvn -q -DskipTests package\nmvn -q dependency:copy-dependencies -DincludeScope=runtime -DoutputDirectory=./java/lib\n</code></pre>\n<ul>\n<li>The bucket <code>horserace-dx</code> exists</li>\n<li>The folder <code>raw</code> exists</li>\n<li>The Lambda role can read from and write to S3</li>\n<li>The Lambda runtime is Java 11. The local JDK is 11.</li>\n</ul>\n<h1>What I did so far</h1>\n<p>I searched for \"NoClassDefFoundError SSLContexts aws lambda java\" and found suggestions to add the Apache HttpClient dependencies. I updated the layer with these dependencies and tried again, but the error still happens.</p>\n<pre><code>&lt;dependencies&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\n        &lt;artifactId&gt;s3&lt;/artifactId&gt;\n        &lt;version&gt;2.21.0&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\n        &lt;artifactId&gt;apache-client&lt;/artifactId&gt;\n        &lt;version&gt;2.21.0&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt;\n        &lt;artifactId&gt;httpclient&lt;/artifactId&gt;\n        &lt;version&gt;4.5.14&lt;/version&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;\n</code></pre>\n<p>What should I do to resolve this and get the Lambda working? Any suggestions would be greatly appreciated.</p>",
  "Title: Why is BLAS dot so much faster than summing a double[] in Java?\nBody: <p>Why is a BLAS dot product so much faster than summing a <code>double[]</code> in Java? Following the discussion in the linked answer, we know that some sum implementations are slower than others.</p>\n<p>For example, using JMH:</p>\n<pre><code>@State(Scope.Thread)\npublic class SumBench {\n    double[] A = new Random(0).doubles(1000).toArray();\n    double[] B = new Random(1).doubles(1000).toArray();\n\n    @Benchmark\n    public double sumLoop() {\n        double s = 0.0;\n        for (double v : A) s += v;\n        return s;\n    }\n\n    @Benchmark\n    public double sumStream() {\n        return DoubleStream.of(A).sum();\n    }\n\n    @Benchmark\n    public double dotBlas() {\n        return BLAS.getInstance().ddot(A.length, A, 1, B, 1);\n    }\n}\n</code></pre>\n<p>But all of them are slower than the BLAS dot product.</p>\n<p>Given that BLAS <code>ddot</code> is multiplying two arrays elementwise and then summing them, how can this be faster than just summing one array? If <code>B</code> were all ones then <code>ddot</code> would simply be summing <code>A</code>.</p>\n<p>So it seems the fastest option to sum <code>A</code> is:</p>\n<pre><code>double[] O = new double[1000];\nArrays.fill(O, 1.0);\ndouble s = BLAS.getInstance().ddot(A.length, A, 1, O, 1);\n</code></pre>\n<p>This can't be right, can it?</p>\n<p>This is on Ubuntu using OpenBLAS (via netlib-java) on Java 17.</p>\n<p>Supported SIMD extensions on this machine:</p>\n<pre><code>baseline = SSE,SSE2,SSE3\nfound = SSSE3,SSE41,POPCNT,SSE42,AVX,F16C,FMA3,AVX2\n</code></pre>\n<p><strong>Update</strong></p>\n<p>The order of the timings reverses if the array is much longer. That is:</p>\n<pre><code>A = new Random(0).doubles(1_000_000).toArray();\ndouble[] O = new double[1_000_000];\nArrays.fill(O, 1.0);\n\n@Benchmark\npublic double dotBlas() {\n    return BLAS.getInstance().ddot(A.length, A, 1, O, 1);\n}\n\n@Benchmark\npublic double sumLoop() {\n    double s = 0.0;\n    for (double v : A) s += v;\n    return s;\n}\n</code></pre>\n<p>This implies to me that there is some fixed sized overhead when calling the Java summation methods that doesn't exist when calling BLAS, but the part of the code that does the summation is in fact faster.</p>\n<p>Any speed ups using JNI, Panama, or other Java techniques would be great to see.</p>",
  "Title: Why does a Java lambda create a synthetic method internally?\nBody: <p>This is the <code>javap -c</code> output for a simple lambda in Java:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class Demo {\n    public static void main(String[] args) {\n        var list = java.util.stream.IntStream.of()\n                .mapToObj(i -&gt; true)\n                .toList();\n    }\n}\n</code></pre>\n<pre class=\"lang-text prettyprint-override\"><code>Compiled from \"Demo.java\"\npublic class Demo {\n  public static void main(java.lang.String[]);\n    Code:\n       0: invokestatic  #...  // java/util/stream/IntStream.of:()Ljava/util/stream/IntStream;\n       3: invokedynamic #...  // InvokeDynamic #0:apply:()Ljava/util/function/IntFunction;\n       8: invokeinterface #... // java/util/stream/IntStream.mapToObj:(Ljava/util/function/IntFunction;)Ljava/util/stream/Stream;\n      13: invokeinterface #... // java/util/stream/Stream.toList:()Ljava/util/List;\n      18: astore_1\n      19: return\n\n  private static java.lang.Boolean lambda$main$0(int);\n    Code:\n       0: iconst_1\n       1: invokestatic java/lang/Boolean.valueOf:(Z)Ljava/lang/Boolean;\n       4: areturn\n}\n</code></pre>\n<p>From what I understand, the compiler creates a synthetic method like <code>lambda$main$0</code> that does the work, and the call site is wired up via <code>invokedynamic</code>. I can’t figure out why it needs a separate method to execute this job. Is this an optimization or a JVM requirement?</p>",
  "Title: Unexpected uint64 behaviour 0xFFFF'FFFF'FFFF'FFFF - 1 = 0?\n\nBody: Consider the following brief Java session using an unsigned 64‑bit type from Guava:\n\n```java\nimport com.google.common.primitives.UnsignedLong;\n\npublic class Demo {\n    public static void main(String[] args) {\n        UnsignedLong a = UnsignedLong.ZERO;\n\n        System.out.println(a);\n        // 0\n\n        a = a.minus(UnsignedLong.ONE);\n        System.out.println(a);\n        // 18446744073709551615\n        // this is 0xffff ffff ffff ffff, as expected\n\n        a = a.minus(UnsignedLong.ONE);\n        System.out.println(a);\n        // 0\n        // what the heck?\n    }\n}\n```\n\nI'm utterly confused by this last output.\n\nI would expect 0xFFFF'FFFF'FFFF'FFFE.\n\nWhat exactly is going on here?\n\nMy setup:\n\n```\nos.name = Linux\njava.version = 17.0.6\nguava.version = 32.1.2-jre\n```",
  "Title: Executing a MySQL query via JDBC fails while preparing data for Prophet in Java  \nBody: I’m totally new to development and I’m taking AI / Data Science courses. One of my tasks is to pull data from a SQL database, build a forecast with Prophet, and then export the predictions to a CSV for PowerBI.\n\nI tried to do this in Java, but I’m stuck and I don’t know where the problem is:\n\n```java\nimport java.sql.Connection;\nimport java.sql.DriverManager;\nimport java.sql.ResultSet;\nimport java.sql.Statement;\nimport java.time.LocalDate;\nimport java.util.Map;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.ArrayList;\n\npublic class App {\n    public static void main(String[] args) throws Exception {\n        Connection conn = DriverManager.getConnection(\n                \"jdbc:mysql://localhost:3306/data\",\n                \"root\",\n                \"Password\"\n        );\n\n        String query = \"SELECT Cle_Produit, Date_Facturation, SUM(Quantite) AS Total_Quantite \" +\n                       \"FROM ventes GROUP BY Cle_Produit, Date_Facturation\";\n\n        Statement stmt = conn.createStatement();\n        ResultSet rs = stmt.executeQuery(query); // error happens here\n\n        // Load rows\n        List<Row> rows = new ArrayList<>();\n        while (rs.next()) {\n            String cleProduit = rs.getString(\"Cle_Produit\");\n            LocalDate dateFacturation = rs.getDate(\"Date_Facturation\").toLocalDate();\n            int totalQuantite = rs.getInt(\"Total_Quantite\");\n            rows.add(new Row(cleProduit, dateFacturation, totalQuantite));\n        }\n\n        // Pivot by Date_Facturation (ds) and product\n        Map<LocalDate, Map<String, Integer>> pivot = new HashMap<>();\n        for (Row r : rows) {\n            pivot.computeIfAbsent(r.date, k -> new HashMap<>()).put(r.cleProduit, r.totalQuantite);\n        }\n\n        // Build time series data for Prophet (ds, y) here\n        // Prophet model = new Prophet();\n        // model.fit(data);\n        // Forecast and write CSV\n\n        conn.close();\n    }\n\n    static class Row {\n        String cleProduit;\n        LocalDate date;\n        int totalQuantite;\n        Row(String cleProduit, LocalDate date, int totalQuantite) {\n            this.cleProduit = cleProduit;\n            this.date = date;\n            this.totalQuantite = totalQuantite;\n        }\n    }\n}\n```\n\nWhen I run it, I get a runtime error when executing the SQL query.  \n\nCan somebody help me understand what I’m doing wrong?\n\nMy goal is to create a CSV with Prophet predictions. I want Prophet to use the `ventes` table from the `data` database with columns `Cle_Produit`, `Quantite`, and `Date_Facturation`.",
  "Title: CUDA 12 + TensorFlow Java nightly 2.12: \"Could not find cuda drivers on your machine, GPU will not be used\" even though checks pass and other frameworks work\n\nBody: <ul>\n<li><strong>TensorFlow Java nightly version</strong> = 2.12.0-dev20230203</li>\n<li><strong>Java version</strong> = 17.0.6</li>\n<li><strong>CUDA drivers version</strong> = 525.85.12</li>\n<li><strong>CUDA version</strong> = 12.0</li>\n<li><strong>cuDNN version</strong> = 8.5.0</li>\n<li>I am using <strong>Linux</strong> (x86_64, Ubuntu 22.04)</li>\n<li>I am coding in <strong>Visual Studio Code</strong> with a <strong>Maven</strong> project</li>\n</ul>\n<p>I am trying to run some models on the GPU (NVIDIA GeForce RTX 3050) using TensorFlow Java nightly 2.12 (to be able to use CUDA 12.0). The problem is that every check seems correct, but the program cannot detect the GPU. I have spent a lot of time debugging and nothing seems to work, so any advice is welcome. The GPU works with another framework (see extra check at the end).</p>\n<p>Here are the most common checks I did (terminal in VS Code):</p>\n<ol>\n<li><p><strong>Check CUDA version:</strong></p>\n<p><code>$ nvcc --version</code></p>\n<pre><code>nvcc: NVIDIA (R) Cuda compiler driver\nCopyright (c) 2005-2023 NVIDIA Corporation\nBuilt on Fri_Jan__6_16:45:21_PST_2023\nCuda compilation tools, release 12.0, V12.0.140\nBuild cuda_12.0.r12.0/compiler.32267302_0\n</code></pre>\n</li>\n<li><p><strong>Check if the connection with the CUDA libraries is correct:</strong></p>\n<p><code>$ echo $LD_LIBRARY_PATH</code></p>\n<pre><code>/usr/cuda/lib\n</code></pre>\n</li>\n<li><p><strong>Check NVIDIA drivers for the GPU and check if GPU is readable:</strong></p>\n<p><code>$ nvidia-smi</code></p>\n<pre><code>+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 525.85.12    Driver Version: 525.85.12    CUDA Version: 12.0     |\n|-------------------------------+----------------------+----------------------+\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|                               |                      |               MIG M. |\n|===============================+======================+======================|\n|   0  NVIDIA GeForce ...  On   | 00000000:01:00.0  On |                  N/A |\n| N/A   40C    P5     6W /  20W |     46MiB /  4096MiB |     22%      Default |\n|                               |                      |                  N/A |\n+-------------------------------+----------------------+----------------------+\n\n+-----------------------------------------------------------------------------+\n| Processes:                                                                  |\n|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n|        ID   ID                                                   Usage      |\n|=============================================================================|\n|    0   N/A  N/A      1356      G   /usr/lib/xorg/Xorg                 45MiB |\n+-----------------------------------------------------------------------------+\n</code></pre>\n</li>\n<li><p><strong>Add cuda/bin PATH and check it:</strong></p>\n<p><code>$ export PATH=\"/usr/local/cuda/bin:$PATH\"</code></p>\n<p><code>$ echo $PATH</code></p>\n<pre><code>/usr/local/cuda-12.0/bin:/home/victus-linux/Escritorio/MasterThesis_CODE/to_share/venv_master/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/snap/bin\n</code></pre>\n</li>\n<li><p><strong>Custom function to check if CUDA is correctly installed:</strong></p>\n<pre class=\"lang-bash prettyprint-override\"><code>function lib_installed() { /sbin/ldconfig -N -v $(sed 's/:/ /' &lt;&lt;&lt; $LD_LIBRARY_PATH) 2&gt;/dev/null | grep $1; }\nfunction check() { lib_installed $1 &amp;&amp; echo \"$1 is installed\" || echo \"ERROR: $1 is NOT installed\"; }\ncheck libcuda\ncheck libcudart\n</code></pre>\n<pre><code>libcudart.so.12 -&gt; libcudart.so.12.0.146\n        libcuda.so.1 -&gt; libcuda.so.525.85.12\n        libcuda.so.1 -&gt; libcuda.so.525.85.12\n        libcudadebugger.so.1 -&gt; libcudadebugger.so.525.85.12\nlibcuda is installed\n        libcudart.so.12 -&gt; libcudart.so.12.0.146\nlibcudart is installed\n</code></pre>\n</li>\n<li><p><strong>Custom function to check if cuDNN is correctly installed:</strong></p>\n<pre class=\"lang-bash prettyprint-override\"><code>function lib_installed() { /sbin/ldconfig -N -v $(sed 's/:/ /' &lt;&lt;&lt; $LD_LIBRARY_PATH) 2&gt;/dev/null | grep $1; }\nfunction check() { lib_installed $1 &amp;&amp; echo \"$1 is installed\" || echo \"ERROR: $1 is NOT installed\"; }\ncheck libcudnn\n</code></pre>\n<pre><code>        libcudnn_cnn_train.so.8 -&gt; libcudnn_cnn_train.so.8.8.0\n        libcudnn_cnn_infer.so.8 -&gt; libcudnn_cnn_infer.so.8.8.0\n        libcudnn_adv_train.so.8 -&gt; libcudnn_adv_train.so.8.8.0\n        libcudnn.so.8 -&gt; libcudnn.so.8.8.0\n        libcudnn_ops_train.so.8 -&gt; libcudnn_ops_train.so.8.8.0\n        libcudnn_adv_infer.so.8 -&gt; libcudnn_adv_infer.so.8.8.0\n        libcudnn_ops_infer.so.8 -&gt; libcudnn_ops_infer.so.8.8.0\nlibcudnn is installed\n</code></pre>\n</li>\n</ol>\n<p>After these checks I ran a small Java program to verify TensorFlow GPU detection and got the following error:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import org.tensorflow.Graph;\nimport org.tensorflow.Session;\nimport org.tensorflow.TensorFlow;\n\npublic class TfGpuCheck {\n    public static void main(String[] args) {\n        System.out.println(\"\\nTensorFlow version = \" + TensorFlow.version() + \"\\n\");\n        try (Graph g = new Graph(); Session s = new Session(g)) {\n            System.out.println(\"\\n\" + s.listDevices() + \"\\n\");\n        }\n    }\n}\n</code></pre>\n<pre><code>2023-03-02 12:05:09.463343: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.\n2023-03-02 12:05:09.489911: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.\n2023-03-02 12:05:09.490522: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2023-03-02 12:05:10.066759: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\n\nTensorFlow version = 2.12.0-dev20230203\n\n2023-03-02 12:05:10.748675: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at `https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355`\n2023-03-02 12:05:10.771263: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1956] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at `https://www.tensorflow.org/install/gpu` for how to download and setup the required libraries for your platform.\nSkipping registering GPU devices...\n</code></pre>\n<p><strong>Extra check:</strong> I tried GPU detection in another Java framework and it worked, so I think the problem is specific to TensorFlow Java / nightly.</p>\n<pre class=\"lang-java prettyprint-override\"><code>import ai.djl.engine.Engine;\n\npublic class DjlGpuCheck {\n    public static void main(String[] args) {\n        Engine engine = Engine.getInstance();\n        System.out.println(\"\\nEngine = \" + engine.getEngineName());\n        System.out.println(\"GPU count = \" + engine.getGpuCount());\n        System.out.println(\"Default device = \" + engine.defaultDevice());\n    }\n}\n</code></pre>\n<pre><code>Engine = PyTorch\nGPU count = 1\nDefault device = gpu:0\n</code></pre>\n<p>If you know anything that might help solve this issue, please let me know.</p>",
  "Title: Theoretically can the Ackermann function be optimized?\nBody: <p>I am wondering if there can be a version of Ackermann function with better time complexity than the standard variation.</p>\n<p>This is not a homework and I am just curious. I know the Ackermann function doesn't have any practical use besides as a performance benchmark, because of the deep recursion. I know the numbers grow very large very quickly, and I am not interested in computing it.</p>\n<p>Even though I use Java and <code>BigInteger</code> won’t overflow, I do have finite time, but I have implemented a version of it myself according to the definition found on <a href=\"https://en.wikipedia.org/wiki/Ackermann_function\" rel=\"noreferrer\">Wikipedia</a>, and computed the output for extremely small values, just to make sure the output is correct.</p>\n<p><a href=\"https://i.stack.imgur.com/vsPES.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/vsPES.jpg\" alt=\"enter image description here\" /></a></p>\n<pre><code>import java.math.BigInteger;\n\npublic class Ackermann {\n    public static BigInteger A(int m, BigInteger n) {\n        if (m == 0) return n.add(BigInteger.ONE);\n        if (n.equals(BigInteger.ZERO)) return A(m - 1, BigInteger.ONE);\n        return A(m - 1, A(m, n.subtract(BigInteger.ONE)));\n    }\n}\n</code></pre>\n<p>The above code is a direct translation of the image, and is extremely slow, I don't know how it can be optimized, is it impossible to optimize it?</p>\n<p>One thing I can think of is to memoize it, but the recursion runs backwards, each time the function is recursively called the arguments were not encountered before, each successive function call the arguments decrease rather than increase, therefore each return value of the function needs to be calculated, memoization doesn't help when you call the function with different arguments the first time.</p>\n<p>Memoization can only help if you call it with the same arguments again, it won't compute the results and will retrieve cached result instead, but if you call the function with any input with (m, n) &gt;= (4, 2) it will crash the interpreter regardless.</p>\n<p>I also implemented another version according to this <a href=\"https://stackoverflow.com/a/20411205/16383578\">answer</a>:</p>\n<pre><code>import java.math.BigInteger;\n\npublic class Ackermann2 {\n    public static BigInteger ack(int x, BigInteger y) {\n        for (int i = x; i &gt; 0; i--) {\n            y = y.equals(BigInteger.ZERO) ? BigInteger.ONE : ack(i, y.subtract(BigInteger.ONE));\n        }\n        return y.add(BigInteger.ONE);\n    }\n}\n</code></pre>\n<p>But it is actually slower:</p>\n<pre><code>// Rough timing with System.nanoTime()\nlong t0 = System.nanoTime();\nAckermann.A(3, BigInteger.valueOf(4));\nlong t1 = System.nanoTime();\nSystem.out.println((t1 - t0) / 1_000_000.0 + \" ms\");\n\nlong t2 = System.nanoTime();\nAckermann2.ack(3, BigInteger.valueOf(4));\nlong t3 = System.nanoTime();\nSystem.out.println((t3 - t2) / 1_000_000.0 + \" ms\");\n</code></pre>\n<p>Theoretically can Ackermann function be optimized? If not, can it be definitely proven that its time complexity cannot decrease?</p>\n<hr />\n<p>I have just tested <code>A(3, 9)</code> and <code>A(4, 1)</code> and they will crash the JVM, and the performance of the two functions for <code>A(3, 8)</code>:</p>\n<pre><code>long t0 = System.nanoTime();\nAckermann.A(3, BigInteger.valueOf(8));\nlong t1 = System.nanoTime();\nSystem.out.println((t1 - t0) / 1_000_000.0 + \" ms\");\n\nlong t2 = System.nanoTime();\nAckermann2.ack(3, BigInteger.valueOf(8));\nlong t3 = System.nanoTime();\nSystem.out.println((t3 - t2) / 1_000_000.0 + \" ms\");\n</code></pre>\n<hr />\n<p>I did some more experiments:</p>\n<pre><code>import java.math.BigInteger;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.util.Objects;\n\npublic class AckermannCount {\n    static class Pair {\n        final int m;\n        final BigInteger n;\n        Pair(int m, BigInteger n) { this.m = m; this.n = n; }\n        @Override public boolean equals(Object o) {\n            if (!(o instanceof Pair)) return false;\n            Pair p = (Pair) o;\n            return m == p.m &amp;&amp; n.equals(p.n);\n        }\n        @Override public int hashCode() { return Objects.hash(m, n); }\n    }\n\n    static Map&lt;Pair, Integer&gt; c = new HashMap&lt;&gt;();\n\n    public static BigInteger A1(int m, BigInteger n) {\n        Pair key = new Pair(m, n);\n        c.put(key, c.getOrDefault(key, 0) + 1);\n        if (m == 0) return n.add(BigInteger.ONE);\n        if (n.equals(BigInteger.ZERO)) return A1(m - 1, BigInteger.ONE);\n        return A1(m - 1, A1(m, n.subtract(BigInteger.ONE)));\n    }\n\n    public static Map&lt;Pair, Integer&gt; test(int m, BigInteger n) {\n        c.clear();\n        A1(m, n);\n        return c;\n    }\n}\n</code></pre>\n<p>The arguments indeed repeat.</p>\n<p>But surprisingly caching doesn't help at all:</p>\n<pre><code>import java.util.Map;\nimport java.util.concurrent.ConcurrentHashMap;\nimport java.util.function.Function;\n\npublic class AckermannMemo {\n    static Map&lt;AckermannCount.Pair, BigInteger&gt; cache = new ConcurrentHashMap&lt;&gt;();\n\n    public static BigInteger A(int m, BigInteger n) {\n        AckermannCount.Pair key = new AckermannCount.Pair(m, n);\n        BigInteger cached = cache.get(key);\n        if (cached != null) return cached;\n        BigInteger result;\n        if (m == 0) result = n.add(BigInteger.ONE);\n        else if (n.equals(BigInteger.ZERO)) result = A(m - 1, BigInteger.ONE);\n        else result = A(m - 1, A(m, n.subtract(BigInteger.ONE)));\n        cache.put(key, result);\n        return result;\n    }\n}\n</code></pre>\n<p>Caching only helps when the function is called with the same arguments again, as explained:</p>\n<pre><code>long t0 = System.nanoTime();\nAckermannMemo.A(3, BigInteger.valueOf(2));\nlong t1 = System.nanoTime();\nSystem.out.println((t1 - t0) + \" ns\");\n</code></pre>\n<p>I have tested it with different arguments numerous times, and it always gives the same efficiency boost (which is none).</p>",
  "Title: Why is list.remove(0) over 200 times slower than manually shifting a byte[] in Java?\nBody: <p>Letting them compete three times (a million removals/shifts each time):</p>\n<pre><code>import java.util.ArrayList;\nimport java.util.List;\n\npublic class Bench {\n    public static void main(String[] args) {\n        for (int round = 0; round &lt; 3; round++) {\n            long t1 = timeRemove();\n            long t2 = timeShift();\n            System.out.println((double) t1 / (double) t2);\n        }\n    }\n\n    static long timeRemove() {\n        long start = System.nanoTime();\n        List&lt;Byte&gt; b = new ArrayList&lt;&gt;(1_000_000);\n        for (int i = 0; i &lt; 1_000_000; i++) b.add((byte) 0);\n        for (int i = 0; i &lt; 1_000_000; i++) {\n            b.remove(0);\n        }\n        return System.nanoTime() - start;\n    }\n\n    static long timeShift() {\n        long start = System.nanoTime();\n        byte[] b = new byte[1_000_000];\n        int len = b.length;\n        for (int i = 0; i &lt; 1_000_000; i++) {\n            System.arraycopy(b, 1, b, 0, len - 1);\n            len--;\n        }\n        return System.nanoTime() - start;\n    }\n}\n</code></pre>\n<p>Time ratios (remove/shift):</p>\n<pre><code>274.6\n219.3\n252.0\n</code></pre>\n<p>Why is <code>remove(0)</code> that much slower at doing the same thing?</p>",
  "Title: Why isn’t the derived class destructor called when deleting an array through a base class reference?\nBody: <p>I have an <code>Animal</code> class with a virtual destructor and a derived class <code>Cat</code>. In Java I’m trying to mirror the C++ behavior:</p>\n<pre><code>class Animal {\n    Animal() { System.out.println(\"Animal constructor\"); }\n\n    @Override\n    protected void finalize() throws Throwable {\n        System.out.println(\"Animal destructor\");\n        super.finalize();\n    }\n}\n\nclass Cat extends Animal {\n    Cat() { System.out.println(\"Cat constructor\"); }\n\n    @Override\n    protected void finalize() throws Throwable {\n        System.out.println(\"Cat destructor\");\n        super.finalize();\n    }\n}\n\npublic class Main {\n    public static void main(String[] args) {\n        Animal[] j = new Cat[1];\n        j = null;\n        System.gc();\n    }\n}\n</code></pre>\n<p>This prints:</p>\n<blockquote>\n<p>Animal constructor<br />\nCat constructor<br />\nAnimal destructor</p>\n</blockquote>\n<p>I don’t understand why the <code>Cat</code> destructor isn’t called when my base class destructor is virtual. What is going on here?</p>",
  "Title: Convenient way to declare 2D (or even higher dimension) arrays in Java.\nBody: <p>I'm about to convert a lot of old C++ code to Java.</p>\n<p>There are many raw 2D arrays in that code like:</p>\n<pre><code>Foo bar[XSIZE][YSIZE];\n</code></pre>\n<p>And I'm about to replace these declarations with:</p>\n<pre><code>Foo[][] bar = new Foo[XSIZE][YSIZE];\n</code></pre>\n<p>This is a convenient way because the statements stay the same and the code is supposed to behave the same as with raw arrays with the additional benefit of being able to add bounds checks or validation in debug builds.</p>\n<p>But IMO the <code>Foo[][]</code> form is somewhat cumbersome and not easy to read, and with 3D arrays (although I have none) it would even be worse.</p>\n<p>Right now I'm using a helper to make the declaration more readable:</p>\n<pre><code>static Foo[][] declare2DArray(int x, int y) {\n    return new Foo[x][y];\n}\n...\nFoo[][] bar = declare2DArray(XSIZE, YSIZE);\n</code></pre>\n<p>But I feel this to be a hack, and I'm wondering if there is a cleaner, more Java way to do something similar.</p>",
  "Title: JIT removes a bounds check in the right operand of &&, but not in the left operand, why?\nBody: <p>I have the following Java code snippet:</p>\n<pre><code>public class Test {\n    private static final int ARRAY_LENGTH = 666;\n\n    private static int gSum = 0;\n    private static int[] gArray = new int[ARRAY_LENGTH];\n\n    public static void test() {\n        int idx = 0;\n\n        // either enable or disable the check \"idx < ARRAY_LENGTH\" in the while loop\n        while (gArray[idx] != 0 /* && idx < ARRAY_LENGTH */) {\n            gSum += gArray[idx];\n            ++idx;\n        }\n    }\n}\n</code></pre>\n<hr />\n<p>When I run the above code on HotSpot (OpenJDK 17) and inspect the compiled assembly using JITWatch, I see the same machine code for both cases:</p>\n<ol>\n<li>the while loop condition is <code>gArray[idx] != 0</code></li>\n<li>the while loop condition is <code>gArray[idx] != 0 &amp;&amp; idx &lt; ARRAY_LENGTH</code></li>\n</ol>\n<p>The generated assembly does not include any check of <code>idx</code> against <code>ARRAY_LENGTH</code> when the bounds check is on the right-hand side.</p>\n<hr />\n<h2>My question</h2>\n<p>How is that possible?\nHow can the JIT generate the exactly same assembly for both cases and ignore the <code>idx &lt; ARRAY_LENGTH</code> condition if it is present in the code? Explain the rule or procedure the JIT uses to conclude it can remove the condition.</p>\n<p>NOTE: If I swap the order of conditions to be <code>idx &lt; ARRAY_LENGTH &amp;&amp; gArray[idx] != 0</code>, the output assembly contains the bounds check.</p>",
  "Title: Are multidimensional array accesses sequenced in Java?\nBody: <p>Take the following Java code:</p>\n<pre><code>static int a() {\n    System.out.println(\"a\");\n    return 0;\n}\n\nstatic int b() {\n    System.out.println(\"b\");\n    return 1;\n}\n\nstatic int c() {\n    System.out.println(\"c\");\n    return 2;\n}\n\nstatic int d() {\n    System.out.println(\"d\");\n    return 3;\n}\n</code></pre>\n<p>Will the following have predictable behavior?</p>\n<pre><code>int[][][][] arr = new int[4][4][4][4];\narr[a()][b()][c()][d()] = 1;\n</code></pre>\n<p>Is it guaranteed to print in this order?</p>\n<pre class=\"lang-none prettyprint-override\"><code>a\nb\nc\nd\n</code></pre>\n<p>I am aware that constructs such as the following are problematic in some languages:</p>\n<pre><code>int i = 0;\ni = i++;\n</code></pre>\n<p>Put another way, is the following valid and well-defined in Java?</p>\n<pre><code>int i = 0;\nint[][][][] arr = new int[4][4][4][4];\narr[i++][i++][i++][i++] = 1;\n</code></pre>\n<p>Or does it invoke undefined or unspecified behavior due to unsequenced modification and access to <code>i</code>?</p>\n<p>According to the Java Language Specification, is there a defined evaluation order between each successive <code>[]</code> while indexing a multidimensional array?</p>\n<p>To be clear, this question is about sequencing — the order in which the <em>operands themselves</em> are evaluated — not precedence or implicit parentheses.</p>",
  "Title: How to use array input for a custom GitHub Actions.\nBody: <p>I'm working on a GitHub Action <a href=\"https://github.com/MathieuSoysal/Javadoc-publisher.yml/blob/4ea2062374784e3de840530c99365039f5fa76bb/action.yml#L47-L50\" rel=\"noreferrer\">workflow</a> that uses an array for input.</p>\n<p>I used this solution to simulate an array:</p>\n<pre class=\"lang-yaml prettyprint-override\"><code>      - uses: actions/my-custom-ci\n        with:\n          subdirectories: src/main/java src/test/java\n</code></pre>\n<p>But I want to use a solution like this:</p>\n<pre class=\"lang-yaml prettyprint-override\"><code>      - uses: actions/my-custom-ci\n        with:\n          subdirectories: \n                - src/main/java \n                - src/test/java\n</code></pre>\n<p>Is it possible to use an array input for custom GitHub Actions? If yes, how can we use an array input for custom GitHub Actions?</p>",
  "Title: Merging users with multiple refs and count their collective assets (Java)\nBody: <p>I need a Java solution (JDBC/SQL is fine) for the following problem.</p>\n<p>There is a set of users. A person can have multiple users, but <code>ref1</code> and <code>ref2</code> might be alike and can therefore link users together. <code>ref1</code> and <code>ref2</code> do not overlap; a value in <code>ref1</code> does not exist in <code>ref2</code>.</p>\n<p>A user can own multiple assets. I want to merge users that have one or more refs alike and then count how many assets they own together. There could be missing entries in the user table; in that case I want to propagate the owner into <code>ref2</code> and set the <code>asset_count</code> and <code>asset_ids</code>.</p>\n<p>Here is an example schema to illustrate:</p>\n<p><strong>Example assets</strong></p>\n<pre><code>SELECT * FROM assets;\n</code></pre>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>id</th>\n<th>name</th>\n<th>owner</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>#1</td>\n<td>a</td>\n</tr>\n<tr>\n<td>2</td>\n<td>#2</td>\n<td>b</td>\n</tr>\n<tr>\n<td>3</td>\n<td>#3</td>\n<td>c</td>\n</tr>\n<tr>\n<td>4</td>\n<td>#4</td>\n<td>a</td>\n</tr>\n<tr>\n<td>5</td>\n<td>#5</td>\n<td>c</td>\n</tr>\n<tr>\n<td>6</td>\n<td>#6</td>\n<td>d</td>\n</tr>\n<tr>\n<td>7</td>\n<td>#7</td>\n<td>e</td>\n</tr>\n<tr>\n<td>8</td>\n<td>#8</td>\n<td>d</td>\n</tr>\n<tr>\n<td>9</td>\n<td>#9</td>\n<td>a</td>\n</tr>\n<tr>\n<td>10</td>\n<td>#10</td>\n<td>a</td>\n</tr>\n<tr>\n<td>11</td>\n<td>#11</td>\n<td>z</td>\n</tr>\n</tbody>\n</table>\n</div><hr />\n<p><strong>Example users</strong></p>\n<pre><code>SELECT * FROM users;\n</code></pre>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>id</th>\n<th>username</th>\n<th>ref1</th>\n<th>ref2</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>bobo</td>\n<td>a</td>\n<td>d</td>\n</tr>\n<tr>\n<td>2</td>\n<td>toto</td>\n<td>b</td>\n<td>e</td>\n</tr>\n<tr>\n<td>3</td>\n<td>momo</td>\n<td>c</td>\n<td>d</td>\n</tr>\n<tr>\n<td>4</td>\n<td>lolo</td>\n<td>a</td>\n<td>f</td>\n</tr>\n<tr>\n<td>5</td>\n<td>popo</td>\n<td>c</td>\n<td>f</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p><strong>What I want to get in the end</strong></p>\n<pre><code>SELECT * FROM results;\n</code></pre>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>ids</th>\n<th>usernames</th>\n<th>refs1</th>\n<th>refs2</th>\n<th>asset_ids</th>\n<th>asset_count</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1,3,4,5</td>\n<td>bobo,momo,lolo,popo</td>\n<td>a,c</td>\n<td>d,f</td>\n<td>1,3,4,5,6,8,9,10</td>\n<td>8</td>\n</tr>\n<tr>\n<td>2</td>\n<td>toto</td>\n<td>b</td>\n<td>e</td>\n<td>2,7</td>\n<td>2</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td></td>\n<td>z</td>\n<td>11</td>\n<td>1</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>I've tried different approaches, but this is what I currently have:</p>\n<p><strong>Closest I have got</strong></p>\n<pre><code>SELECT\n  ARRAY_AGG(DISTINCT u.id) AS ids,\n  ARRAY_AGG(DISTINCT u.username) AS usernames,\n  ARRAY_AGG(DISTINCT u.ref1) AS refs1,\n  ARRAY_AGG(DISTINCT u.ref2) AS refs2,\n  COUNT(DISTINCT a.id) AS asset_count\nFROM assets a\nJOIN users u ON a.owner = u.ref1 OR a.owner = u.ref2\nGROUP BY a.owner\nORDER BY MIN(a.id);\n</code></pre>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>ids</th>\n<th>usernames</th>\n<th>refs1</th>\n<th>refs2</th>\n<th>asset_count</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1,4</td>\n<td>bobo,lolo</td>\n<td>a</td>\n<td>d,f</td>\n<td>4</td>\n</tr>\n<tr>\n<td>2</td>\n<td>toto</td>\n<td>b</td>\n<td>e</td>\n<td>1</td>\n</tr>\n<tr>\n<td>3,5</td>\n<td>momo,popo</td>\n<td>c</td>\n<td>d,f</td>\n<td>2</td>\n</tr>\n<tr>\n<td>1,3</td>\n<td>bobo,momo</td>\n<td>a,c</td>\n<td>d</td>\n<td>2</td>\n</tr>\n<tr>\n<td>2</td>\n<td>toto</td>\n<td>b</td>\n<td>e</td>\n<td>1</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>If I merge the above table on ids, I almost get the result I want (without the missing entries in the user table). The merging can be done in code, but then I cannot paginate. I want to do this in the DB layer if possible.</p>\n<p>I want either a solution to the problem or a good explanation of why it is not possible to do (with examples). Please see the DB Fiddle:</p>\n<pre><code>https://www.db-fiddle.com/f/4jyoMCicNSZpjMt4jFYoz5/8836\n</code></pre>",
  "Title: Arrays.sort range invocation causes array index out of bounds error.\nBody: <p>The code below fails with an <code>ArrayIndexOutOfBoundsException</code>.\nI don't understand why, <code>w</code> is guaranteed to be &lt;= <code>arr1.length</code>.</p>\n<p><a href=\"https://godbolt.org/z/5n5KohsnW\" rel=\"nofollow noreferrer\">https://godbolt.org/z/5n5KohsnW</a></p>\n<pre><code>import java.util.Arrays;\nimport java.util.Comparator;\n\nclass Demo {\n    static boolean testFunc() { return false; }\n\n    record Pair(double d, int i) {}\n\n    int tempFunc() {\n        Pair[] arr1 = new Pair[5];\n        int w = 0;\n        for (int i = 0; i &lt; 5; ++i) {\n            if (testFunc()) {\n                arr1[w] = new Pair(3.0, 4);\n                w++;\n            }\n        }\n        Arrays.sort(arr1, 0, w, Comparator.comparingDouble(Pair::d));\n        return 0;\n    }\n}\n</code></pre>",
  "Title: Why is this Java program producing a Collection of List rather than a simple List?\nBody: Here’s a Java version of what I’m doing:\n\n```java\nimport java.nio.file.*;\nimport java.util.*;\n\npublic class Main {\n    public static void main(String[] args) throws Exception {\n        Map<String, List<Object>> f = new HashMap<>();\n\n        try (DirectoryStream<Path> stream = Files.newDirectoryStream(\n                Paths.get(System.getProperty(\"user.home\")))) {\n            for (Path file : stream) {\n                String filename = file.getFileName().toString();\n                f.computeIfAbsent(filename, k -> new ArrayList<>())\n                 .addAll(List.of(file, Math.random()));\n            }\n        }\n\n        // just need any old random element\n        Map.Entry<String, List<Object>> entry =\n                f.entrySet().stream().findAny().get();\n\n        Map<String, List<Object>> p = new HashMap<>();\n        p.put(entry.getKey(), entry.getValue());\n\n        System.out.println(p.getClass().getName());\n        System.out.println(p.values().getClass().getName() + \" has \" + p.values().size() + \" elements\");\n        System.out.println(p.values().iterator().next().getClass().getName()\n                + \" has \" + p.values().iterator().next().size() + \" elements\");\n\n        System.out.println();\n        System.out.println(System.getProperty(\"java.runtime.version\"));\n        System.out.println(System.getProperty(\"os.name\") + \" \" + System.getProperty(\"os.version\"));\n        System.out.println(System.getProperty(\"os.arch\"));\n        System.out.println(System.getProperty(\"java.vm.name\") + \" \" + System.getProperty(\"java.vm.version\"));\n    }\n}\n```\n\nOutput:\n\n```\njava.util.HashMap\njava.util.HashMap$Values has 1 elements\njava.util.ArrayList has 2 elements\n\n21.0.2+13-LTS\nmacOS 13.2.1\naarch64\nOpenJDK 64-Bit Server VM 21.0.2+13-LTS\n```\n\nWhy is `p.values()` a `Collection` of `List`, rather than a simple `List`?",
  "Title: Extend list with another list at a specific index?\nBody: <p>In Java I can add one list to another with <code>addAll()</code>, but it adds the second list at the end of the first list.</p>\n<pre><code>List&lt;Integer&gt; lst1 = new ArrayList&lt;&gt;(Arrays.asList(1, 4, 5));\nList&lt;Integer&gt; lst2 = Arrays.asList(2, 3);\n\nlst1.addAll(lst2);\n\nOutput:\n[1, 4, 5, 2, 3]\n</code></pre>\n<p>How would I add the second list to be part of the first element so the result is this?</p>\n<pre><code>[1, 2, 3, 4, 5]\n</code></pre>\n<p>I tried something like <code>lst1.add(1, lst2)</code> but it doesn't do what I want. How do I insert all elements of <code>lst2</code> starting at index 1?</p>",
  "Title: Can you initialize a \"char[]\" with a string literal in Java?\nBody: <p>In Java, a string literal has type <code>String</code>, while a character array has type <code>char[]</code>. It’s not obvious whether a <code>char[]</code> can be initialized directly from a string literal, or whether you must use an array initializer or call <code>toCharArray()</code>.</p>\n<p>This is the situation I’m asking about:</p>\n<pre class=\"lang-java prettyprint-override\"><code>char[] str = \"test\"; // is this valid?\n</code></pre>\n<p>If it’s not valid, what part of the Java language specification makes it invalid, and what’s the correct way to initialize a <code>char[]</code> from a literal?</p>",
  "Title: Is javac wrong to allow initializing a final array field with another array reference?\nBody: <p>While (re)implementing a simple compile‑time map in Java, I wrote this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>final class FlatMap&lt;K, V&gt; {\n    private static final class Pair&lt;K, V&gt; {\n        final K key;\n        final V value;\n        Pair(K key, V value) { this.key = key; this.value = value; }\n    }\n\n    private final Pair&lt;K, V&gt;[] elements;\n\n    FlatMap(Pair&lt;K, V&gt;[] arr) {\n        this.elements = arr; // javac allows this\n    }\n\n    V get(K key) {\n        for (Pair&lt;K, V&gt; elem : elements) {\n            if (elem.key.equals(key)) {\n                return elem.value;\n            }\n        }\n        throw new IllegalArgumentException(\"Key not found\");\n    }\n}\n\npublic class Demo {\n    public static void main(String[] args) {\n        FlatMap.Pair&lt;Integer, Character&gt;[] data = new FlatMap.Pair[] {\n            new FlatMap.Pair&lt;&gt;(4, 'a'),\n            new FlatMap.Pair&lt;&gt;(-1, 'b'),\n            new FlatMap.Pair&lt;&gt;(42, 'c')\n        };\n        FlatMap&lt;Integer, Character&gt; m = new FlatMap&lt;&gt;(data);\n        System.out.println(m.get(4)); // prints 'a'\n    }\n}\n</code></pre>\n<p>I naively thought that making the private array <code>elements</code> <code>final</code> and assigning it in the constructor would make the map immutable. It compiles and runs fine with <em>javac</em>.</p>\n<p>Is this actually correct Java, or am I relying on behavior that makes the map mutable in practice? What’s the right way to avoid copying the array elements by hand while still keeping the map immutable?</p>",
  "Title: why Pair<int[], int[]> cannot be instantiated in Java?\nBody: <p>Why can't the Java code below be compiled?</p>\n<pre><code>import org.apache.commons.lang3.tuple.Pair;\n\npublic class Main {\n    public static void main(String[] args) {\n        int[] x = new int[6];\n        int[] y = new int[6];\n        Pair&lt;int[], int[]&gt; a = new Pair&lt;&gt;(x, y);\n    }\n}\n</code></pre>\n<p>For example, the compiler reports:</p>\n<blockquote>\n<p>Pair is abstract; cannot be instantiated</p>\n</blockquote>\n<p>I know I can use other Java alternatives, but I want to understand why this code can't be compiled.</p>",
  "Title: toSpliced() method causing “cannot find symbol” in VS Code\nBody: <p>I am getting the following error in the VS Code Problems panel when I compile:</p>\n<p><code>error: cannot find symbol<br/>\n  method toSpliced(int,int,String)</code></p>\n<p>when I run this code:</p>\n<pre><code>import java.util.ArrayList;\nimport java.util.List;\n\npublic class Main {\n    public static void main(String[] args) {\n        List&lt;String&gt; months = new ArrayList&lt;&gt;(List.of(\"Jan\", \"Mar\", \"Apr\", \"May\"));\n\n        // Inserting an element at index 1\n        List&lt;String&gt; months2 = months.toSpliced(1, 0, \"Feb\");\n        System.out.println(months2); // [Jan, Feb, Mar, Apr, May]\n    }\n}\n</code></pre>\n<p>It is not even my code, I copy-pasted it from a tutorial while trying to learn the <code>toSpliced()</code> method.</p>\n<p>Any help would be highly appreciated. Thank you.</p>",
  "Title: Is a two-dimensional array stored as a single contiguous block in Java?\n\nBody: <p>I have a question about the memory layout of a two-dimensional array in Java.\nWhen we define one, like <code>int[][] a = new int[3][4];</code>, is the memory for this array contiguous?</p>\n<p>Or in other words, is a two-dimensional array implemented as a single continuous one-dimensional array?</p>\n<p>If the answer is yes, is accessing <code>a[0][6]</code> equivalent to accessing <code>a[1][2]</code>?</p>\n<p>I wrote the following Java program.</p>\n<pre><code>public class Main {\n    public static void main(String[] args) {\n        int[][] a = {\n            {1, 2, 3, 4},\n            {5, 6, 7, 8},\n            {9, 10, 11, 12}\n        };\n        System.out.println(a[0][6] + \" \" + a[1][2]);\n    }\n}\n</code></pre>\n<p>I find that this throws <code>ArrayIndexOutOfBoundsException</code>.</p>\n<p><code>a[0][6]</code> seems illegal, but I expected it to point to <code>a[1][2]</code>. I want to know why and whether such access is legal in Java.</p>",
  "Title: How to shuffle array of items but allow weights to influence the order.\nBody: <p>I'm trying to write a Java function to shuffle an array.</p>\n<p>By default, I want the shuffle order to be random (but subject to a seed).\n(I already have access to a seeded random number generator.)</p>\n<p>However, I want to also allow influencing the order via weights per item.</p>\n<p>In other words, I want the default item weight to be 1, and if an item has a weight of 10, it should be 10 times more likely to appear sooner in the shuffled order.</p>\n<p>Am I even thinking about this correctly? Is this a reasonable goal?</p>\n<p>I was thinking that I'd need to use the Fisher–Yates algorithm but adapted to honor a weights array of the same length as the main array, and the main array will be shuffled such that higher weighted items are more likely to appear first.</p>\n<pre><code>public static &lt;T&gt; List&lt;T&gt; removeDuplicates(List&lt;T&gt; list) {\n    Set&lt;T&gt; unique = new HashSet&lt;&gt;();\n    List&lt;T&gt; result = new ArrayList&lt;&gt;();\n    for (T item : list) {\n        if (unique.add(item)) {\n            result.add(item);\n        }\n    }\n    return result;\n}\n\npublic static &lt;T&gt; List&lt;T&gt; duplicateItemsBasedOnWeights(List&lt;T&gt; list, List&lt;Integer&gt; weights) {\n    List&lt;T&gt; result = new ArrayList&lt;&gt;();\n    for (int i = 0; i &lt; list.size(); i++) {\n        T element = list.get(i);\n        int weight = weights.get(i);\n        for (int position = 0; position &lt; weight; position++) {\n            result.add(element);\n        }\n    }\n    return result;\n}\n\npublic static &lt;T&gt; List&lt;T&gt; shuffleWithWeights(List&lt;T&gt; list, List&lt;Integer&gt; weights, long seed) {\n    List&lt;T&gt; listWithDuplicates = duplicateItemsBasedOnWeights(list, weights);\n    List&lt;T&gt; shuffled = shuffleArrayUsingFisherYates(listWithDuplicates, seed);\n    return removeDuplicates(shuffled);\n}\n</code></pre>\n<p>I've looked at empirical results by calling it a bunch of different times with these values (and a different seed each time), and the results don't seem distributed how I'd hoped, so I must have been approaching this problem incorrectly.</p>\n<pre><code>List&lt;Integer&gt; items = Arrays.asList(1, 2, 3, 4, 5);\nList&lt;Integer&gt; weights = Arrays.asList(1, 1, 1, 200, 1000);\n</code></pre>\n<p>In my real-world cases, I'll be shuffling 70,000 objects (which would explode to <em>many</em> more than that if I use my current approach of creating duplicate items based on item weight).</p>",
  "Title: Why does a nested array object prevent providing storage?\nBody: <p>In the Java Language Specification, array objects are distinct objects with their own lifetimes and storage, and arrays of bytes are often used with <code>ByteBuffer</code> or <code>Unsafe</code> for low-level storage. Suppose I’m trying to understand a rule that says an object can be created within a byte array’s storage only if there is no array object nested within the array that also meets the same constraints.</p>\n<p>Why is that “no nested array” condition necessary? If there is a nested array (for example, an array view or subrange within the same backing byte array), what difficulty does it pose to allow a disjoint segment of the outer array’s storage to be used for object creation?</p>\n<p>If the nested array itself has no further nested arrays, can it provide storage? If so, why can’t the outer array also provide storage for the same region as long as the segment used does not straddle the start or end of any nested array (even indirectly)?</p>\n<p>And even if it does straddle a nested array boundary, what concrete problems arise that would justify forbidding it?</p>\n<p>Finally, can a nested array partially overlap the storage needed for the new object (so it fails the “fits entirely within” constraint)? Can such partially overlapping arrays exist in Java? Under what conditions would one array be considered nested within another, and can two arrays ever be nested within each other?</p>",
  "Title: Why can I declare array with a constant size in some cases and not others?\nBody: <p>I’m trying to create a class that includes a 2D array along with some member functions.</p>\n<p>When I write:</p>\n<pre><code>class Board {\n    final int BOARDSIZE = 8;\n\n    boolean[][] data = new boolean[BOARDSIZE][BOARDSIZE];\n}\n</code></pre>\n<p>I get a compile error about referencing a non-static field from a static context. However, when I write:</p>\n<pre><code>final class Constants {\n    static final int BOARDSIZE = 8;\n}\n\nclass Board {\n    boolean[][] data = new boolean[Constants.BOARDSIZE][Constants.BOARDSIZE];\n}\n</code></pre>\n<p>or:</p>\n<pre><code>class Board {\n    boolean[][] data = new boolean[8][8];\n}\n</code></pre>\n<p>there is no error. I’ve searched around and can’t figure out why it won’t accept one and not the other. I’d rather not declare BOARDSIZE as a global variable because I don’t want it just floating around in a large project, but I also don’t want to have to write 8 every time a member function needs the board size for flexibility later.</p>\n<p>Is there a way to have a local variable that represents the size of the board?</p>",
  "Title: Obtain palindromic array by performing these operations.\nBody: <p>An array is called palindromic if it remains the same after reversing the order of its elements.</p>\n<p>You have an array of strings <code>arr</code>. For each i, <code>arr[i]</code> consists of at least two characters. For each pair of consecutive elements <code>arr[i]</code> and <code>arr[i + 1]</code>, you can:</p>\n<ol>\n<li>Move the rightmost character of <code>arr[i]</code> to the leftmost position in <code>arr[i + 1]</code>. For instance, \"abc\" and \"def\" will become \"ab\" and \"cdef\". This operation can be applied only once to any pair of consecutive elements.</li>\n<li>Move the leftmost character of <code>arr[i + 1]</code> to the rightmost position in <code>arr[i]</code>. For instance, \"abc\" and \"def\" will become \"abcd\" and \"ef\". Again, this operation can be applied only once to any pair of consecutive elements.</li>\n<li>Do nothing to the pair of consecutive elements.</li>\n</ol>\n<p>Is it possible to obtain a palindromic array from <code>arr</code> by performing these operations?</p>\n<p>Consider the case when <code>arr = {\"aa\", \"bab\", \"cde\", \"aba\", \"ab\"}</code>. Here the output should be true and here is why:</p>\n<p>Move first char from 1st index to the last position of 0th index, <code>arr = {\"aab\", \"ab\", \"cde\", \"aba\", \"ab\"}</code>\nMove last char from 3rd index to the first position of 4th index, <code>arr = {\"aab\", \"ab\", \"cde\", \"ab\", \"aab\"}</code>, which is a palindromic array.</p>\n<p>I tried solutions such as two pointer, etc. but doesn't seem to work. How can I solve this in Java?</p>",
  "Title: sorting a list of objects in Java\nBody: <p>Hello everyone I still can't sort the list correctly. We need to sort the following list:</p>\n<pre><code>class Node {\n    long id;\n    long parentId;\n    String title;\n    String type;\n\n    Node(long id, long parentId, String title, String type) {\n        this.id = id;\n        this.parentId = parentId;\n        this.title = title;\n        this.type = type;\n    }\n}\n\nList&lt;Node&gt; arr = List.of(\n     new Node(3123124L, 0L, \"title\", \"block\"),\n     new Node(3542132L, 3123124L, \"title\", \"child\"),\n     new Node(12345L, 88888L, \"title\", \"block\"),\n     new Node(24124L, 12345L, \"title\", \"child\"),\n     new Node(99999L, 45324L, \"title\", \"child\"),\n     new Node(986648L, 3123124L, \"title\", \"block\"),\n     new Node(77777L, 88888L, \"title\", \"child\"),\n     new Node(54232L, 3123124L, \"title\", \"child\"),\n     new Node(54308L, 15075L, \"title\", \"child\"),\n     new Node(66666L, 88888L, \"title\", \"block\"),\n     new Node(56445L, 12345L, \"title\", \"child\"),\n     new Node(88888L, 45324L, \"title\", \"block\"),\n     new Node(15075L, 12345L, \"title\", \"block\"),\n     new Node(84356L, 66666L, \"title\", \"child\"),\n     new Node(45324L, 0L, \"title\", \"block\")\n);\n\nList&lt;Node&gt; newArr = List.of(\n    new Node(3123124L, 0L, \"title\", \"block\"),\n    new Node(3542132L, 3123124L, \"title\", \"child\"),\n    new Node(54232L, 3123124L, \"title\", \"child\"),\n    new Node(986648L, 3123124L, \"title\", \"block\"),\n    new Node(45324L, 0L, \"title\", \"block\"),\n    new Node(99999L, 45324L, \"title\", \"child\"),\n    new Node(88888L, 45324L, \"title\", \"block\"),\n    new Node(77777L, 88888L, \"title\", \"child\"),\n    new Node(12345L, 88888L, \"title\", \"block\"),\n    new Node(56445L, 12345L, \"title\", \"child\"),\n    new Node(24124L, 12345L, \"title\", \"child\"),\n    new Node(15075L, 12345L, \"title\", \"block\"),\n    new Node(54308L, 15075L, \"title\", \"child\"),\n    new Node(66666L, 88888L, \"title\", \"block\"),\n    new Node(84356L, 66666L, \"title\", \"child\")\n);\n</code></pre>\n<ul>\n<li>arr - list to sort</li>\n<li>newArr - is a list that should turn out to be</li>\n</ul>\n<p>So that the topmost elements have <code>parentId: 0</code>, and their lowest children, who have the same <code>parentId</code> <code>id</code>, and so on, there can be as many elements as you like.\nIf the <code>parentId</code> is the same for several elements, then <code>child</code> comes first, the most recent <code>block</code> and its children below, if there are any.</p>\n<p>I tried to add to a new list by the <code>parentId</code> property, but in the end the order of the elements was lost</p>",
  "Title: java.lang.UnsatisfiedLinkError: libcublas.so.* not found in java.library.path\nBody: <p>I’m trying to use the Deep Java Library (DJL) in a Spring Boot REST API. I manage dependencies with Maven and added DJL to my <code>pom.xml</code> (e.g., <code>ai.djl:djl-api</code> and <code>ai.djl.pytorch:pytorch-engine</code>). When I start the app and initialize the model, I get this error:</p>\n<pre><code>java.lang.UnsatisfiedLinkError: libcublas.so.* not found in java.library.path\n</code></pre>\n<p>How can I fix this?</p>",
  "Title: Spring Boot/Thymeleaf returns \"TemplateInputException\" when using a Bootstrap form fragment\nBody: <p>Using Thymeleaf with Spring Boot, I only get a <code>TemplateInputException</code> when I try to render a form with a Bootstrap fragment.</p>\n<p>I'm new to Thymeleaf form fragments (often recommended for quickly making forms look better), and I followed the Thymeleaf + Spring Boot setup docs. As far as I can tell, the setup is correct (Maven dependencies and <code>application.properties</code> changes). I’m running in a Windows dev environment.</p>\n<p>I even created a minimal project to test this. The project is called <code>stuff</code> and it has a single app package called <code>other</code>.</p>\n<p><strong>pom.xml</strong></p>\n<pre><code>&lt;dependencies&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-validation&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;nz.net.ultraq.thymeleaf&lt;/groupId&gt;\n        &lt;artifactId&gt;thymeleaf-layout-dialect&lt;/artifactId&gt;\n        &lt;version&gt;3.2.1&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.webjars&lt;/groupId&gt;\n        &lt;artifactId&gt;bootstrap&lt;/artifactId&gt;\n        &lt;version&gt;4.6.2&lt;/version&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;\n</code></pre>\n<p><strong>application.properties</strong></p>\n<pre><code>spring.thymeleaf.prefix=classpath:/templates/\nspring.thymeleaf.suffix=.html\nspring.thymeleaf.cache=false\n</code></pre>\n<p><strong>Mine.java</strong></p>\n<pre><code>package other.model;\n\npublic class Mine {\n    private String name;\n    private String email;\n\n    // getters/setters\n}\n</code></pre>\n<p><strong>MineForm.java</strong></p>\n<pre><code>package other.web;\n\nimport jakarta.validation.constraints.Email;\nimport jakarta.validation.constraints.NotBlank;\n\npublic class MineForm {\n    @NotBlank\n    private String name;\n\n    @Email\n    private String email;\n\n    // getters/setters\n}\n</code></pre>\n<p><strong>MineController.java</strong></p>\n<pre><code>package other.web;\n\nimport org.springframework.stereotype.Controller;\nimport org.springframework.ui.Model;\nimport org.springframework.web.bind.annotation.GetMapping;\n\n@Controller\npublic class MineController {\n\n    @GetMapping(\"/\")\n    public String idx(Model model) {\n        model.addAttribute(\"aform\", new MineForm());\n        return \"test\";\n    }\n}\n</code></pre>\n<p><strong>test.html</strong></p>\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\" xmlns:th=\"http://www.thymeleaf.org\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;TestThing&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;form th:action=\"@{/}\" th:object=\"${aform}\" method=\"post\"&gt;\n        &lt;div th:replace=\"bootstrap4/uni_form :: formFields\"&gt;&lt;/div&gt;\n        &lt;button type=\"submit\"&gt;Submit&lt;/button&gt;\n    &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n<p><strong>Error reported</strong></p>\n<pre><code>org.thymeleaf.exceptions.TemplateInputException: Error resolving template [bootstrap4/uni_form], template might not exist or might not be accessible\n</code></pre>\n<p><em><strong>Template resolution details</strong></em></p>\n<pre><code>Template resolution for template [bootstrap4/uni_form]\n</code></pre>\n<p>It looks like Thymeleaf can’t see the templates that should be available. Or maybe there’s something else I need to download or create?</p>\n<p>I wanted a quick way to clean up a form before moving on to more pressing tasks, but I can’t get the Bootstrap form fragment to render at all. What am I missing?</p>\n<p><strong>Other things I tried</strong></p>\n<ul>\n<li>Pointing <code>th:replace</code> at a different fragment name — same error</li>\n<li>Removing the WebJars Bootstrap dependency and linking Bootstrap via CDN — no difference</li>\n<li>Creating a blank <code>bootstrap4/uni_form.html</code> template manually — the form renders but without fields</li>\n<li>Using <code>th:insert</code> instead of <code>th:replace</code> — same error</li>\n</ul>",
  "Title: How to fetch data server-side in the latest Spring Boot? Tried RestTemplate but the list is null and causes a NullPointerException\nBody: <p>I am working with a Django Rest Framework API and a Spring Boot MVC app, and I’m stuck on fetching data from the API server‑side. I have data at <code>http://127.0.0.1:8000/api/campaigns</code> and when I visit the URL I see the JSON.</p>\n<p>The problem is when I fetch and log the data in Spring Boot, I get <code>null</code>. Also when I try iterating the list in the template, I get a <code>NullPointerException</code>.</p>\n<p>Here is my Spring Boot controller where the data fetching is done:</p>\n<pre><code>import org.springframework.stereotype.Controller;\nimport org.springframework.ui.Model;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.client.RestTemplate;\n\nimport java.util.Arrays;\nimport java.util.List;\n\n@Controller\npublic class IndexController {\n\n    @GetMapping(\"/\")\n    public String index(Model model) {\n        RestTemplate restTemplate = new RestTemplate();\n        Campaign[] response = restTemplate.getForObject(\n                \"http://127.0.0.1:8000/api/campaigns\",\n                Campaign[].class\n        );\n        List&lt;Campaign&gt; data = Arrays.asList(response);\n        System.out.println(data);\n        model.addAttribute(\"data\", data);\n        return \"index\";\n    }\n}\n</code></pre>\n<p>And here is the Thymeleaf template:</p>\n<pre><code>&lt;main&gt;\n  &lt;h1&gt;Available Campaigns&lt;/h1&gt;\n  &lt;div th:each=\"element : ${data}\"&gt;\n    &lt;div&gt;\n      &lt;img th:src=\"${element.logo}\" height=\"120\" width=\"100\" alt=\"image\" /&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/main&gt;\n</code></pre>\n<p>I can see the JSON when I hit the API URL directly, but the list is null inside the controller. What’s the correct way to fetch this server‑side in Spring Boot so the data is available to the template?</p>\n<p>Also note that I am using the latest Spring Boot. Any help is appreciated. Thanks.</p>",
  "Title: Spring Boot admin page showing a white box instead of theme toggle icon.\nBody: <p>When I open my Spring Boot admin page, a wide white box appears instead of the theme toggle icon (Spring Boot 3.2.1 with Thymeleaf).</p>\n<p><a href=\"https://i.stack.imgur.com/dXqnL.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/dXqnL.png\" alt=\"admin page as appears on production\" /></a></p>\n<p>While testing in a Docker container, everything looks fine.</p>\n<p><a href=\"https://i.stack.imgur.com/zoDtk.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/zoDtk.png\" alt=\"admin page while testing on Docker container\" /></a></p>\n<p>I checked the documentation about overriding the admin layout template, but I’m not sure that’s the issue.</p>\n<p>After deployment (on EC2), the logs don’t show anything unusual.</p>\n<p>I’m letting Nginx (1.23) serve the static content.</p>\n<pre><code>mvn -DskipTests clean package\n</code></pre>\n<p>Overall, all static files are working properly on the rest of the site.</p>\n<p>I tried inspecting the element <code>&lt;button class=&quot;theme-toggle&quot;&gt;</code>. Nothing seems anomalous.</p>\n<p>Everything looks <em>normal</em> to me. Apart from this, production looks identical to the Docker container.</p>",
  "Title: How to safely and atomically decrement a counter with Spring and PostgreSQL?\n\nBody: <p>I've been reading up on PostgreSQL transaction isolation and how that relates to Spring's <code>@Transactional</code> (e.g. <a href=\"https://www.postgresql.org/docs/15/transaction-iso.html\" rel=\"noreferrer\">PostgreSQL docs</a>), but I'm far from fluent in this topic and I'm not sure I understand what I've read.</p>\n<p>We've got a PostgreSQL-backed Java app that involves quota objects. Simplified, it's just this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Entity\npublic class Quota {\n    @OneToOne\n    private AnotherEntity obj;\n\n    private int count;\n}\n</code></pre>\n<p>An instance of this controls how many times a certain operation can be performed against the <code>obj</code> instance. <code>count</code> is initialized to a certain number, and will only ever decrement until it hits zero.</p>\n<p>Any number of processes/threads can concurrently perform these operations. Basically, we need to atomically decrement (with UPDATE) the <code>count</code> of a single database row without deadlocking and without two processes/threads ever e.g. starting with a <code>count</code> of 100 and both trying to decrement it to 99.</p>\n<p>My naive approach would be something like this using Spring Data JPA:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Transactional(isolation = Isolation.SERIALIZABLE)\npublic void decrement(AnotherEntity instance) {\n    quotaRepository.decrementCount(instance);\n}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>@Modifying\n@Query(\"update Quota q set q.count = q.count - 1 where q.obj = :obj\")\nvoid decrementCount(@Param(\"obj\") AnotherEntity obj);\n</code></pre>\n<p>However, I'm not sure if this is subject to this issue I've read about with SERIALIZABLE transactions failing at commit time due to serialization conflicts, even if they updated different rows.</p>\n<p>All the processes/threads performing operations against the same <code>obj</code> would be decrementing the same column of the same row, so... maybe? I don't actually know what's involved in PostgreSQL \"determin[ing] that the transaction could have been performed serially\".</p>\n<p>An alternate approach could be to lock the row first:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Transactional\npublic void decrementWithLock(AnotherEntity instance) {\n    Quota q = quotaRepository.findByObjForUpdate(instance);\n    q.setCount(q.getCount() - 1);\n}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>@Lock(LockModeType.PESSIMISTIC_WRITE)\n@Query(\"select q from Quota q where q.obj = :obj\")\nQuota findByObjForUpdate(@Param(\"obj\") AnotherEntity obj);\n</code></pre>\n<p>This seems to do row-level locking, and my understanding is that the isolation level change isn't needed, but I don't know if this is sufficient for correct handling of concurrent operations.</p>\n<p>Is one of these approaches preferable here, and are some modifications still necessary to guarantee atomicity and deadlock avoidance? We could use something like Redis-based locks to also prevent concurrent DB operations at the service layer, but this feels like a more natural fit to do at the DB level.</p>",
  "Title: how to resolve Java: NoClassDefFoundError for org.springframework.web.multipart.MultipartResolver\nBody: <p>My application was running fine till few days back, but now all of a sudden I'm seeing this error and not sure what it means, please help.</p>\n<p>Error:</p>\n<pre><code>Exception in thread \"main\" java.lang.NoClassDefFoundError: org/springframework/web/multipart/MultipartResolver\n    at com.myproj.myapp.WebConfig.&lt;clinit&gt;(WebConfig.java:8)\n    at com.myproj.myapp.Application.main(Application.java:12)\nCaused by: java.lang.ClassNotFoundException: org.springframework.web.multipart.MultipartResolver\n    at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641)\n    at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:188)\n    at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:525)\n</code></pre>\n<p>my line 8 of WebConfig.java is:</p>\n<pre><code>import org.springframework.web.multipart.MultipartResolver;\n</code></pre>\n<p>and I can see the MultipartResolver class in the spring-web source jar</p>\n<p><a href=\"https://i.stack.imgur.com/c70Wy.png\" rel=\"noreferrer\">spring-web source jar</a></p>",
  "Title: Spring Data MongoDB embedded document mapping fails because of renamed field\nBody: <p>I have a Spring Boot application using Spring Data MongoDB. My documents look like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Document(\"blog\")\npublic class Blog {\n    @Id\n    private ObjectId id;\n\n    @Field(\"Name\")\n    private String name;\n\n    private String tagline;\n}\n\n@Document(\"entry\")\npublic class Entry {\n    @Id\n    private ObjectId id;\n\n    private Blog blog;\n}\n</code></pre>\n<p>When I run the application, I get a validation/mapping error saying that the embedded document field name cannot differ from the stored field name.</p>\n<p>I need to keep the Java field name as <code>name</code> but the existing database uses camelCase (e.g., <code>Name</code>). I can’t change the database schema.</p>\n<p>How can I map the embedded document field so that the Java field is <code>name</code> while the database field stays <code>Name</code> without errors?</p>",
  "Title: org.flywaydb.core.api.FlywayException: MySQL 8 or later is required (found 5.7.33) during migrations\nBody: <p>I have this error when performing migrations with my command</p>\n<p>I tried this command</p>\n<pre><code>mvn flyway:migrate\n</code></pre>\n<p><strong>but the error persists</strong></p>\n<pre><code>MySQL 8 or later is required (found 5.7.33).\n</code></pre>\n<p>Is there anyway to perform the migration? Or should I downgrade my Java version to v.9?</p>\n<p><strong>Java version</strong></p>\n<pre><code>Java v.17\n</code></pre>",
  "Title: Microservices architecture with Spring Boot.\nBody: <p>I have some questions about creating microservices with Spring Boot.</p>\n<p>Let's say we have an online shop or a larger system with many database requests and users. I want to practice and simulate a simple microservice to learn something new.</p>\n<p>We want to create a microservices-based system with the following components:</p>\n<ol>\n<li>A Spring Boot–based microservice with an admin UI and full functionality (excluding any REST controllers for now).</li>\n<li>One or more microservices with a React/Angular frontend.</li>\n<li>Several additional microservices to separate functionalities.\nI'm unsure about the architecture. Let's assume we want to manage data using the admin UI of the first microservice.</li>\n</ol>\n<p>The simplest solution would be to add REST endpoints to the first microservice and extend its functionality (REST API) instead of creating different services (3.).</p>\n<ol>\n<li>But what if we want to separate functionality into different microservices?</li>\n<li>Should the microservices in point 3 be connected to the same database and treated as different Spring Boot projects (with REST APIs)?</li>\n<li>Can we use Go, FastAPI, or Java Spring for the third microservice? If yes, should all models be duplicated and registered in the first microservice?</li>\n<li>Alternatively, is there a better way to approach this?</li>\n</ol>\n<p>It would be great to hear your perspective and methods on how to proceed with this.</p>\n<p>Have a wonderful day!</p>",
  "Title: Spring Boot “Detected change in ..., reloading” Error in Docker\n\nBody: <p>I'm having a problem which I don't understand, and therefore can't resolve.</p>\n<p>I have a Dockerized Spring Boot project, which I created months ago. Today, my development environment has started displaying the following error on every request:</p>\n<p><a href=\"https://i.stack.imgur.com/jq1A9.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/jq1A9.png\" alt=\"code of error\" /></a></p>\n<p>I am not currently having this issue in production. I tried rolling back to commits that worked properly before (1 week old commits, for example), and I'm still getting this error.</p>\n<p>The reloading is causing connections to the database to close and therefore my project isn't working properly at all.</p>\n<p>Does anyone know what causes this, and how I might fix it? It feels like an issue with my Docker setup, but that hasn't changed in months, so I don't understand why that would change now.</p>\n<p>Many Thanks for any help anyone can offer!</p>",
  "Title: libsodium JNI (Kalium/LazySodium) errors while building arm64 Java images for a Spring Boot app\nBody: <p>Summary:\nI’m trying to build an ARM64 image for my Java/Spring Boot project so it runs fast locally on my MacBook M1 (Pro), instead of using x64 images that are very slow (long startup time, slow HTTP response for local dev, long test runs).</p>\n<p>I have the following Dockerfile:</p>\n<pre><code>FROM arm64v8/openjdk:17-jdk-slim\n\n# Install system dependencies\nRUN apt-get update &amp;&amp; apt-get install -y \\\n    git \\\n    curl \\\n    build-essential \\\n    libsodium-dev \\\n    libssl-dev \\\n    libffi-dev \\\n    maven\n\n# Set the working directory in the container\nWORKDIR /app\n\n# Copy the Maven project files\nCOPY pom.xml .\nCOPY src ./src\n\n# Build the application\nRUN mvn -DskipTests package\n\n# Expose the Spring Boot port\nEXPOSE 8080\n\n# Run the app\nCMD [\"java\", \"-jar\", \"target/app.jar\"]\n</code></pre>\n<p><code>pom.xml</code> (excerpt):</p>\n<pre><code>&lt;dependencies&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.postgresql&lt;/groupId&gt;\n        &lt;artifactId&gt;postgresql&lt;/artifactId&gt;\n        &lt;scope&gt;runtime&lt;/scope&gt;\n    &lt;/dependency&gt;\n\n    &lt;!-- libsodium JNI --&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.abstractj.kalium&lt;/groupId&gt;\n        &lt;artifactId&gt;kalium&lt;/artifactId&gt;\n        &lt;version&gt;0.8.0&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;!-- plus many other dependencies --&gt;\n&lt;/dependencies&gt;\n</code></pre>\n<p>Build log:\n<code>https://pastebin.com/1xtwdfXY</code> (too long to paste here)</p>\n<p>I’ve already tried everything I can find online, including:</p>\n<ul>\n<li>Installing libsodium via apt instead of relying on JNI packaging</li>\n<li>Using a specific Kalium version (0.8.0)</li>\n<li>Installing libsodium locally on the host (macOS) via <code>brew install libsodium</code></li>\n</ul>\n<p>But nothing helps. Sources:</p>\n<ul>\n<li><code>https://github.com/abstractj/kalium/issues</code></li>\n<li><code>https://github.com/jedisct1/libsodium/issues/721</code></li>\n<li><code>https://github.com/jedisct1/libsodium/issues/1302</code></li>\n<li><code>https://stackoverflow.com/questions/65517524/pynacl-building-problems</code></li>\n</ul>",
  "Title: Spring Security - ClassNotFoundException: org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter even when Spring Security is installed\n\nBody: <p>\"java.lang.ClassNotFoundException: org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter\"</p>\n<p>I keep getting this error in my Spring Boot project even though Spring Security is in my dependencies. I even cleaned and rebuilt, switched JDKs, and re-imported the Maven project but nothing changed. All other imports work except this filter class.</p>\n<p>Help pls?</p>\n<p>pom.xml:</p>\n<pre><code>&lt;dependencies&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;\n</code></pre>\n<p>Security config:</p>\n<pre><code>@Configuration\n@EnableWebSecurity\npublic class SecurityConfig {\n\n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        http\n            .csrf(csrf -&gt; csrf.disable())\n            .authorizeHttpRequests(auth -&gt; auth\n                .requestMatchers(\"/login\", \"/public/**\").permitAll()\n                .anyRequest().authenticated()\n            )\n            // Security filters\n            .addFilterAfter(new UsernamePasswordAuthenticationFilter(), CsrfFilter.class);\n\n        return http.build();\n    }\n}\n</code></pre>\n<p>Update: removed links because of spam filter</p>\n<p>Error location:</p>\n<pre><code>.addFilterAfter(new UsernamePasswordAuthenticationFilter(), CsrfFilter.class);\n</code></pre>\n<p>I've tried reinstalling dependencies and checking other Stack Overflow solutions, but nothing worked so far.</p>",
  "Title: Spring Boot 3.1 + Jackrabbit Oak: NullPointerException when adding a child page  \nBody: I’m trying to integrate a Java CMS (Apache Jackrabbit Oak) into an existing Spring Boot project, but I get a NullPointerException when I add a child page.\n\nDependencies (pom.xml):\n\n```xml\n<dependencies>\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-web</artifactId>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-thymeleaf</artifactId>\n    </dependency>\n    <dependency>\n        <groupId>org.apache.jackrabbit</groupId>\n        <artifactId>oak-jcr</artifactId>\n        <version>1.64.0</version>\n    </dependency>\n</dependencies>\n```\n\nRepository config:\n\n```java\n@Configuration\npublic class CmsConfig {\n\n    @Bean\n    public Repository repository() {\n        return new Jcr(new Oak()).createRepository();\n    }\n}\n```\n\nURL mappings (controller):\n\n```java\n@Controller\npublic class CmsController {\n\n    private final PageService pageService;\n\n    public CmsController(PageService pageService) {\n        this.pageService = pageService;\n    }\n\n    @GetMapping(\"/cms\")\n    public String cmsHome() {\n        return \"cms/index\";\n    }\n\n    @PostMapping(\"/cms/pages/add/news\")\n    public String addNewsPage(@RequestParam String title,\n                              @RequestParam String body) {\n        pageService.addChildNewsPage(title, body);\n        return \"redirect:/cms\";\n    }\n\n    @GetMapping(\"/news/{id}\")\n    public String newsDetail(@PathVariable long id, Model model) {\n        NewsArticlePage page = pageService.getNewsPage(id);\n        model.addAttribute(\"page\", page);\n        return \"news/news_page\";\n    }\n}\n```\n\nService:\n\n```java\n@Service\npublic class PageService {\n\n    private final Repository repository;\n\n    public PageService(Repository repository) {\n        this.repository = repository;\n    }\n\n    public void addChildNewsPage(String title, String body) {\n        try (Session session = repository.login(new SimpleCredentials(\"admin\", \"admin\".toCharArray()))) {\n            Node parent = session.getNode(\"/content/news\");\n            Node child = parent.addNode(\"newsarticlepage\");\n            child.setProperty(\"title\", title);\n            child.setProperty(\"articleBody\", body);\n            session.save();\n        } catch (RepositoryException e) {\n            throw new RuntimeException(e);\n        }\n    }\n\n    public NewsArticlePage getNewsPage(long id) {\n        // simplified for example\n        return new NewsArticlePage(id, \"Title\", \"Body\");\n    }\n}\n```\n\nModel:\n\n```java\npublic class NewsArticlePage {\n    private long id;\n    private String title;\n    private String articleBody;\n\n    public NewsArticlePage(long id, String title, String articleBody) {\n        this.id = id;\n        this.title = title;\n        this.articleBody = articleBody;\n    }\n\n    // getters/setters\n}\n```\n\nThymeleaf template:\n\n```html\n<!DOCTYPE html>\n<html xmlns:th=\"http://www.thymeleaf.org\">\n<body>\n<h1 th:text=\"${page.title}\"></h1>\n<div th:text=\"${page.articleBody}\"></div>\n</body>\n</html>\n```\n\nWhen I submit the form to add a child page, I get:\n\n```\nRequest URL: http://127.0.0.1:7000/cms/pages/add/news\n\njava.lang.NullPointerException\n    at com.example.cms.PageService.addChildNewsPage(PageService.java:26)\n    at com.example.cms.CmsController.addNewsPage(CmsController.java:24)\n    ...\n```\n\nI’ve created the `/content/news` node and verified the repository is working, but the error persists. How should I debug or fix this?",
  "Title: Spring Security JWT refresh token is empty on login response\nBody: <p>I’m having trouble with a JWT setup in a Spring Boot REST API. When I register a new account, the response includes both access and refresh tokens, but when I log in with credentials, I only get the access token and the refresh token is empty.</p>\n<p>I configured everything according to the documentation and the tutorial I’m following. Any idea what could cause this? Please let me know.</p>\n<p>UPDATE: I just found that the refresh token is set correctly in the response header, but it’s empty in the response body. I can’t figure out why.</p>\n<p><strong>Security configuration:</strong></p>\n<pre><code>@Configuration\n@EnableWebSecurity\npublic class SecurityConfig {\n\n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        http\n            .csrf().disable()\n            .authorizeHttpRequests(auth -&gt; auth\n                .requestMatchers(\"/admin/**\").hasRole(\"STAFF\")\n                .anyRequest().permitAll()\n            )\n            .oauth2ResourceServer(oauth2 -&gt; oauth2.jwt());\n        return http.build();\n    }\n}\n</code></pre>\n<p><strong>Application properties:</strong></p>\n<pre><code>jwt.access-cookie=access\njwt.refresh-cookie=refresh\njwt.use-jwt=true\n</code></pre>\n<p><strong>Login response:</strong></p>\n<pre><code>{\n  \"accessToken\": \"eyJhbGciOiJ.....\",\n  \"refreshToken\": \"\",\n  \"user\": {\n    \"id\": 2,\n    \"username\": \"test_user_0\",\n    \"email\": \"test0@mysite.co\",\n    \"firstName\": \"\",\n    \"lastName\": \"\"\n  }\n}\n</code></pre>",
  "Title: \"error: --plat-name must be one of ('win32', 'win-amd64', 'win-arm32', 'win-arm64')\" with Maven while building a PostgreSQL JDBC app\n\nBody: <p>JDK: 17</p>\n<p>Build tool: Maven 3.9.x</p>\n<p>OS: Windows 11</p>\n<p>My Java project uses a Maven build and I’m trying to add the PostgreSQL JDBC driver. The build fails with a platform error similar to “--plat-name must be one of ('win32', 'win-amd64', 'win-arm32', 'win-arm64')”. I also see warnings about deprecated configuration during the build.</p>\n<p>I have not found any solutions for my platform even though the solution exists for other platforms. All dependencies are up to date.</p>\n<p>Adding <code>org.postgresql:postgresql</code> also does not work.</p>\n<p>The full error is below:</p>\n<pre><code>\nPS C:\\Aavash files\\COMP206\\Project\\Movie4AllMoods&gt; mvn clean package\n[INFO] Scanning for projects...\n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD FAILURE\n[INFO] ------------------------------------------------------------------------\n[ERROR] Failed to execute goal on project Movie4AllMoods: \nCould not resolve dependencies for project com.example:Movie4AllMoods:jar:1.0-SNAPSHOT: \nExecution failed for task ':compileJava'.\nerror: --plat-name must be one of ('win32', 'win-amd64', 'win-arm32', 'win-arm64')\n[ERROR] ------------------------------------------------------------------------\n</code></pre>\n<p>I have tried updating Maven and the JDK but that didn't work. Everything else I found were Linux commands that I have been unable to run. It builds fine globally but shows errors in my project. I have tried everything but nothing seems to work.</p>",
  "Title: How does a Spring AMQP worker run the code defined elsewhere in a task?\nBody: <p>I tried reading official documentation as well as other SO threads, but it is still not clear how Spring AMQP works.</p>\n<p>From what I understand:</p>\n<ol>\n<li><strong>Spring Boot app</strong>: Spring AMQP is used in a Spring app where an <code>@RabbitListener</code> method defines the work to be performed.</li>\n<li><strong>Message broker</strong>: A message broker (like RabbitMQ) gets this task from 1. and queues it.</li>\n<li><strong>Worker app</strong>: A completely separate worker app picks up the task and runs it. This worker can be on a completely different machine even, so long as it has access to the message broker.</li>\n</ol>\n<p>So, then the burning question is:</p>\n<p><strong>How does the worker get the code defined in <code>@RabbitListener</code> to run the task?</strong></p>\n<p>Basically, how does 3. get what's defined in 1. if they are only connected using a message broker? Is the Java code stored in the message broker as a string? What is the data structure of the message broker item/record?</p>",
  "Title: Dokku: how to change heroku stack to heroku-20 or heroku-22 (from heroku-18)\nBody: <p>I have been working on a Java project using Dokku (thus Heroku) for deployments. Up until today, all deployments worked just fine, but since this morning, I get this error message:</p>\n<p><em>Requested runtime 'java-17' is not available for this stack (heroku-18).</em></p>\n<p>I know that java-17 is available on heroku-18 so I assume I (finally) have to change stack since heroku-18 is deprecated.</p>\n<p>I have tried using this command on Dokku:</p>\n<p>dokku buildpacks:add --index 1 {APP-NAME} <a href=\"https://github.com/heroku/heroku-buildpack-java.git\" rel=\"nofollow noreferrer\">https://github.com/heroku/heroku-buildpack-java.git</a>,</p>\n<p>but it doesn't solve my problem (heroku-18 is still being used).</p>\n<p>Any help would be greatly appreciated</p>",
  "Title: How to use OpenAI stream=true with a Spring Boot response and still save the streamed content?\n\nBody: <p>I’m trying to use OpenAI’s <code>stream=true</code> from a Java backend and return the streamed tokens to my React frontend.</p>\n<pre><code>OkHttpClient client = new OkHttpClient();\n\nString json = \"{\"\n        + \"\\\"model\\\":\\\"text-davinci-003\\\",\"\n        + \"\\\"prompt\\\":\\\"Write me a story about dogs.\\\",\"\n        + \"\\\"temperature\\\":0.7,\"\n        + \"\\\"max_tokens\\\":1024,\"\n        + \"\\\"frequency_penalty\\\":1.0,\"\n        + \"\\\"presence_penalty\\\":1.0,\"\n        + \"\\\"stream\\\":true\"\n        + \"}\";\n\nRequest request = new Request.Builder()\n        .url(\"https://api.openai.com/v1/completions\")\n        .addHeader(\"Authorization\", \"Bearer \" + System.getenv(\"OPENAI_API_KEY\"))\n        .post(RequestBody.create(json, MediaType.get(\"application/json\")))\n        .build();\n</code></pre>\n<p>In Spring MVC I usually return a standard JSON response, but for streaming I’m seeing examples that use <code>StreamingResponseBody</code> or <code>SseEmitter</code>. I’m not sure how to connect the OpenAI SSE stream to the HTTP response while also collecting the full output so I can save it after the stream finishes (e.g., to a database). The controller method will return immediately once the stream starts, so where should I assemble and persist the final text?</p>\n<p>How do I implement this in Java/Spring so that:</p>\n<ul>\n  <li>the client receives a streaming response, and</li>\n  <li>the full completion is saved once the stream ends?</li>\n</ul>",
  "Title: Too many db connections (Spring Boot 3.x / WebFlux)\nBody: <p>I have deployed a Spring Boot app (reactive WebFlux on Netty) and I’m getting a lot of <code>FATAL: sorry, too many clients already</code> from PostgreSQL.</p>\n<p>I’ve seen reports that this can happen with WebFlux and reactive database access, but I can’t find concrete guidance beyond acknowledgment.</p>\n<p>Is there a workaround, or should I switch to Spring MVC (servlet stack) or downgrade Spring Boot?</p>\n<p>This feels like a blocking issue for using the reactive stack. Shouldn’t it be better documented (unless I missed it)?</p>",
  "Title: How can a nested DTO validator access a parent field when the parent is a list?\n\nBody: <p>I have a parent DTO that contains a list of child DTOs. The parent also has a <code>batchKey</code> field. I need each child validator to compare its own <code>field1</code> with the parent’s <code>batchKey</code>. How can the child validator access the parent value when the parent itself is validated as a list?</p>\n<pre><code>public class ChildDto {\n    @NotBlank\n    private String field1;\n\n    // How do I get the batchKey from the parent DTO here?\n    // If field1 is not equal to batchKey, I want to reject the value.\n    // Where should this validation live?\n\n    // getters/setters\n}\n\npublic class ParentDto {\n    @NotBlank\n    private String batchKey;\n\n    @Valid\n    private List&lt;ChildDto&gt; child;\n\n    // getters/setters\n}\n\n@RestController\npublic class MyController {\n\n    @PostMapping(\"/api\")\n    public ResponseEntity&lt;Void&gt; post(@RequestBody @Valid List&lt;ParentDto&gt; request) {\n        return ResponseEntity.ok().build();\n    }\n}\n</code></pre>\n<p>Request JSON:</p>\n<pre><code>[\n  {\n    \"batchKey\": \"batch_key_value_1\",\n    \"child\": [\n      { \"field1\": \"value1\" },\n      { \"field1\": \"value2\" },\n      { \"field1\": \"value3\" }\n    ]\n  },\n  {\n    \"batchKey\": \"batch_key_value_2\",\n    \"child\": [\n      { \"field1\": \"value4\" },\n      { \"field1\": \"value5\" },\n      { \"field1\": \"value6\" }\n    ]\n  }\n]\n</code></pre>",
  "Title: Error \"Table object has no method append\"\nBody: <p>I am trying to append a row represented by a map to a Tablesaw <code>Table</code>, but I get this error:</p>\n<blockquote>\n<p>Table object has no method append</p>\n</blockquote>\n<p>As far as I know, a table should support adding rows.</p>\n<p>Code snippet:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Table table = Table.create(\"data\").append(newRow);\n</code></pre>\n<p>I was expecting the map <code>newRow</code> to be added as a new row.</p>\n<p>How can I fix it?</p>",
  "Title: JDBC query execution fails when loading MySQL data for Prophet forecast in Java\nBody: <p>First of all, I’m totally new to development. I’m taking AI / Data Science courses and one assignment is to use a SQL database to make predictions with Prophet and then load the results into Power BI. I’m stuck on the Java code and I don’t know where the problem is.</p>\n<pre class=\"lang-java prettyprint-override\"><code>import java.sql.Connection;\nimport java.sql.DriverManager;\nimport java.sql.ResultSet;\nimport java.sql.Statement;\n\npublic class App {\n    public static void main(String[] args) throws Exception {\n        String url = \"jdbc:mysql://localhost:3306/data\";\n        String user = \"root\";\n        String password = \"Password\";\n\n        Connection conn = DriverManager.getConnection(url, user, password);\n        Statement stmt = conn.createStatement();\n\n        String query =\n            \"SELECT Cle_Produit, Date_Facturation, SUM(Quantite) AS Total_Quantite \" +\n            \"FROM ventes \" +\n            \"GROUP BY Cle_Produit, Date_Facturation\";\n\n        ResultSet rs = stmt.executeQuery(query);\n\n        // 1) Load ResultSet into a table-like structure\n        // 2) Pivot by Date_Facturation (rows) and Cle_Produit (columns)\n        // 3) Rename columns to ds / y for Prophet\n        // 4) Fit Prophet model\n        // 5) Write forecast to CSV\n\n        // ... code here ...\n\n        rs.close();\n        stmt.close();\n        conn.close();\n    }\n}\n</code></pre>\n<p>It throws a runtime exception when executing the query, and the stack trace points to the executeQuery call.</p>\n<p>Please, can somebody help me? I want the script to create a CSV file with the forecast. I want Prophet to use the table <code>ventes</code> from DB <code>data</code>, and the columns <code>Cle_Produit</code>, <code>Quantite</code>, and <code>Date_Facturation</code>.</p>",
  "Title: ClassNotFoundException when deserializing a DataFrame from Metaflow artifact store\nBody: <p>I used Metaflow to load a Smile DataFrame that was serialized in the artifact store. It deserializes successfully, but when I try to access its index I get a <code>ClassNotFoundException</code> for a DataFrame index class. Why?</p>\n<p>I’ve seen other answers that say this can happen when deserializing data created with older versions of the library. However, my error is slightly different, and it isn’t fixed by upgrading Smile in Maven.</p>",
  "Title: Workbook has no method save. How do I write the file?\n\nBody: I was trying the following Java code I found:\n\n```java\nimport org.apache.poi.ss.usermodel.*;\nimport org.apache.poi.xssf.usermodel.XSSFWorkbook;\n\nimport java.io.FileOutputStream;\nimport java.util.Arrays;\nimport java.util.List;\n\nList<List<Object>> data = Arrays.asList(\n    Arrays.asList(\"Name\", \"Age\", \"Gender\"),\n    Arrays.asList(\"John\", 25, \"M\"),\n    Arrays.asList(\"Jane\", 30, \"F\"),\n    Arrays.asList(\"Adam\", 35, \"M\")\n);\n\nWorkbook workbook = new XSSFWorkbook();\nSheet sheet = workbook.createSheet(\"Sheet1\");\n\nfor (int r = 0; r < data.size(); r++) {\n    Row row = sheet.createRow(r);\n    List<Object> rowData = data.get(r);\n    for (int c = 0; c < rowData.size(); c++) {\n        Cell cell = row.createCell(c);\n        Object val = rowData.get(c);\n        if (val instanceof Number) {\n            cell.setCellValue(((Number) val).doubleValue());\n        } else {\n            cell.setCellValue(val.toString());\n        }\n    }\n}\n\n// Example: add a line chart\n// ... chart creation code ...\n\nworkbook.save();\n```\n\nBut I get an error because `Workbook` has no `save()` method. How do I correctly save the XLSX file?\n\nThanks in advance!",
  "Title: How do I execute a SQL query when my DataSource doesn’t have an execute method?\nBody: <p>Hibernate 6.x works in a different way — they changed some of the API.</p>\n<p>Following investigation I found a solution. My code was simply:</p>\n<pre><code>Connection conn = dataSource.getConnection();\nResultSet rs = conn.execute(query);\n</code></pre>\n<p>I get an error because the <code>DataSource</code> / <code>Connection</code> doesn’t have an <code>execute</code> method in this context.</p>\n<p>I will answer my own post below.</p>\n<p>I tried using various versions but did not like the idea of getting locked with historic components.</p>",
  "Title: Databricks: Issue while creating Spark DataFrame from a local collection (Java)\nBody: <p>I have a local collection that I want to convert into a Spark DataFrame in Databricks. Usually, I use the code below to create a DataFrame, but all of a sudden I started to get an exception thrown inside Spark when calling <code>createDataFrame</code>. I tried changing the Databricks runtime and re-running, but I still get the same error. What is the solution for this? Which Spark/Scala/Java versions should I use to avoid this issue?</p>\n<pre><code>import org.apache.spark.sql.Dataset;\nimport org.apache.spark.sql.Row;\nimport org.apache.spark.sql.RowFactory;\nimport org.apache.spark.sql.SparkSession;\nimport org.apache.spark.sql.types.DataTypes;\nimport org.apache.spark.sql.types.Metadata;\nimport org.apache.spark.sql.types.StructField;\nimport org.apache.spark.sql.types.StructType;\n\nimport java.util.Arrays;\nimport java.util.List;\n\nSparkSession spark = SparkSession.builder().getOrCreate();\n\nList&lt;Row&gt; data = Arrays.asList(\n    RowFactory.create(1, 1),\n    RowFactory.create(2, 2),\n    RowFactory.create(3, 3)\n);\n\nStructType schema = new StructType(new StructField[] {\n    new StructField(\"i\", DataTypes.IntegerType, false, Metadata.empty()),\n    new StructField(\"j\", DataTypes.IntegerType, false, Metadata.empty())\n});\n\nDataset&lt;Row&gt; df = spark.createDataFrame(data, schema);\n\n// error:-\n// java.lang.NoSuchMethodError thrown from inside Spark during createDataFrame\n</code></pre>",
  "Title: org.apache.spark.sql.AnalysisException: Table or view not found: df  \nBody: I have a problem with the following code:\n\n```java\nimport java.util.Arrays;\nimport java.util.List;\n\nimport org.apache.spark.sql.Dataset;\nimport org.apache.spark.sql.Row;\nimport org.apache.spark.sql.RowFactory;\nimport org.apache.spark.sql.SparkSession;\nimport org.apache.spark.sql.types.DataTypes;\nimport org.apache.spark.sql.types.StructType;\n\npublic class Demo {\n    public static void main(String[] args) {\n        SparkSession spark = SparkSession.builder()\n                .appName(\"Demo\")\n                .master(\"local[*]\")\n                .getOrCreate();\n\n        List<Row> rows = Arrays.asList(\n                RowFactory.create(1, 4),\n                RowFactory.create(2, 5),\n                RowFactory.create(3, 6)\n        );\n\n        StructType schema = new StructType()\n                .add(\"column1\", DataTypes.IntegerType, false)\n                .add(\"column2\", DataTypes.IntegerType, false);\n\n        Dataset<Row> df = spark.createDataFrame(rows, schema);\n\n        String query = \"SELECT * FROM df WHERE column1 > 1\";\n\n        Dataset<Row> newDataFrame = spark.sql(query);\n\n        newDataFrame.show();\n        spark.stop();\n    }\n}\n```\n\nWhen I run it, I get this error:\n\n```\norg.apache.spark.sql.AnalysisException: Table or view not found: df; line 1 pos 14\n```\n\nI’m using the latest Spark version. Could someone help me fix this?",
  "Title: DataFrame to SQL table throws error: multiple values for argument 'schema'\nBody: <p>I have a DataFrame in Apache Spark (or a Java DataFrame) named <code>purchaseDf</code>. I want to register it as a SQL table so I can run SQL queries against it. I tried something like:</p>\n<pre><code>purchaseDf.write()\n    .mode(\"overwrite\")\n    .saveAsTable(\"purchase_df\");\n</code></pre>\n<p>But I’m getting an error that indicates multiple values are being passed for a schema argument.</p>\n<p>I need to run SQL queries like:</p>\n<pre><code>Dataset&lt;Row&gt; result = spark.sql(\"select * from purchase_df where condition\");\n</code></pre>\n<p>This works fine in my local setup, but in Databricks it now fails (it worked a week ago). What’s the correct way to register a DataFrame as a SQL table in Java so I can query it, and how do I resolve the schema argument conflict?</p>",
  "Title: Different behavior of cast(\"string\") and UDF toString for Spark Timestamp columns.\nBody: <p>I'm working with datetime information in Apache Spark (Java) and wanted to convert a Timestamp column to <code>String</code>. I noticed different behavior from two approaches that I expected to yield the same result.</p>\n<p>Here's a minimal reproducible example.</p>\n<pre class=\"lang-java\"><code>import java.sql.Timestamp;\nimport java.util.Arrays;\nimport java.util.List;\n\nimport org.apache.spark.sql.Dataset;\nimport org.apache.spark.sql.Row;\nimport org.apache.spark.sql.RowFactory;\nimport org.apache.spark.sql.SparkSession;\nimport org.apache.spark.sql.functions;\nimport org.apache.spark.sql.types.DataTypes;\nimport org.apache.spark.sql.types.Metadata;\nimport org.apache.spark.sql.types.StructField;\nimport org.apache.spark.sql.types.StructType;\nimport org.apache.spark.sql.expressions.UserDefinedFunction;\n\npublic class SparkTimestampToString {\n    public static void main(String[] args) {\n        SparkSession spark = SparkSession.builder()\n                .appName(\"timestamp-to-string\")\n                .master(\"local[*]\")\n                .getOrCreate();\n\n        List&lt;Row&gt; data = Arrays.asList(\n                RowFactory.create(\"2023-01-01\"),\n                RowFactory.create(\"2023-01-02\"),\n                RowFactory.create(\"2023-01-02\")\n        );\n\n        StructType schema = new StructType(new StructField[] {\n                new StructField(\"dt_column\", DataTypes.StringType, false, Metadata.empty())\n        });\n\n        Dataset&lt;Row&gt; df = spark.createDataFrame(data, schema);\n\n        // Convert strings to timestamps (time portion should be 00:00:00)\n        df = df.withColumn(\"dt_column\", functions.to_timestamp(functions.col(\"dt_column\")));\n\n        UserDefinedFunction toStringUdf =\n                functions.udf((Timestamp ts) -> ts.toString(), DataTypes.StringType);\n\n        df = df\n                .withColumn(\"str_from_cast\", functions.col(\"dt_column\").cast(\"string\"))\n                .withColumn(\"str_from_udf\", toStringUdf.apply(functions.col(\"dt_column\")));\n\n        df.show(false);\n        df.printSchema();\n\n        spark.stop();\n    }\n}\n</code></pre>\n<p><strong>Output</strong></p>\n<pre><code>+-------------------+--------------+-----------------------+\n|dt_column          |str_from_cast |str_from_udf           |\n+-------------------+--------------+-----------------------+\n|2023-01-01 00:00:00|2023-01-01 00:00:00|2023-01-01 00:00:00.0|\n|2023-01-02 00:00:00|2023-01-02 00:00:00|2023-01-02 00:00:00.0|\n|2023-01-02 00:00:00|2023-01-02 00:00:00|2023-01-02 00:00:00.0|\n+-------------------+--------------+-----------------------+\n\nroot\n |-- dt_column: timestamp (nullable = true)\n |-- str_from_cast: string (nullable = true)\n |-- str_from_udf: string (nullable = true)\n</code></pre>\n<p>If I use <code>cast(\"string\")</code> the fractional seconds are not shown, but when I use a UDF that calls <code>Timestamp.toString()</code> I get a trailing <code>.0</code>.</p>\n<p>Why does Spark produce different string representations for these two approaches?</p>\n<p>(Spark 3.x, Java 11)</p>",
  "Title: Improving performance for a nested for loop iterating over dates in Java\nBody: <p>I am looking to learn how to improve the performance of code over a large dataframe (10 million rows) and my solution loops over multiple dates <code>(2023-01-10, 2023-01-20, 2023-01-30)</code> for different combinations of <code>category_a</code> and <code>category_b</code>.</p>\n<p>The working approach is shown below, which iterates over the dates for different pairings of the two-category data by first locating a subset of a particular pair. However, I would want to refactor it to see if there is an approach that is more efficient.</p>\n<p>My input (<code>df</code>) looks like:</p>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th style=\"text-align: right;\"></th>\n<th style=\"text-align: left;\">date</th>\n<th style=\"text-align: right;\">category_a</th>\n<th style=\"text-align: right;\">category_b</th>\n<th style=\"text-align: right;\">outflow</th>\n<th style=\"text-align: right;\">open</th>\n<th style=\"text-align: right;\">inflow</th>\n<th style=\"text-align: right;\">max</th>\n<th style=\"text-align: right;\">close</th>\n<th style=\"text-align: right;\">buy</th>\n<th style=\"text-align: left;\">random_str</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: left;\">2023-01-10</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">10</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: left;\">a</td>\n</tr>\n<tr>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: left;\">2023-01-20</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">nan</td>\n<td style=\"text-align: right;\">nan</td>\n<td style=\"text-align: left;\">a</td>\n</tr>\n<tr>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: left;\">2023-01-30</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: right;\">10</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">nan</td>\n<td style=\"text-align: right;\">nan</td>\n<td style=\"text-align: left;\">a</td>\n</tr>\n<tr>\n<td style=\"text-align: right;\">3</td>\n<td style=\"text-align: left;\">2023-01-10</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">10</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: left;\">b</td>\n</tr>\n<tr>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: left;\">2023-01-20</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">nan</td>\n<td style=\"text-align: right;\">nan</td>\n<td style=\"text-align: left;\">b</td>\n</tr>\n<tr>\n<td style=\"text-align: right;\">5</td>\n<td style=\"text-align: left;\">2023-01-30</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">nan</td>\n<td style=\"text-align: right;\">nan</td>\n<td style=\"text-align: left;\">b</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>with 2 pairs <code>(4, 1)</code> and <code>(4,2)</code> over the days and my expected output (<code>results</code>) looks like this:</p>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th style=\"text-align: right;\"></th>\n<th style=\"text-align: left;\">date</th>\n<th style=\"text-align: right;\">category_a</th>\n<th style=\"text-align: right;\">category_b</th>\n<th style=\"text-align: right;\">outflow</th>\n<th style=\"text-align: right;\">open</th>\n<th style=\"text-align: right;\">inflow</th>\n<th style=\"text-align: right;\">max</th>\n<th style=\"text-align: right;\">close</th>\n<th style=\"text-align: right;\">buy</th>\n<th style=\"text-align: left;\">random_str</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: left;\">2023-01-10</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">10</td>\n<td style=\"text-align: right;\">-1</td>\n<td style=\"text-align: right;\">23</td>\n<td style=\"text-align: left;\">a</td>\n</tr>\n<tr>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: left;\">2023-01-20</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">-1</td>\n<td style=\"text-align: right;\">23</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">10</td>\n<td style=\"text-align: left;\">a</td>\n</tr>\n<tr>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: left;\">2023-01-30</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: right;\">10</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">10</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">nan</td>\n<td style=\"text-align: left;\">a</td>\n</tr>\n<tr>\n<td style=\"text-align: right;\">3</td>\n<td style=\"text-align: left;\">2023-01-10</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">10</td>\n<td style=\"text-align: right;\">-2</td>\n<td style=\"text-align: right;\">24</td>\n<td style=\"text-align: left;\">b</td>\n</tr>\n<tr>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: left;\">2023-01-20</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">-2</td>\n<td style=\"text-align: right;\">24</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: left;\">b</td>\n</tr>\n<tr>\n<td style=\"text-align: right;\">5</td>\n<td style=\"text-align: left;\">2023-01-30</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">nan</td>\n<td style=\"text-align: left;\">b</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>I have a working solution using pandas dataframes to take a subset then loop over it to get a solution but I would like to see how I can improve the performance of this in Java using something like Tablesaw, DataFrame libraries, or parallel processing.</p>\n<p>I am not sure what the best solution would be and I would appreciate any help in improving the performance.</p>\n<p><em><strong>Minimum working example</strong></em></p>\n<p>The code below generates the input dataframe using Tablesaw.</p>\n<pre><code>import tech.tablesaw.api.*;\nimport tech.tablesaw.columns.numbers.DoubleColumnType;\n\nimport java.time.LocalDate;\nimport java.util.List;\n\nTable df = Table.create(\"df\")\n    .addColumns(\n        DateColumn.create(\"date\", new LocalDate[] {\n            LocalDate.parse(\"2023-01-10\"),\n            LocalDate.parse(\"2023-01-20\"),\n            LocalDate.parse(\"2023-01-30\"),\n            LocalDate.parse(\"2023-01-10\"),\n            LocalDate.parse(\"2023-01-20\"),\n            LocalDate.parse(\"2023-01-30\")\n        }),\n        IntColumn.create(\"category_a\", new int[] {4, 4, 4, 4, 4, 4}),\n        IntColumn.create(\"category_b\", new int[] {1, 1, 1, 2, 2, 2}),\n        DoubleColumn.create(\"outflow\", new double[] {1, 2, 10, 2, 2, 0}),\n        DoubleColumn.create(\"open\", new double[] {0, 0, 0, 0, 0, 0}),\n        DoubleColumn.create(\"inflow\", new double[] {0, 0, 0, 0, 0, 0}),\n        DoubleColumn.create(\"max\", new double[] {10, 20, 20, 10, 20, 20}),\n        DoubleColumn.create(\"close\", new double[] {0, DoubleColumnType.missingValueIndicator(), DoubleColumnType.missingValueIndicator(), 0, DoubleColumnType.missingValueIndicator(), DoubleColumnType.missingValueIndicator()}),\n        DoubleColumn.create(\"buy\", new double[] {0, DoubleColumnType.missingValueIndicator(), DoubleColumnType.missingValueIndicator(), 0, DoubleColumnType.missingValueIndicator(), DoubleColumnType.missingValueIndicator()}),\n        StringColumn.create(\"random_str\", new String[] {\"a\", \"a\", \"a\", \"b\", \"b\", \"b\"})\n    );\n\nTable pairs = df.summarize(\"category_a\", \"category_b\", AggregateFunctions.count).by(\"category_a\", \"category_b\")\n              .select(\"category_a\", \"category_b\");\n\nList&lt;LocalDate&gt; uniqueDates = df.dateColumn(\"date\").unique().asList();\n</code></pre>\n<p>Using this input dataframe, the code below is what I am trying to optimize.</p>\n<pre><code>// pseudo-implementation in Java style\n// for each (category_a, category_b) pair:\n//   subset table by pair\n//   for each date:\n//     update open/close/inflow/buy based on previous date\n//   store result\n</code></pre>\n<p>After which we can check that the solution is the same as what we expected.</p>\n<pre><code>// assert that the result table equals an expected table\n</code></pre>\n<p><em><strong>SQL to create first table</strong></em></p>\n<p>The solution can also be in SQL, if so you can use the following code to create the initial table.</p>\n<p>I am busy trying to implement a solution in BigQuery SQL using a user defined function to keep the logic going too. This would be a nice approach to solving the problem too.</p>\n<pre><code>WITH data AS (\n  SELECT \n    DATE '2023-01-10' as date, 4 as category_a, 1 as category_b, 1 as outflow, 0 as open, 0 as inflow, 10 as max, 0 as close, 0 as buy, 'a' as random_str\n  UNION ALL\n  SELECT \n    DATE '2023-01-20' as date, 4 as category_a, 1 as category_b, 2 as outflow, 0 as open, 0 as inflow, 20 as max, NULL as close, NULL as buy, 'a' as random_str\n  UNION ALL\n  SELECT \n    DATE '2023-01-30' as date, 4 as category_a, 1 as category_b, 10 as outflow, 0 as open, 0 as inflow, 20 as max, NULL as close, NULL as buy, 'a' as random_str\n  UNION ALL\n  SELECT \n    DATE '2023-01-10' as date, 4 as category_a, 2 as category_b, 2 as outflow, 0 as open, 0 as inflow, 10 as max, 0 as close, 0 as buy, 'b' as random_str\n  UNION ALL\n  SELECT \n    DATE '2023-01-20' as date, 4 as category_a, 2 as category_b, 2 as outflow, 0 as open, 0 as inflow, 20 as max, NULL as close, NULL as buy, 'b' as random_str\n  UNION ALL\n  SELECT \n    DATE '2023-01-30' as date, 4 as category_a, 2 as category_b, 0 as outflow, 0 as open, 0 as inflow, 20 as max, NULL as close, NULL as buy, 'b' as random_str\n)\n\nSELECT \n  ROW_NUMBER() OVER (ORDER BY date) as \" \",\n  date,\n  category_a,\n  category_b,\n  outflow,\n  open,\n  inflow,\n  max,\n  close,\n  buy,\n  random_str\nFROM data\n</code></pre>",
  "Title: Why does Apache POI WorkbookFactory.create fail when reading an .xlsx after it previously worked?\n\nBody: <p>This started happening today. The same file read fine yesterday. It fails regardless of whether I run on Java 17 or Java 21.</p>\n<p>Do folks know the fix?</p>\n<pre><code>try (InputStream in = Files.newInputStream(Path.of(\"SUPERBILLS_EXCEL.xlsx\"));\n     Workbook wb = WorkbookFactory.create(in)) {\n    Sheet sheet = wb.getSheet(\"Births\");\n    // parse dates from \"DOS\" and \"DOB\"\n}\n</code></pre>\n<p>The stack trace ends inside Apache POI while reading the workbook (around <code>WorkbookFactory.create</code>). It looks like it’s failing while handling defined names or a read-only sheet. Any ideas?</p>",
  "Title: Error while iterating over Tablesaw column entries: \"cannot find symbol: method iteritems()\"\nBody: Using Tablesaw, I get a compile error when calling `iteritems`.\n\n```java\nfor (var entry : column.iteritems()) {\n    // ...\n}\n```\n\nThe following error message appears:\n\n```\nerror: cannot find symbol\n  symbol:   method iteritems()\n  location: variable column of type StringColumn\n```",
  "Title: NoSuchMethodError: java.sql.Connection.connect() when calling df.write().jdbc()\n\nBody: <p>I’m trying to store data retrieved from a website into a MySQL database from a Spark DataFrame. When I call <code>df.write().jdbc(...)</code>, I get <code>NoSuchMethodError: java.sql.Connection.connect()</code>. I tested the connection with regular JDBC queries and those work fine, so I don’t think it’s a connection or table issue. Is there something wrong with the code?</p>\n<pre><code>import org.apache.commons.configuration2.INIConfiguration;\nimport org.apache.commons.configuration2.builder.fluent.Configurations;\nimport org.apache.spark.sql.Dataset;\nimport org.apache.spark.sql.Row;\nimport org.apache.spark.sql.SaveMode;\n\nimport java.io.File;\nimport java.util.Properties;\n\nConfigurations configs = new Configurations();\nINIConfiguration config = configs.ini(new File(\"db_init.ini\"));\n\nString password = config.getString(\"section_a.Password\");\nString host = config.getString(\"section_a.Host\");\nString database = config.getString(\"section_a.Database\");\n\nString url = \"jdbc:mysql://\" + host + \"/\" + database;\n\nProperties props = new Properties();\nprops.put(\"user\", \"root\");\nprops.put(\"password\", password);\n\nDataset&lt;Row&gt; df = ...;\n\ndf.write()\n  .mode(SaveMode.Append)\n  .jdbc(url, \"tableName\", props);\n</code></pre>\n<p>The stack trace ends with:</p>\n<pre><code>Exception in thread \"main\" java.lang.NoSuchMethodError: java.sql.Connection.connect()Ljava/sql/Connection;\n    at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.getConnection(JdbcUtils.scala:...)\n    at org.apache.spark.sql.execution.datasources.jdbc.JdbcUtils$.saveTable(JdbcUtils.scala:...)\n    at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:...)\n    ...\n</code></pre>\n<p>I’m using Spark 3.4.x and MySQL Connector/J 8.x. I can run queries like <code>CREATE TABLE</code> or <code>SELECT</code> with JDBC without any issues.</p>",
  "Title: Alternative to concatenating empty Tablesaw tables now that it is deprecated?\n\nBody: <p>I have two Tablesaw <code>Table</code> instances that can both be empty, and I want to concatenate them.</p>\n<p>Before I could just do:</p>\n<pre><code>Table result = df1.append(df2);\n</code></pre>\n<p>But now I get a deprecation warning about concatenating tables when one is empty or all-missing, and that a future version will change how types are inferred.</p>\n<p>An easy fix would be:</p>\n<pre><code>Table result;\nif (df1.rowCount() &gt; 0 &amp;&amp; df2.rowCount() &gt; 0) {\n    result = df1.append(df2);\n} else if (df1.rowCount() &gt; 0) {\n    result = df1.copy();\n} else if (df2.rowCount() &gt; 0) {\n    result = df2.copy();\n} else {\n    result = Table.create(\"result\");\n}\n</code></pre>\n<p>But that seems pretty ugly. Does anyone have a better solution?</p>\n<p>FYI: this started after the latest Tablesaw release.</p>",
  "Title: JShell Console shows \"Exception in message handler\" after calling Spark DataFrame methods\nBody: <p>I am new to Java and use IntelliJ IDEA with the JShell console, mainly for data analysis with Apache Spark. A few days ago I reinstalled IntelliJ and the JDK for unrelated reasons. Now, when I directly enter Spark DataFrame commands such as <code>df.printSchema()</code> or <code>df.describe()</code> in JShell, I get the correct output but then see an error message like:</p>\n<pre><code>[JShell] ERROR | Exception in message handler\n&lt;stack trace pointing into JShell inspection/auto-completion and Spark SQL classes&gt;\n</code></pre>\n<p>Weirdly, this only happens when I type the commands manually and only for Spark DataFrame commands. If I run the same commands from a Java class, or recall them with the up arrow in JShell, the error doesn’t show. It only shows when I manually type the commands.</p>\n<p>I searched but couldn’t find a discussion that matches this behavior. How do I deal with this error?</p>\n<p>I reinstalled IntelliJ, the JDK, and re-imported my Maven dependencies (including Spark), but nothing helped.</p>",
  "Title: Tablesaw plot error: “vars() argument must have __dict__ attribute”?\nBody: <p>It was working perfectly earlier but for some reason now I am getting strange errors.</p>\n<p>Java environment:</p>\n<ul>\n<li>Tablesaw version: <code>0.43.1</code></li>\n<li>XChart version: <code>3.8.5</code></li>\n</ul>\n<p>Sample table:</p>\n<pre><code>Table df = Table.create(\"df\")\n    .addColumns(\n        IntColumn.create(\"cap\", new int[]{1, 2, 3, 4}),\n        DateColumn.create(\"Date\", new LocalDate[]{\n            LocalDate.parse(\"2022-01-04\"),\n            LocalDate.parse(\"2022-01-06\"),\n            LocalDate.parse(\"2022-01-07\"),\n            LocalDate.parse(\"2022-01-08\")\n        })\n    );\n</code></pre>\n<pre><code>Plot.show(LinePlot.create(\"cap vs Date\", df, \"cap\", \"Date\"));\n</code></pre>\n<pre><code>df.structure();\n</code></pre>\n<p>I get an error at runtime:</p>\n<pre class=\"lang-none prettyprint-override\"><code>TypeError: vars() argument must have __dict__ attribute\n</code></pre>\n<p>How do I fix this plotting error in Java?</p>",
  "Title: Tablesaw FutureWarning: Row get by position is deprecated\nBody: <p>I’m running into an issue with Tablesaw that I can’t figure out.</p>\n<p>I have a list of columns in a Tablesaw Table that I need to convert using a custom function. The new values depend on multiple columns in the data, so I’m using row-wise logic to convert the column in-place:</p>\n<pre><code>List&lt;String&gt; columnsToConvert = List.of(\"col1\", \"col2\", \"col3\");\n\nfor (String k : columnsToConvert) {\n    DoubleColumn target = table.doubleColumn(k);\n    DoubleColumn colX = table.doubleColumn(\"colx\");\n\n    DoubleColumn newCol = DoubleColumn.create(k);\n    for (int i = 0; i &lt; table.rowCount(); i++) {\n        double v1 = target.getDouble(i);\n        double v2 = colX.getDouble(i);\n        newCol.append(convertMyData(v1, v2));\n    }\n\n    table.replaceColumn(k, newCol);\n}\n</code></pre>\n<p>This has worked fine in earlier versions, but now I get a deprecation warning about accessing row values by integer position and being asked to use label-based access instead.</p>\n<p>I’m not using any explicit row/column label accessors, so I’m confused. How should I write this code so it’s the correct approach going forward?</p>\n<p>I’m using previous methods that did work.</p>",
  "Title: Repeat rows in a Java DataFrame based on a column\n\nBody: <p>I have a Tablesaw <code>Table</code> that looks like this:</p>\n<pre><code>Table df = Table.create(\"df\")\n    .addColumns(\n        IntColumn.create(\"col1\", new int[] {1, 2, 3}),\n        IntColumn.create(\"col2\", new int[] {4, 5, 6}),\n        IntColumn.create(\"col3\", new int[] {7, 8, 9})\n    );\n\ndf.print();\n    col1    col2    col3\n0      1       4       7\n1      2       5       8\n2      3       6       9\n</code></pre>\n<p>I would like to create a new table like this:</p>\n<pre><code>df_new\n    col1    col2    col3\n0      1       4       7\n1      1       5       8\n2      1       6       9\n3      2       4       7\n4      2       5       8\n5      2       6       9\n6      3       4       7\n7      3       5       8\n8      3       6       9\n</code></pre>\n<p>Is there a built-in or a combination of built-in Tablesaw methods that can achieve this?</p>\n<p>Even if there are duplicates in <code>df</code>, I would like the output to be the same format. For example:</p>\n<pre><code>df\n    col1    col2    col3\n0      1       4       7\n1      2       5       8\n2      2       6       8\n\ndf_new\n    col1    col2    col3\n0      1       4       7\n1      1       5       8\n2      1       6       8\n3      2       4       7\n4      2       5       8\n5      2       6       8\n6      2       4       7\n7      2       5       8\n8      2       6       8\n</code></pre>",
  "Title: Pearson correlation throws NumberFormatException: For input string: \"Avery Bradley\"\nBody: <p>I'm trying to compute a Pearson correlation in Java and I'm getting a very strange parsing error. I read a CSV into a Tablesaw <code>Table</code> and then pass the numeric data into Apache Commons Math's <code>PearsonsCorrelation</code>.</p>\n<p>Specifically, when I run code like this:</p>\n<pre><code>Table df = Table.read().csv(\"nba.csv\");\n// convert numeric columns to double[][] ...\nPearsonsCorrelation corr = new PearsonsCorrelation(data);\nRealMatrix matrix = corr.getCorrelationMatrix();\n</code></pre>\n<p>I get this exception:</p>\n<pre><code>Exception in thread \"main\" java.lang.NumberFormatException: For input string: \"Avery Bradley\"\n    at java.base/jdk.internal.math.FloatingDecimal.readJavaFormatString(FloatingDecimal.java:2054)\n    at java.base/jdk.internal.math.FloatingDecimal.parseDouble(FloatingDecimal.java:110)\n    at java.base/java.lang.Double.parseDouble(Double.java:651)\n    ...\n</code></pre>\n<p>The error message offers no clue. I thought the correlation calculation would automatically ignore strings and empty values, but it seems like it's trying to parse everything as a number. How should I handle this in Java?</p>",
  "Title: What datatype is considered ‘list-like’ in Java?\n\nBody: In the Pandas documentation for Series.isin(values), they state:\n\n> values : set or list-like\n\nIn Java terms, what is considered list-like? For a Java Map tempMap, would tempMap.keySet() and tempMap.values() be considered list-like?",
  "Title: Can String.toUpperCase(Locale) ever produce a longer string?\nBody: <p>I want to use Java’s <code>String.toUpperCase(Locale)</code>.</p>\n<p>My question: am I always safe assuming the uppercased result has the same length as the original string (in char count)? For example, can I preallocate a <code>char[]</code> of the original length and write the result into it without overflow?</p>\n<p>If not, can someone provide an example of a string that grows when calling <code>toUpperCase</code>, including the locale?</p>",
  "Title: Java warn or prohibit compile-time string literal concatenation\nBody: <p>Is there a way to warn or prohibit compile-time string literal concatenations such as:</p>\n<pre><code>String a = \"foo\" + \" bar\";\n</code></pre>\n<p>I spent hours finding a bug in a big static array that had</p>\n<pre><code>String[] a = {\"foo\" + \"bar\"};\n</code></pre>\n<p>instead of</p>\n<pre><code>String[] a = {\"foo\", \"bar\"};\n</code></pre>",
  "Title: Is creating an object in an argument list and passing derived data to a method safe?\nBody: <p>Is the Java code below well-formed? Will the temporary <code>String</code> be eligible for garbage collection before or after the method finishes executing?</p>\n<pre class=\"lang-java prettyprint-override\"><code>void myFunction(byte[] data);\n\n...\n\nmyFunction(new String(\"Something\").getBytes(java.nio.charset.StandardCharsets.UTF_8));\n</code></pre>\n<p>I know I could do <code>myFunction(\"Something\".getBytes(java.nio.charset.StandardCharsets.UTF_8))</code>, but I am using <code>new String(...)</code> this way to illustrate my point.</p>",
  "Title: How do I split a string by a character without ignoring trailing separators in Java?\nBody: <p>I have a string similar to the following:</p>\n<pre><code>String myString = \"apple,banana,orange,\";\n</code></pre>\n<p>And I want to split by <code>,</code> to produce the output:</p>\n<pre><code>List&lt;String&gt; output = Arrays.asList(\"apple\", \"banana\", \"orange\", \"\");\n</code></pre>\n<p>I tried <code>String.split</code>, but it treats the trailing comma like it doesn't exist:</p>\n<pre><code>String myString = \"apple,banana,orange,\";\n\nSystem.out.println(Arrays.toString(myString.split(\",\")));\n// prints: [apple, banana, orange]\n</code></pre>\n<p>What is the simplest approach to achieve the desired output?</p>\n<p>Some more test cases with example strings and desired outputs:</p>\n<pre><code>String string1 = \"apple,banana,orange,\";\nList&lt;String&gt; output1 = Arrays.asList(\"apple\", \"banana\", \"orange\", \"\");\n\nString string2 = \"apple,banana,orange,pear\";\nList&lt;String&gt; output2 = Arrays.asList(\"apple\", \"banana\", \"orange\", \"pear\");\n\nString string3 = \",apple,banana,orange\";\nList&lt;String&gt; output3 = Arrays.asList(\"\", \"apple\", \"banana\", \"orange\");\n\n// Examples of non-comma separated strings\n// '|' separator\nString string4 = \"|apple|banana|orange|\";\nList&lt;String&gt; output4 = Arrays.asList(\"\", \"apple\", \"banana\", \"orange\", \"\");\n\n// 'x' separator\nString string5 = \"xapplexbananaxorangex\";\nList&lt;String&gt; output5 = Arrays.asList(\"\", \"apple\", \"banana\", \"orange\", \"\");\n</code></pre>\n<p>EDIT:</p>\n<p>Ideally the solution should generalize to any splitting character.</p>\n<p>Prefer a standard JDK solution, but you can also mention libraries from Maven Central if they provide this functionality.</p>",
  "Title: Java triple double quotes (text blocks)\nBody: <p>What is the purpose of triple double quotes <code>\"\"\"</code> (text blocks) in Java? It seems they are used for multiline text. But why not use regular string literals with <code>\\n</code> (or concatenation) instead?</p>\n<pre><code>String text = \"\"\"\n  some text\n  some text\n  some text\n  \"\"\";\n</code></pre>",
  "Title: How to replace characters in a string one at a time generating a new string for each replacement?\n\nBody: <p>I have a list of strings in Java:</p>\n<pre><code>List&lt;String&gt; strings = List.of(\n    \"YSAHEEHHYDK\", \"HEHISSDYAGK\", \"TFAHTESHISK\", \"ISLGEHEGGGK\",\n    \"LSSGYDGTSYK\", \"FGTGTYAGGEK\", \"VGASTGYSGLK\", \"TASGVGGFSTK\", \"SYASDFGSSAK\",\n    \"LYSYYSSTESK\"\n);\n</code></pre>\n<p>For each string I want to replace \"Y\", \"S\", or \"T\" with \"pY\", \"pS\", or \"pT\". But I don't want all replacements in the same final string. I want each replacement to generate a new string. For example,</p>\n<p>\"YSAHEEHHYDK\" should turn into</p>\n<pre><code>List.of(\n    \"pYSAHEEHHYDK\",\n    \"YpSAHEEHHYDK\",\n    \"YSAHEEHHpYDK\"\n);\n</code></pre>\n<p>How can I do this in Java?</p>",
  "Title: How to find the max and min values of string rows of a data frame in Java?\nBody: <p>For each row of my data, I want to get the <em>min</em> and <em>max</em> values and\nthe <em>number of years</em> which are originally stored as a character string. For example, consider the following data:</p>\n<pre><code>Table df = Table.create(\"df\")\n    .addColumns(\n        IntColumn.create(\"id\", new int[] {1, 2, 3, 4}),\n        StringColumn.create(\"yr\", new String[] {\n            \"1543,860,2023\",\n            \"2019,2018,2006,2007\",\n            \"1998,2012,2000,2020\",\n            \"2000\"\n        })\n    );\n</code></pre>\n<p>Output needed:</p>\n<pre><code>id                   yr  min_yr  max_yr  nYears\n 1        1543,860,2023     860    2023       3\n 2  2019,2018,2006,2007    2006    2019       4\n 3  1998,2012,2000,2020    1998    2020       4\n 4                 2000    2000    2000       1\n</code></pre>",
  "Title: Problem of Java String intern method when using StringBuilder with append method creating a String.\nBody: <pre><code>    public static void main(String[] args) {\n        String a = new StringBuilder(&quot;Jav&quot;).toString();\n        a.intern();\n        String c = &quot;Jav&quot;;\n        System.out.println(a == c);  //false\n    }\n</code></pre>\n<pre><code>    public static void main(String[] args) {\n        String a = new StringBuilder(&quot;Ja&quot;).append(&quot;v&quot;).toString();\n        a.intern();\n        String c = &quot;Jav&quot;;\n        System.out.println(a == c);  //true\n    }\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/g6pD2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/g6pD2.png\" alt=\"enter image description here\" /></a></p>\n<p>I do not understand why first one would print out false, but the second one print out true. I think those should print out true because after calling the intern method, the reference of a would be written into the string pool and c will point to the reference of a. Can someone explain the difference? Thanks!</p>\n<p>My JDK Version: OpenJDK 17.0.7</p>\n<p>Btw I also get the same result when using StringBuffer.</p>",
  "Title: How do I create a multiline string in Java?\nBody: <p>In JavaScript (ES6), you can use template literals (``) to create multiline strings as shown in the following example:</p>\n<pre class=\"lang-js prettyprint-override\"><code>const html = `\n  &lt;div&gt;\n    &lt;p&gt;Raku is &lt;b&gt;ofun&lt;/b&gt;.&lt;/p&gt;\n  &lt;/div&gt;\n`\n</code></pre>\n<p>What’s the Java equivalent of this for creating multiline strings?</p>",
  "Title: Special case when += for String concatenation is more efficient than =\n\nBody: <p>I have this code using Java 21:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class Main {\n    public static void main(String[] args) {\n        long time1 = run(() -&gt; {\n            String s = \"\";\n            for (int i = 0; i &lt; 10000; i++) {\n                s = s + \"x\" + \"y\";\n            }\n        });\n\n        long time2 = run(() -&gt; {\n            String s = \"\";\n            for (int i = 0; i &lt; 10000; i++) {\n                s += \"x\" + \"y\";\n            }\n        });\n\n        System.out.println(time1);\n        System.out.println(time2);\n    }\n\n    private static long run(Runnable r) {\n        long start = System.nanoTime();\n        for (int i = 0; i &lt; 100; i++) {\n            r.run();\n        }\n        return System.nanoTime() - start;\n    }\n}\n</code></pre>\n<p>Why is <code>+=</code> more efficient <strong>in this case</strong>? As far as I know, there is the same number of concatenations, and the order of execution doesn't change the result.</p>\n<p>Since <code>String</code> is immutable, it’s not because of in-place shenanigans, and the only thing I found about string concat is about <code>StringBuilder</code> efficiency, but I don't want the most efficient, just understand why <code>+=</code> seems more efficient than <code>=</code>.</p>\n<p>With this code, performance between forms is almost equal:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class Main {\n    public static void main(String[] args) {\n        long time1 = run(() -&gt; {\n            String s = \"\";\n            for (int i = 0; i &lt; 10000; i++) {\n                s = s + \"x\";\n            }\n        });\n\n        long time2 = run(() -&gt; {\n            String s = \"\";\n            for (int i = 0; i &lt; 10000; i++) {\n                s += \"x\";\n            }\n        });\n\n        System.out.println(time1);\n        System.out.println(time2);\n    }\n\n    private static long run(Runnable r) {\n        long start = System.nanoTime();\n        for (int i = 0; i &lt; 100; i++) {\n            r.run();\n        }\n        return System.nanoTime() - start;\n    }\n}\n</code></pre>\n<hr />\n<p>I noticed a difference using different Java versions (<code>\"x\" + \"y\"</code> form):</p>\n<p>Java 11 to 17:</p>\n<pre class=\"lang-java prettyprint-override\"><code>System.out.println(time1);\n// ~600_000_000\nSystem.out.println(time2);\n// ~300_000_000\n</code></pre>\n<p>Java 21:</p>\n<pre class=\"lang-java prettyprint-override\"><code>System.out.println(time1);\n// ~1_700_000_000\nSystem.out.println(time2);\n// ~800_000_000\n</code></pre>\n<hr />\n<p>Similar but not answering the question: <a href=\"https://stackoverflow.com/questions/69079181/how-is-the-s-sc-string-concat-optimization-decided\">How is the s=s+c string concat optimization decided?</a></p>\n<blockquote>\n<p>If s is a string, then s = s + \"c\" might modify the string in place, while t = s + \"c\" can't. But how does the operation s + \"c\" know which scenario it's in?</p>\n</blockquote>\n<p>In a nutshell: Optimization occurs when <code>s = s + \"c\"</code>, not when <code>t = s + \"c\"</code> because Java needs to keep a reference to the first string and can't concatenate in place.</p>\n<p>Here, we are always assigning using simple assignment or augmented assignment to the original string, so in-place concatenation should apply in both cases.</p>",
  "Title: Removing second and subsequent occurrences of decimal point in string.\nBody: <p>I want to remove the second and subsequent occurrences of a decimal point in a string. My attempt is below:</p>\n<pre><code>String s = \"3.99-0.13\";\nSystem.out.println(s.replace(\".\", \"\"));\n// 399-013\n\nSystem.out.println(s.replaceFirst(\"\\\\.\", \"\"));\n// 399-0.13\n</code></pre>\n<p>However, I want the output like <code>3.99-013</code>. Any hint, please.</p>",
  "Title: Why some character can't be edited in Java?\nBody: <p>I'm trying to write my own <code>strcat</code> function in Java, but it has some problems.<br />\nMy input is two strings <code>c</code> and <code>a</code>, and my function will return a <code>char[]</code> where <code>c</code> is concatenated with <code>a</code>.</p>\n<p>For example,<br />\nInput: <code>\"abc\"</code> <code>\"xyz\"</code><br />\nExpected Output: <code>\"xyzabc\"</code><br />\nMy function's Output: <code>\"xyza@▲∩\"</code></p>\n<p>My function returns some special characters different from my input.</p>\n<p>I debugged my function and found that:</p>\n<ul>\n<li>When <code>i=0</code>, <code>destination[3]</code> = <code>source[0]</code> = <code>'a'</code></li>\n<li>But when <code>i=1</code>, <code>destination[8]</code> = <code>source[1]</code> = <code>'b'</code></li>\n<li>And when <code>i=2</code>, <code>destination[9]</code> = <code>source[2]</code> = <code>'c'</code></li>\n<li>Finally, <code>destination[10]</code> = <code>'\\0'</code></li>\n</ul>\n<pre class=\"lang-java prettyprint-override\"><code>import java.io.BufferedReader;\nimport java.io.InputStreamReader;\nimport java.io.IOException;\n\npublic class Main {\n    static char[] myStrcat(char[] destination, char[] source) {\n        for (int i = 0; i &lt; source.length; i++) {\n            destination[destLength(destination) + i] = source[i];\n        }\n        destination[destLength(destination) + source.length] = '\\0';\n        return destination;\n    }\n\n    static int destLength(char[] arr) {\n        int len = 0;\n        while (len &lt; arr.length &amp;&amp; arr[len] != '\\0') {\n            len++;\n        }\n        return len;\n    }\n\n    public static void main(String[] args) throws Exception {\n        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n        String cStr = br.readLine();\n        String aStr = br.readLine();\n\n        char[] c = new char[100];\n        char[] a = new char[100];\n        System.arraycopy(cStr.toCharArray(), 0, c, 0, cStr.length());\n        System.arraycopy(aStr.toCharArray(), 0, a, 0, aStr.length());\n\n        myStrcat(a, c);\n        System.out.println(new String(a));\n    }\n}\n</code></pre>",
  "Title: How to prevent an overload from accidentally becoming recursive?\n\nBody: <p>Consider the following Java code:</p>\n<pre><code>public class Demo {\n\n    static void getValFromDb(CharSequence key, byte value) {\n        System.out.println(\"Getting value from db with byte!\");\n    }\n\n    static void getValFromDb(CharSequence key, short value) {\n        System.out.println(\"Getting value from db with short!\");\n    }\n\n    // overload to allow String keys to be forwarded to the CharSequence overloads\n    static &lt;T&gt; void getValFromDb(String key, T value) {\n        getValFromDb(key, value);\n    }\n\n    public static void main(String[] args) {\n        byte myValueByte = 0;  // OK\n        getValFromDb(\"my key\", myValueByte);\n\n        short myValueShort = 0; // OK\n        getValFromDb(\"my key\", myValueShort);\n\n        char myValueChar = 0;  // BAD: becomes recursive and crashes\n        getValFromDb(\"my key\", myValueChar);\n\n        // Can't remove the String overload because existing code relies on it\n        String key = \"my key\";\n        getValFromDb(key, myValueByte);\n        getValFromDb(key, myValueShort);\n    }\n}\n</code></pre>\n<p>I have a method <code>getValFromDb</code> that receives a key name and a value type, with many overloads for each type, plus a catch-all generic overload that exists only to accept <code>String</code> keys and forward to the <code>CharSequence</code> overloads.</p>\n<p>The problem is that when someone passes a type like <code>char</code> (which I don't support), the compiler selects the generic overload, which then calls itself and causes a stack overflow.</p>\n<p>I could add an explicit overload for <code>char</code>, but I want unsupported types to fail fast with a compilation error instead of being captured by the generic overload. I don't want to remove the <code>String</code> overload because existing code depends on it.</p>\n<p>How can I prevent the generic overload from accepting unsupported types and force a compile-time error instead of recursion?</p>\n<pre><code>static &lt;T&gt; void getValFromDb(String key, T value) {\n    // how can I stop this from accepting unsupported types?\n    getValFromDb(key, value);\n}\n</code></pre>\n<p>I have a Java 17 compiler available.</p>",
  "Title: How to find the longest continuous contiguous set of characters in a string based on a given list\n\nBody: <p>I have the following string in Java.</p>\n<pre><code>String aas = \"QAWDIIKRIDKK\";\n</code></pre>\n<p>And I want to find the longest continuous fragment of that string that contains only characters in the following list:</p>\n<pre><code>List&lt;Character&gt; hydrophobicRes = Arrays.asList('W','F','I','L','V','M','C','A','G');\n</code></pre>\n<p>The answer should be:</p>\n<pre><code>AW, II\n</code></pre>\n<p>Other example:</p>\n<pre><code>QFILVMD -&gt; FILVM\n</code></pre>\n<p>How can I do that in Java?</p>",
  "Title: Obtain palindromic array by performing these operations.\nBody: <p>An array is called palindromic if it remains the same after reversing the order of its elements.</p>\n<p>You have an array of strings arr. For each i, <code>arr[i]</code> consists of at least two characters. For each pair of consecutive elements <code>arr[i]</code> and <code>arr[i + 1]</code>, you can:</p>\n<ol>\n<li>Move the rightmost character of <code>arr[i]</code> to the leftmost position in <code>arr[i + 1]</code>. For instance, &quot;abc&quot; and &quot;def&quot; will become &quot;ab&quot; and &quot;cdef&quot;. This operation can be applied only once to any pair of consecutive elements.</li>\n<li>Move the leftmost character of <code>arr[i + 1]</code> to the rightmost position in <code>arr[i]</code>. For instance, &quot;abc&quot; and &quot;def&quot; will become &quot;abcd&quot; and &quot;ef&quot;. Again, this operation can be applied only once to any pair of consecutive elements.</li>\n<li>Do nothing to the pair of consecutive elements.</li>\n</ol>\n<p>Is it possible to obtain a palindromic array from arr by performing these operations?</p>\n<p>Consider the case when arr = <code>{\"aa\", \"bab\", \"cde\", \"aba\", \"ab\"}</code>. Here the output should be true and here is why:</p>\n<p>Move first char from 1st index to the last position of 0th index, arr = <code>{\"aab\", \"ab\", \"cde\", \"aba\", \"ab\"}</code>\nMove last char from 3rd index to the first position of 4th index, arr = <code>{\"aab\", \"ab\", \"cde\", \"ab\", \"aab\"}</code>, which is a palindromic array.</p>\n<p>I tried solutions such as two pointer, etc. but doesn't seem to work.</p>",
  "Title: Prepend leading zeros to each line of a file\nBody: <p>I have a file that looks like this:</p>\n<pre><code>1:line1\n14:line2\n135:line3\n15:line4\n</code></pre>\n<p>I need to prepend leading zeros to each line to make it look like this:</p>\n<pre><code>00001:line1\n00014:line2\n00135:line3\n00015:line4\n</code></pre>\n<p>Is there an easy way to do this in Java? Ideally I’d like to read a file and write the transformed output, padding the number before the colon to 5 digits and leaving the rest of the line untouched.</p>",
  "Title: Capture the last word on each line.\nBody: <p>I have a file that doesn't have the correct spacing and I would like to add a space between the dollar amount and the word right beside it, i.e., <code>2342.20Hello</code>.</p>\n<p>I tried using command-line tools to resolve this issue but it didn't seem to work.</p>\n<p>I was expecting the file that has:</p>\n<pre><code>2234.3Hello\n8938.3HeyYou\n1239.0New\n</code></pre>\n<p>To look like this:</p>\n<pre><code>2234.3 Hello\n8938.3 HeyYou\n1239.0 New\n</code></pre>\n<p>How can I do this in Java? Please include code that reads a text file, inserts a space between the decimal number and the following word on each line, and writes the result back (or to a new file). A regex-based solution is fine.</p>",
  "Title: Fast and efficient substring extraction and comparison in Java\n\nBody: <p>I have a problem concerning very fast and efficient comparison between the substrings of two strings in my dataset, which won't run fast enough despite pretty powerful machinery.\nI have a dataset with 2 columns and about 1.5 billion rows, which has this structure:</p>\n<pre><code>import java.util.*;\nimport java.util.stream.*;\n\nList&lt;String&gt; class1 = Arrays.asList(\"002134\", \"024345\", \"176234\");\nList&lt;String&gt; class2 = Arrays.asList(\"002003\", \"024234\", \"002004\");\n</code></pre>\n<p>What I want is a function that (1) extracts the first 3 digits from each string by row for both vectors, (2) compares the substrings between the two vectors, and (3) create a new boolean variable that reports whether the two substrings are equal or not.</p>\n<p>So the desired result is as follows:</p>\n<pre><code>List&lt;Boolean&gt; sameclass = Arrays.asList(true, true, false);\nSystem.out.println(sameclass);\n// [true, true, false]\n</code></pre>\n<p>I have tried versions using substring extraction and comparison inside streams and loops, and also tried computing Hamming distance. The bottleneck still seems to be substring extraction when scaled up to billions of rows.</p>\n<pre><code>// straightforward loop\nList&lt;Boolean&gt; sameclass = new ArrayList&lt;&gt;(class1.size());\nfor (int i = 0; i &lt; class1.size(); i++) {\n    String a = class1.get(i);\n    String b = class2.get(i);\n    sameclass.add(a.substring(0, 3).equals(b.substring(0, 3)));\n}\n\n// using startsWith\nList&lt;Boolean&gt; sameclass2 = IntStream.range(0, class1.size())\n        .mapToObj(i -&gt; class2.get(i).startsWith(class1.get(i).substring(0, 3)))\n        .collect(Collectors.toList());\n</code></pre>\n<p>All versions either run into memory problems or take several hours to a day to run. Since I need to do this repeatedly this does not work for me, and I wanted to ask if you can come up with something faster / more efficient in Java. Any help would be greatly appreciated!</p>\n<p><strong>EDIT</strong></p>\n<p>I have benchmarked some of the methods suggested here, which indeed show a substantial speedup using JMH:</p>\n<pre><code>import org.openjdk.jmh.annotations.*;\nimport java.util.*;\nimport java.util.concurrent.TimeUnit;\n\n@BenchmarkMode(Mode.AverageTime)\n@OutputTimeUnit(TimeUnit.MICROSECONDS)\n@State(Scope.Thread)\npublic class SubstringBench {\n\n    List&lt;String&gt; class1;\n    List&lt;String&gt; class2;\n\n    @Setup\n    public void setup() {\n        class1 = new ArrayList&lt;&gt;();\n        class2 = new ArrayList&lt;&gt;();\n        for (int i = 0; i &lt; 1000; i++) {\n            class1.addAll(Arrays.asList(\"002134\", \"024345\", \"176234\"));\n            class2.addAll(Arrays.asList(\"002003\", \"024234\", \"002004\"));\n        }\n    }\n\n    @Benchmark\n    public int startsWithTest() {\n        int count = 0;\n        for (int i = 0; i &lt; class1.size(); i++) {\n            if (class2.get(i).startsWith(class1.get(i).substring(0, 3))) count++;\n        }\n        return count;\n    }\n\n    @Benchmark\n    public int substringEqualsTest() {\n        int count = 0;\n        for (int i = 0; i &lt; class1.size(); i++) {\n            if (class1.get(i).substring(0, 3).equals(class2.get(i).substring(0, 3))) count++;\n        }\n        return count;\n    }\n}\n</code></pre>\n<p>I will go with startsWith for now, since it seems to offer the highest speed. Thank you for the help!</p>",
  "Title: Sorting command-line words by length in Java  \nBody: <p>I'm attempting to read words from the command line using <code>args</code> in Java and then sort them in descending order based on their lengths. However, my sorting algorithm is producing unexpected output.</p>\n<p>The code I'm using is as follows:</p>\n<pre><code>public class Main {\n    public static void main(String[] args) {\n\n        for (int i = 0; i &lt; args.length - 1; i++) {\n            for (int j = 0; j &lt; args.length - i - 1; j++) {\n                if (args[j].length() &lt; args[j + 1].length()) {\n                    String temp = args[j];\n                    args[j] = args[j + 1];\n                    args[j + 1] = temp;\n                }\n            }\n        }\n\n        System.out.println();\n        for (String s : args) {\n            System.out.print(s + \" \");\n        }\n    }\n}\n</code></pre>\n<pre><code>javac Main.java\njava Main I put this words\n\n\npuwordI wordI I  % \n</code></pre>\n<p>Unfortunately, the output is corrupted. I suspect there might be an issue with my sorting logic or how I'm handling the command line arguments. Could someone please review my code and provide guidance on how to correctly sort the words by length?</p>",
  "Title: how do I concatenate and join an array of strings with a delimiter in Java?\nBody: <p>JUnit test:</p>\n<pre><code>import static org.junit.jupiter.api.Assertions.assertEquals;\nimport static org.junit.jupiter.api.Assertions.assertIterableEquals;\nimport java.util.List;\nimport org.junit.jupiter.api.Test;\n\nclass MyStringsTests {\n\n  List&lt;String&gt; slist() {\n    return List.of(\"1\", \"2\", \"3\");\n  }\n\n  @Test\n  void literalJoinArray() {\n    String joined = String.join(\",\", \"1\", \"2\", \"3\");\n    assertEquals(\"1,2,3\", joined);\n  }\n\n  @Test\n  void literalJoinList() {\n    String joined = String.join(\",\", List.of(\"1\", \"2\", \"3\"));\n    assertEquals(\"1,2,3\", joined);\n  }\n\n  @Test\n  void slistReturnsList() {\n    assertIterableEquals(List.of(\"1\", \"2\", \"3\"), slist());\n  }\n\n  @Test\n  void slistJoin() {\n    String joined = String.join(\",\", slist());\n    assertEquals(\"1,2,3\", joined);\n  }\n}\n</code></pre>\n<p>In one of my attempts, joining the result of <code>slist()</code> didn't produce the expected string. Why would joining a list returned from a method behave differently from joining a literal list or array, and what's the correct way to do it in Java?</p>"
]