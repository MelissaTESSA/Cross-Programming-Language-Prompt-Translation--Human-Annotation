[
  "Title: How do I fix Composer refusing to install packages in a system-managed PHP environment?\nBody: <p>Composer refuses to install packages system-wide on my Debian/Ubuntu system and says the PHP environment is managed by the OS. It suggests installing PHP packages via <code>apt</code> instead of Composer.</p>\n<p>I use <code>apt update</code> and <code>apt upgrade</code>. How should I install non-distro PHP libraries and applications safely? Should I use project-local installs, a separate Composer home, or something else?</p>",
  "Title: Error \"Call to undefined method DataFrame::append()\"\nBody: <p>I’m trying to append an associative array to a DataFrame object in PHP, but I get this error:</p>\n<blockquote>\n<p>Call to undefined method DataFrame::append()</p>\n</blockquote>\n<p>Code snippet:</p>\n<pre><code>$df = (new DataFrame($df))->append($newRow);\n</code></pre>\n<p>I expected the associative array <code>$newRow</code> to be added as a new row. How can I fix this?</p>",
  "Title: Why did Laravel start failing with \"Class 'Symfony\\Component\\HttpFoundation\\HeaderBag' not found\"?\nBody: <p>Environment:</p>\n<pre class=\"lang-none prettyprint-override\"><code>PHP 8.2.12\nlaravel/framework==10.2.0\n</code></pre>\n<p>I run my Laravel backend code in a docker container, with BASE image:\n<code>FROM php:8.2-fpm-alpine</code></p>\n<p>But when I run the PHPUnit tests with version <code>phpunit/phpunit 10.3.2</code>,</p>\n<pre class=\"lang-none prettyprint-override\"><code>composer require --dev phpunit/phpunit\nvendor/bin/phpunit\n</code></pre>\n<p>it raises an error, with logs:</p>\n<pre class=\"lang-none prettyprint-override\"><code>==================================== ERRORS ====================================\n___________ ERROR collecting tests/Feature/FiftyoneUtilsTest.php _______________\nFatal error: Uncaught Error: Class 'Symfony\\Component\\HttpFoundation\\HeaderBag' not found in /var/www/vendor/laravel/framework/src/Illuminate/Http/Request.php:28\nStack trace:\n#0 /var/www/vendor/laravel/framework/src/Illuminate/Http/Request.php(28): Illuminate\\Http\\Request-&gt;initialize()\n#1 /var/www/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(138): Illuminate\\Http\\Request::capture()\n#2 /var/www/artisan(37): Illuminate\\Foundation\\Http\\Kernel-&gt;handle()\n#3 {main}\n  thrown in /var/www/vendor/laravel/framework/src/Illuminate/Http/Request.php on line 28\n</code></pre>\n<p>My code works well when I directly run it with <code>php artisan serve</code>.</p>\n<p><code>artisan</code> runs the app normally.</p>\n<p>I guess it should be a PHPUnit version issue, because it used to work without changing any related code, and I used <code>composer require --dev phpunit/phpunit</code> without defining a specific version.</p>\n<p>And my backend runs well without PHPUnit.</p>",
  "Title: OpenAI ChatGPT (gpt-3.5-turbo) API error 429: “You exceeded your current quota, please check your plan and billing details”.\nBody: <p>I’m writing a PHP script to use OpenAI via its API. However, I’m getting this error:</p>\n<blockquote>\n<p>HTTP 429: You exceeded your current quota, please check your plan and billing details</p>\n</blockquote>\n<p>My script is the following:</p>\n<pre class=\"lang-php prettyprint-override\"><code>&lt;?php\nrequire __DIR__ . '/vendor/autoload.php';\n\nuse OpenAI;\n\n$client = OpenAI::client('&lt;My API Key&gt;');\n\n$response = $client->chat()->create([\n    'model' => 'gpt-3.5-turbo',\n    'messages' => [\n        ['role' => 'user', 'content' => 'Tell the world about the ChatGPT API in the style of a pirate.'],\n    ],\n]);\n\necho $response->choices[0]->message->content;\n</code></pre>\n<p>I’m assuming it should work since I haven’t made any API requests yet, so I’m guessing there’s an issue in my code. What am I missing?</p>",
  "Title: OpenSSL version issue when using OpenAI PHP client (LibreSSL detected)\nBody: <p>After <code>composer require openai-php/client</code>, when I try to use the client, I get an error indicating my PHP SSL is built with LibreSSL instead of OpenSSL 1.1.1+.</p>\n<blockquote>\n<p>My PHP SSL/TLS stack is built with LibreSSL, not OpenSSL 1.1.1+, so HTTPS requests fail.</p>\n</blockquote>\n<p>I’m following a tutorial to use the OpenAI API with PHP. The first step is to install the client and create the client instance, but I’m stuck with this SSL issue. I couldn’t find a working fix.</p>\n<p>Here’s the code I’m running:</p>\n<pre class=\"lang-php prettyprint-override\"><code>&lt;?php\n\nrequire __DIR__ . '/vendor/autoload.php';\n\n$client = OpenAI::client(getenv('OPENAI_API_KEY'));\n</code></pre>\n<p>I tried updating dependencies with Composer, but it didn’t help:</p>\n<pre class=\"lang-none prettyprint-override\"><code>composer update\n</code></pre>\n<p>How do I resolve this SSL/OpenSSL issue on macOS so the OpenAI PHP client can make HTTPS requests?</p>",
  "Title: Error Updating Composer: PHP Fatal error: Call to undefined function openssl_pkey_new()\nBody: <p>I'm getting an error when installing/updating any Composer package in PHP. Purging and reinstalling <code>composer</code> and every package I can think of hasn't helped. Here's the error I get when running <code>composer self-update</code> (but it's the same when I try <code>composer require</code> or <code>composer update</code>):</p>\n<pre><code>PHP Fatal error:  Uncaught Error: Call to undefined function openssl_pkey_new() in phar:///usr/bin/composer/src/Composer/Util/StreamContextFactory.php:107\nStack trace:\n#0 phar:///usr/bin/composer/src/Composer/Util/StreamContextFactory.php(55): Composer\\Util\\StreamContextFactory::create()\n#1 phar:///usr/bin/composer/src/Composer/IO/BaseIO.php(263): Composer\\Util\\StreamContextFactory::getContext()\n#2 phar:///usr/bin/composer/src/Composer/IO/BaseIO.php(238): Composer\\IO\\BaseIO-&gt;getStreamContext()\n#3 phar:///usr/bin/composer/src/Composer/Downloader/FileDownloader.php(203): Composer\\IO\\BaseIO-&gt;copy()\n#4 phar:///usr/bin/composer/src/Composer/Downloader/FileDownloader.php(118): Composer\\Downloader\\FileDownloader-&gt;download()\n#5 phar:///usr/bin/composer/src/Composer/Downloader/DownloadManager.php(202): Composer\\Downloader\\FileDownloader-&gt;download()\n#6 phar:///usr/bin/composer/src/Composer/Installer/LibraryInstaller.php(160): Composer\\Downloader\\DownloadManager-&gt;download()\n#7 phar:///usr/bin/composer/src/Composer/Installer/InstallationManager.php(207): Composer\\Installer\\LibraryInstaller-&gt;install()\n#8 phar:///usr/bin/composer/src/Composer/Installer/Installer.php(832): Composer\\Installer\\InstallationManager-&gt;execute()\n#9 phar:///usr/bin/composer/src/Composer/Installer/Installer.php(704): Composer\\Installer\\Installer-&gt;doInstall()\n#10 phar:///usr/bin/composer/src/Composer/Installer/Installer.php(298): Composer\\Installer\\Installer-&gt;doUpdate()\n#11 phar:///usr/bin/composer/src/Composer/Command/UpdateCommand.php(248): Composer\\Installer\\Installer-&gt;run()\n#12 phar:///usr/bin/composer/src/Composer/Console/Application.php(1008): Composer\\Command\\UpdateCommand-&gt;execute()\n#13 phar:///usr/bin/composer/src/Composer/Console/Application.php(286): Composer\\Console\\Application-&gt;doRunCommand()\n#14 phar:///usr/bin/composer/src/Composer/Console/Application.php(197): Composer\\Console\\Application-&gt;doRun()\n#15 phar:///usr/bin/composer/bin/composer(67): Composer\\Console\\Application-&gt;run()\n#16 /usr/bin/composer(31): include('phar:///usr/bin...')\n#17 {main}\n  thrown in phar:///usr/bin/composer/src/Composer/Util/StreamContextFactory.php on line 107\n</code></pre>\n<p>I'm running Ubuntu 20.04 in WSL. The PHP OpenSSL extension is already installed:</p>\n<pre><code>sudo apt install php-openssl\nReading package lists... Done\nBuilding dependency tree       \nReading state information... Done\nphp-openssl is already the newest version.\n0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.\n</code></pre>\n<p>My assumption is that I need to reinstall some stuff, but I'm not sure what. I've tried the obvious things like <code>php-openssl</code>, <code>libssl-dev</code>, <code>libffi-dev</code>, <code>composer</code> itself and <code>php</code> altogether.</p>",
  "Title: Error: Unable to extract uploader id — YouTube, Discord-PHP\nBody: <p>I have a music bot in Discord using PHP (Discord-PHP) that plays audio in voice channels. It pulls audio from YouTube using youtube-dl. It <strong>worked perfectly before</strong> but now it won’t work with any video. I tried updating youtube-dl but it still doesn’t work. I searched everywhere but still can’t find an answer that helps.</p>\n<p>This is the error: <code>Error: Unable to extract uploader id</code></p>\n<p>Before and after the error log there is no other information. Can anyone help?</p>\n<p>Here’s some of the code I use for the bot… The YouTube setup settings:</p>\n<pre><code>&lt;?php\nuse YoutubeDl\\YoutubeDl;\n\n$ytdlFormatOptions = [\n    'format' =&gt; 'bestaudio/best',\n    'outtmpl' =&gt; '%(extractor)s-%(id)s-%(title)s.%(ext)s',\n    'restrictfilenames' =&gt; true,\n    'noplaylist' =&gt; true,\n    'nocheckcertificate' =&gt; true,\n    'ignoreerrors' =&gt; false,\n    'logtostderr' =&gt; false,\n    'quiet' =&gt; true,\n    'no_warnings' =&gt; true,\n    'default_search' =&gt; 'auto',\n    'source_address' =&gt; '0.0.0.0',\n];\n\n$ffmpegOptions = [\n    'options' =&gt; '-vn',\n];\n\n$ytdl = new YoutubeDl();\n$ytdl-&gt;setBinPath('/usr/bin/youtube-dl'); // path to youtube-dl\n$ytdl-&gt;setDownloaderOptions($ytdlFormatOptions);\n\nclass YTDLSource\n{\n    public $data;\n    public $title;\n    public $url;\n    public $duration;\n    public $image;\n\n    public function __construct($data)\n    {\n        $this-&gt;data = $data;\n        $this-&gt;title = $data['title'] ?? null;\n        $this-&gt;url = $data['url'] ?? null;\n        $this-&gt;duration = $data['duration'] ?? null;\n        $this-&gt;image = $data['thumbnails'][0]['url'] ?? null;\n    }\n\n    public static function fromUrl($url, $stream = false)\n    {\n        // Extract info from youtube-dl here\n        // If it's a playlist, take the first entry\n        // Build filename or stream URL\n    }\n}\n?&gt;\n</code></pre>\n<p>Approximate command to run the audio (from my bot):</p>\n<pre><code>&lt;?php\n$sessionChannel = $message-&gt;author-&gt;voice-&gt;channel;\n$sessionChannel-&gt;connect();\n\n$url = $matched[1];\n\n$player = YTDLSource::fromUrl($url, true);\n\n$sessionChannel-&gt;guild-&gt;voiceClient-&gt;play($player, function ($e) {\n    if ($e) {\n        echo \"Player error: {$e}\\n\";\n    }\n});\n?&gt;\n</code></pre>",
  "Title: pre-commit fails to install php-cs-fixer 3.15.0 with error “RuntimeError: The Composer configuration is invalid”.\nBody: <p><a href=\"https://pre-commit.com/\" rel=\"noreferrer\">pre-commit</a> suddenly started to fail installing the <a href=\"https://github.com/PHP-CS-Fixer/PHP-CS-Fixer\" rel=\"noreferrer\">php-cs-fixer</a> hook in our builds today with the following error</p>\n<pre><code>[INFO] Installing environment for https://github.com/PHP-CS-Fixer/PHP-CS-Fixer.\n[INFO] Once installed this environment will be reused.\n[INFO] This may take a few minutes...\nAn unexpected error has occurred: CalledProcessError: command: ('/builds/.../.cache/pre-commit/repo0_h0f938/php_env/bin/php', 'composer', 'install', '--no-interaction')\nreturn code: 1\nexpected return code: 0\n[...]\nstderr:\n      ERROR: Command errored out with exit status 1:\n[...]\n        File \"/tmp/composer-build-env-_3j1398p/overlay/vendor/composer/Factory.php\", line 57, in createComposer\n          throw new RuntimeException(\"The Composer configuration is invalid:\\n\" . $message);\n      RuntimeException: The Composer configuration is invalid:\n        - [extra.pipfile_deprecated_finder.2] 'pip-shims<=0.3.4' does not match '^[a-zA-Z-_.0-9]+$'\n</code></pre>\n<p>It seems to be related with composer configuration..</p>",
  "Title: Composer install on an existing project error “does not contain any element”\n\nBody: <p>I’m using Composer for the first time. I have a very simple project:</p>\n<pre><code>a_project\n|\n|--tests\n|    |---test_something.php\n|\n|-script_to_test.php\n</code></pre>\n<p>From the project root I run <code>composer init</code> and then <code>composer install</code>.</p>\n<p>I get output like this (packages listed, then an error message):</p>\n<pre><code>composer install\n... (dependency resolution output)\n\n.../a_project does not contain any element\n</code></pre>\n<p>After this I can run <code>vendor/bin/phpunit</code> without problems. What does that error message mean and how should I resolve it?</p>",
  "Title: composer install is failing: \"This environment is externally managed\".\nBody: <p>Command:</p>\n<pre class=\"lang-none prettyprint-override\"><code>composer install\n</code></pre>\n<p>Output:</p>\n<pre class=\"lang-none prettyprint-override\"><code>This environment is externally managed.\nTo install PHP packages system-wide, use your OS package manager.\nFor project-specific dependencies, use Composer in a local project directory.\n</code></pre>\n<p>I wish someone would explain to me what to do and how to solve it.</p>",
  "Title: Why is array_shift() over 200 times slower than unset($b[0]) for arrays?\nBody: <p>Letting them compete three times (a million shifts/unsets each time):</p>\n<pre><code>&lt;?php\nfor ($i = 0; $i &lt; 3; $i++) {\n    $t1 = microtime(true);\n    $b = range(0, 999999);\n    for ($k = 0; $k &lt; 1000000; $k++) {\n        array_shift($b);\n    }\n    $t1 = microtime(true) - $t1;\n\n    $t2 = microtime(true);\n    $b = range(0, 999999);\n    for ($k = 0; $k &lt; 1000000; $k++) {\n        unset($b[0]);\n    }\n    $t2 = microtime(true) - $t2;\n\n    echo $t1 / $t2 . PHP_EOL;\n}\n</code></pre>\n<p>Time ratios:</p>\n<pre><code>274.6037053753368\n219.38099365582403\n252.08691226683823\n</code></pre>\n<p>Why is <code>array_shift()</code> that much slower at doing the same thing?</p>",
  "Title: Why is the simpler loop slower in PHP?\nBody: <p>Called with <code>$n = 10**8</code>, the simple loop is consistently significantly slower for me than the complex one, and I don't see why:</p>\n<pre><code>function simple(int $n): void {\n    while ($n) {\n        $n -= 1;\n    }\n}\n\nfunction complex(int $n): void {\n    while (true) {\n        if (!$n) {\n            break;\n        }\n        $n -= 1;\n    }\n}\n</code></pre>\n<p>Some times in seconds:</p>\n<pre class=\"lang-none prettyprint-override\"><code>simple 4.340795516967773\ncomplex 3.6490490436553955\nsimple 4.374553918838501\ncomplex 3.639145851135254\nsimple 4.336690425872803\ncomplex 3.624480724334717\nPHP: 8.2.9 (cli)\n</code></pre>\n<p>So it looks like the complex one does more work per iteration (an extra branch). Then why is it faster?</p>\n<p>Seems to be a PHP 8.2 phenomenon, see the comments.</p>\n<p>Benchmark script:</p>\n<pre class=\"lang-php prettyprint-override\"><code>&lt;?php\nfunction simple(int $n): void {\n    while ($n) {\n        $n -= 1;\n    }\n}\n\nfunction complex(int $n): void {\n    while (true) {\n        if (!$n) {\n            break;\n        }\n        $n -= 1;\n    }\n}\n\nforeach ([ 'simple', 'complex', 'simple', 'complex', 'simple', 'complex' ] as $f) {\n    $t = microtime(true);\n    $f(10**8);\n    echo $f, ' ', microtime(true) - $t, PHP_EOL;\n}\n\necho 'PHP: ', PHP_VERSION, PHP_EOL;\n</code></pre>",
  "Title: Fatal error: Undefined constant 'IMG_ANTIALIAS' when resizing with GD\nBody: <ul>\n<li>Trying to resize images in my PHP app, so I’m using GD.</li>\n<li>IMG_ANTIALIAS is not working, however IMG_BILINEAR_FIXED works</li>\n</ul>\n<p>Here's some sample code:</p>\n<pre class=\"lang-php prettyprint-override\"><code>&lt;?php\n$img = imagecreatefrompng(\"VC.png\");\n\n$img = imagescale($img, 20, 20, IMG_ANTIALIAS);\n\nheader(\"Content-Type: image/png\");\nimagepng($img);\nimagedestroy($img);\n</code></pre>\n<p>Here's the error:</p>\n<pre class=\"lang-none prettyprint-override\"><code>Fatal error: Uncaught Error: Undefined constant \"IMG_ANTIALIAS\"\n</code></pre>\n<ul>\n<li>Tried reinstalling PHP and the GD extension. Didn’t work.</li>\n<li>Asked ChatGPT about this; it said to upgrade PHP/GD. I’m on the latest version.</li>\n</ul>",
  "Title: \"Class 'Aws\\\\S3\\\\S3Client' not found\" on AWS Lambda using a layer\n\nBody: <h1>What I want to achieve</h1>\n<p>To scrape a website using AWS Lambda and save the data on S3.</p>\n\n<h1>The issues I'm having</h1>\n<p>When I execute Lambda, the following error message appears.</p>\n<blockquote>\n<p>{ \"errorMessage\": \"Unable to load handler function: Class 'Aws\\\\S3\\\\S3Client' not found in /var/task/index.php:5\", \"errorType\": \"Error\", \"requestId\": \"fb66bea9-cbad-4bd3-bd4d-6125454e21be\", \"stackTrace\": [] }</p>\n</blockquote>\n\n<h1>Code</h1>\n<p>The minimum Lambda code is as follows.</p>\n<pre><code>&lt;?php\n\nuse Aws\\S3\\S3Client;\n\nfunction handler($event, $context) {\n    $s3 = new S3Client([\n        'version' => 'latest',\n        'region'  => 'ap-northeast-1',\n    ]);\n\n    $s3-&gt;putObject([\n        'Bucket' =&gt; 'horserace-dx',\n        'Key'    =&gt; 'raw/a.html',\n        'Body'   =&gt; 'testtext',\n    ]);\n\n    return $event;\n}\n</code></pre>\n\n<p>A layer was added to the Lambda. Files were saved in a <code>vendor</code> folder using the commands below, zipped, then uploaded to AWS Lambda as a layer.</p>\n<pre><code>composer require aws/aws-sdk-php\ncomposer require guzzlehttp/guzzle\ncomposer require symfony/dom-crawler\ncomposer require symfony/css-selector\n</code></pre>\n\n<ul>\n<li>The bucket <code>horserace-dx</code> exists</li>\n<li>The folder <code>raw</code> exists</li>\n<li>The role of the Lambda is properly set. It can read from and write to S3</li>\n<li>The runtime of the Lambda is PHP 8.2 (Bref). The PHP version of the local computer is 8.2.x.</li>\n</ul>\n\n<h1>What I did so far</h1>\n<p>I searched for the error and found some suggestions. I rebuilt the layer with the following and tried again in vain.</p>\n<pre><code>composer require aws/aws-sdk-php\ncomposer require guzzlehttp/guzzle\ncomposer require symfony/dom-crawler\ncomposer require symfony/css-selector\ncomposer dump-autoload -o\n</code></pre>\n\n<p>So what should I do to achieve what I want to achieve? Any suggestions would be greatly appreciated.</p>",
  "Title: Why is a BLAS dot product so much faster than array_sum in PHP?\nBody: <p>Why is a BLAS dot product so much faster than <code>array_sum</code>? I know <code>array_sum</code> is implemented in C, so I expected it to be very fast.</p>\n<p>For example:</p>\n<pre><code>In [20]: $A = [];\nIn [21]: for ($i = 0; $i &lt; 1000; $i++) { $A[] = mt_rand() / mt_getrandmax(); }\n\nIn [22]: %timeit array_sum($A)\n3.21 µs ± 270 ns per loop (mean ± std. dev. of 7 runs, 100,000 loops each)\n\nIn [23]: %timeit manualSum($A)\n1.7 µs ± 11.5 ns per loop (mean ± std. dev. of 7 runs, 1,000,000 loops each)\n</code></pre>\n<p>But both are slower than calling a BLAS dot product (via FFI) with a vector of ones:</p>\n<pre><code>In [25]: $O = array_fill(0, 1000, 1.0);\nIn [26]: %timeit cblas_ddot($A, $O)\n1.18 µs ± 43.9 ns per loop (mean ± std. dev. of 7 runs, 1,000,000 loops each)\n</code></pre>\n<p>Given that dot is multiplying two arrays elementwise and then summing them, how can this be faster than just summing one array? If <code>$O</code> is all ones, the dot product is effectively summing <code>$A</code>.</p>\n<p>So it seems the fastest option to sum <code>$A</code> is:</p>\n<pre><code>In [27]: $O = array_fill(0, 1000, 1.0);\nIn [28]: %timeit cblas_ddot($A, $O)\n1.16 µs ± 6.37 ns per loop (mean ± std. dev. of 7 runs, 1,000,000 loops each)\n</code></pre>\n<p>This can't be right, can it?</p>\n<p>This is on Ubuntu with PHP 8.2, OpenBLAS, using FFI to call <code>cblas_ddot</code>.</p>\n<p><strong>Update</strong></p>\n<p>The order of the timings reverses if the array is much longer. That is:</p>\n<pre><code>In [28]: $A = [];\nIn [29]: for ($i = 0; $i &lt; 1000000; $i++) { $A[] = mt_rand() / mt_getrandmax(); }\nIn [30]: $O = array_fill(0, 1000000, 1.0);\n\nIn [31]: %timeit cblas_ddot($A, $O)\n545 µs ± 8.87 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)\n\nIn [32]: %timeit array_sum($A)\n429 µs ± 11 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)\n\nIn [33]: %timeit manualSum($A)\n404 µs ± 2.95 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)\n</code></pre>\n<p>This implies there is some fixed overhead when calling <code>array_sum</code> or a PHP loop that doesn't exist when calling the BLAS dot product, but the actual summation code is in fact faster.</p>\n<p>——————————-</p>\n<p>Any speedups using FFI, extensions, or other PHP techniques would be great to see.</p>",
  "Title: Why does PHP create a Closure internally for an array_map “comprehension”?\nBody: <p>I’m using PHP 8.3 and I want a comprehension-like one‑liner:</p>\n<pre><code class=\"language-php\">&lt;?php\n$result = array_map(fn($_) =&gt; true, []);\n</code></pre>\n<p>The arrow function becomes a <code>Closure</code> object and is immediately invoked by <code>array_map</code>. I can’t see why a separate function object has to be created for such a simple expression. Is this required by the engine, or is it some optimization detail?</p>",
  "Title: Unexpected uint64 behaviour 0xFFFF'FFFF'FFFF'FFFF - 1 = 0?.\nBody: <p>Consider the following brief PHP session showcasing <code>uint64_t</code> via FFI</p>\n<pre><code>&lt;?php\n$ffi = FFI::cdef('typedef unsigned long long uint64_t;');\n\n$a = $ffi-&gt;new('uint64_t[1]');\n$a[0] = 0;\n\nvar_dump($a[0]);\n// int(0)\n\n$a[0] -= 1;\nvar_dump($a[0]);\n// int(18446744073709551615)\n// this is 0xffff ffff ffff ffff, as expected\n\n$a[0] -= 1;\nvar_dump($a[0]);\n// int(0)\n// what the heck?\n</code></pre>\n<p>I'm utterly confused by this last output.</p>\n<p>I would expect 0xFFFF'FFFF'FFFF'FFFE.</p>\n<p>What exactly is going on here?</p>\n<p>My setup:</p>\n<pre><code>&lt;?php\nvar_dump(PHP_OS);\nvar_dump(PHP_VERSION);\n</code></pre>",
  "Title: PDO throws \"Call to undefined method PDO::execute()\" when running a query\n\nBody: <p>First of all, I'm totally new to development. I'm taking AI/Data Science courses and one of my tasks is to read from a SQL database, make a forecast, then export a CSV for PowerBI.</p>\n<p>I'm stuck with my PHP code and I have no idea where the issue is:</p>\n<pre class=\"lang-php prettyprint-override\"><code>&lt;?php\nrequire __DIR__ . '/vendor/autoload.php';\n\n$pdo = new PDO('mysql:host=localhost;dbname=data;charset=utf8mb4', 'root', 'Password');\n\n$query = \"SELECT Cle_Produit, Date_Facturation, SUM(Quantite) AS Total_Quantite\n          FROM ventes\n          GROUP BY Cle_Produit, Date_Facturation\";\n\n$rows = $pdo-&gt;execute($query);\n\n$data = [];\nforeach ($rows as $row) {\n    $data[$row['Date_Facturation']][$row['Cle_Produit']] = $row['Total_Quantite'];\n}\n\n// ... reshape data for forecasting model ...\n\n// ... run forecasting model ...\n\n// ... export to CSV ...\n?&gt;\n</code></pre>\n<p>It returns this error:</p>\n<blockquote>\n<p>Fatal error: Uncaught Error: Call to undefined method PDO::execute()</p>\n</blockquote>\n<p>Please, can somebody help me?</p>\n<p>I want this script to create a CSV file with the prediction. The model should use the table <code>ventes</code> from the DB <code>data</code> and use the columns <code>Cle_Produit</code>, <code>Quantite</code> and <code>Date_Facturation</code>.</p>",
  "Title: Cuda 12 + tf-nightly 2.12: Could not find cuda drivers on your machine, GPU will not be used, while every checking is fine and in torch it works.\n\nBody: <ul>\n<li><strong>tf-nightly version</strong> = 2.12.0-dev2023203</li>\n<li><strong>Python version</strong> = 3.10.6</li>\n<li><strong>CUDA drivers version</strong> = 525.85.12</li>\n<li><strong>CUDA version</strong> = 12.0</li>\n<li><strong>Cudnn version</strong> = 8.5.0</li>\n<li>I am using <strong>Linux</strong> (x86_64, Ubuntu 22.04)</li>\n<li>I am coding in <strong>Visual Studio Code</strong> on a <strong>venv</strong> virtual environment</li>\n</ul>\n<p>I am trying to run some models on the GPU (NVIDIA GeForce RTX 3050) using tensorflow nightly 2.12 (to be able to use Cuda 12.0). The problem that I have is that apparently every checking that I am making seems to be correct, but in the end the script is not able to detect the GPU. I've dedicated a lot of time trying to see what is happening and nothing seems to work, so any advice or solution will be more than welcomed. The GPU seems to be working for torch as you can see at the very end of the question.</p>\n<p>I will show some of the most common checkings regarding CUDA that I did (Visual Studio Code terminal), I hope you find them useful:</p>\n<ol>\n<li><p><strong>Check CUDA version:</strong></p>\n<p><code>$ nvcc --version</code></p>\n<pre><code>nvcc: NVIDIA (R) Cuda compiler driver\nCopyright (c) 2005-2023 NVIDIA Corporation\nBuilt on Fri_Jan__6_16:45:21_PST_2023\nCuda compilation tools, release 12.0, V12.0.140\nBuild cuda_12.0.r12.0/compiler.32267302_0\n</code></pre>\n</li>\n<li><p><strong>Check if the connection with the CUDA libraries is correct:</strong></p>\n<p><code>$ echo $LD_LIBRARY_PATH</code></p>\n<pre><code>/usr/cuda/lib\n</code></pre>\n</li>\n<li><p><strong>Check nvidia drivers for the GPU and check if GPU is readable for the venv:</strong></p>\n<p><code>$ nvidia-smi</code></p>\n<pre><code>+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 525.85.12    Driver Version: 525.85.12    CUDA Version: 12.0     |\n|-------------------------------+----------------------+----------------------+\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|                               |                      |               MIG M. |\n|===============================+======================+======================|\n|   0  NVIDIA GeForce ...  On   | 00000000:01:00.0  On |                  N/A |\n| N/A   40C    P5     6W /  20W |     46MiB /  4096MiB |     22%      Default |\n|                               |                      |                  N/A |\n+-------------------------------+----------------------+\n\n+-----------------------------------------------------------------------------+\n| Processes:                                                                  |\n|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n|        ID   ID                                                   Usage      |\n|=============================================================================|\n|    0   N/A  N/A      1356      G   /usr/lib/xorg/Xorg                 45MiB |\n+-----------------------------------------------------------------------------+\n</code></pre>\n</li>\n<li><p><strong>Add cuda/bin PATH and Check it:</strong></p>\n<p><code>$ export PATH=\"/usr/local/cuda/bin:$PATH\"</code></p>\n<p><code>$ echo $PATH</code></p>\n<pre><code>/usr/local/cuda-12.0/bin:/home/victus-linux/Escritorio/MasterThesis_CODE/to_share/venv_master/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/snap/bin\n</code></pre>\n</li>\n<li><p><strong>Custom function to check if CUDA is correctly installed: [<a href=\"https://stackoverflow.com/questions/31326015/how-to-verify-cudnn-installation\">function by Sherlock</a>]</strong></p>\n<pre class=\"lang-bash prettyprint-override\"><code>function lib_installed() { /sbin/ldconfig -N -v $(sed 's/:/ /' &lt;&lt;&lt; $LD_LIBRARY_PATH) 2&gt;/dev/null | grep $1; }\nfunction check() { lib_installed $1 &amp;&amp; echo \"$1 is installed\" || echo \"ERROR: $1 is NOT installed\"; }\ncheck libcuda\ncheck libcudart\n</code></pre>\n<pre><code>libcudart.so.12 -&gt; libcudart.so.12.0.146\n        libcuda.so.1 -&gt; libcuda.so.525.85.12\n        libcuda.so.1 -&gt; libcuda.so.525.85.12\n        libcudadebugger.so.1 -&gt; libcudadebugger.so.525.85.12\nlibcuda is installed\n        libcudart.so.12 -&gt; libcudart.so.12.0.146\nlibcudart is installed\n</code></pre>\n</li>\n<li><p><strong>Custom function to check if Cudnn is correctly installed: [<a href=\"https://stackoverflow.com/questions/31326015/how-to-verify-cudnn-installation\">function by Sherlock</a>]</strong></p>\n<pre class=\"lang-bash prettyprint-override\"><code>function lib_installed() { /sbin/ldconfig -N -v $(sed 's/:/ /' &lt;&lt;&lt; $LD_LIBRARY_PATH) 2&gt;/dev/null | grep $1; }\nfunction check() { lib_installed $1 &amp;&amp; echo \"$1 is installed\" || echo \"ERROR: $1 is NOT installed\"; }\ncheck libcudnn \n</code></pre>\n<pre><code>        libcudnn_cnn_train.so.8 -&gt; libcudnn_cnn_train.so.8.8.0\n        libcudnn_cnn_infer.so.8 -&gt; libcudnn_cnn_infer.so.8.8.0\n        libcudnn_adv_train.so.8 -&gt; libcudnn_adv_train.so.8.8.0\n        libcudnn.so.8 -&gt; libcudnn.so.8.8.0\n        libcudnn_ops_train.so.8 -&gt; libcudnn_ops_train.so.8.8.0\n        libcudnn_adv_infer.so.8 -&gt; libcudnn_adv_infer.so.8.8.0\n        libcudnn_ops_infer.so.8 -&gt; libcudnn_ops_infer.so.8.8.0\nlibcudnn is installed\n</code></pre>\n</li>\n</ol>\n<p>So, once I did these previous checkings I used a PHP script to evaluate if everything was finally ok and then the following error appeared:</p>\n<pre class=\"lang-php prettyprint-override\"><code>&lt;?php\n\n$cmd = 'python3 -c \"import tensorflow as tf; print(); print(\\'Tensorflow version = \\', tf.__version__); print(); print(tf.config.list_physical_devices(\\'GPU\\'));\"';\necho shell_exec($cmd);\n</code></pre>\n<pre><code>2023-03-02 12:05:09.463343: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.\n2023-03-02 12:05:09.489911: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.\n2023-03-02 12:05:09.490522: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2023-03-02 12:05:10.066759: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\n\nTensorflow version = 2.12.0-dev20230203\n\n2023-03-02 12:05:10.748675: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355\n2023-03-02 12:05:10.771263: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1956] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.\nSkipping registering GPU devices...\n\n[]\n</code></pre>\n<p><strong>Extra check:</strong> I tried to run a checking script on torch and in here it worked so I guess the problem is related with tensorflow/tf-nightly</p>\n<pre class=\"lang-php prettyprint-override\"><code>&lt;?php\n\n$cmd = 'python3 -c \"import torch; print(); print(\\'Available cuda = \\', torch.cuda.is_available()); print(); print(\\'GPUs availables = \\', torch.cuda.device_count()); print(); print(\\'Current device = \\', torch.cuda.current_device()); print(); print(\\'Current Device location = \\', torch.cuda.device(0)); print(); print(\\'Name of the device = \\', torch.cuda.get_device_name(0));\"';\necho shell_exec($cmd);\n</code></pre>\n<pre><code>Available cuda = True\n\nGPUs availables = 1\n\nCurrent device = 0\n\nCurrent Device location = &lt;torch.cuda.device object at 0x7fbe26fd2ec0&gt;\n\nName of the device = NVIDIA GeForce RTX 3050 Laptop GPU\n</code></pre>\n<p>Please, if you know something that might help solve this issue, don't hesitate on telling me.</p>",
  "Title: Theoretically can the Ackermann function be optimized?.\nBody: <p>I am wondering if there can be a version of Ackermann function with better time complexity than the standard variation.</p>\n<p>This is not a homework and I am just curious. I know the Ackermann function doesn't have any practical use besides as a performance benchmark, because of the deep recursion. I know the numbers grow very large very quickly, and I am not interested in computing it.</p>\n<p>Even though I use PHP 8 and the integers won't overflow, I do have finite time, but I have implemented a version of it myself according to the definition found on <a href=\"https://en.wikipedia.org/wiki/Ackermann_function\" rel=\"noreferrer\">Wikipedia</a>, and computed the output for extremely small values, just to make sure the output is correct.</p>\n<p><a href=\"https://i.stack.imgur.com/vsPES.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/vsPES.jpg\" alt=\"enter image description here\" /></a></p>\n<pre><code>function A(int $m, int $n): int {\n    if ($m === 0) {\n        return $n + 1;\n    }\n    return $n ? A($m - 1, A($m, $n - 1)) : A($m - 1, 1);\n}\n</code></pre>\n<p>The above code is a direct translation of the image, and is extremely slow, I don't know how it can be optimized, is it impossible to optimize it?</p>\n<p>One thing I can think of is to memoize it, but the recursion runs backwards, each time the function is recursively called the arguments were not encountered before, each successive function call the arguments decrease rather than increase, therefore each return value of the function needs to be calculated, memoization doesn't help when you call the function with different arguments the first time.</p>\n<p>Memoization can only help if you call it with the same arguments again, it won't compute the results and will retrieve cached result instead, but if you call the function with any input with (m, n) &gt;= (4, 2) it will crash the interpreter regardless.</p>\n<p>I also implemented another version according to this <a href=\"https://stackoverflow.com/a/20411205/16383578\">answer</a>:</p>\n<pre><code>function ack(int $x, int $y): int {\n    for ($i = $x; $i > 0; $i--) {\n        $y = $y ? ack($i, $y - 1) : 1;\n    }\n    return $y + 1;\n}\n</code></pre>\n<p>But it is actually slower:</p>\n<pre><code>In [2]: %timeit A(3, 4)\n1.3 ms ± 9.75 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)\n\nIn [3]: %timeit ack(3, 4)\n2 ms ± 59.9 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)\n</code></pre>\n<p>Theoretically can Ackermann function be optimized? If not, can it be definitely proven that its time complexity cannot decrease?</p>\n<hr />\n<p>I have just tested <code>A(3, 9)</code> and <code>A(4, 1)</code> will crash the interpreter, and the performance of the two functions for <code>A(3, 8)</code>:</p>\n<pre><code>In [2]: %timeit A(3, 8)\n432 ms ± 4.63 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\n\nIn [3]: %timeit ack(3, 8)\n588 ms ± 10.4 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\n</code></pre>\n<hr />\n<p>I did some more experiments:</p>\n<pre><code>$c = [];\n\nfunction A1(int $m, int $n): int {\n    global $c;\n    $key = $m . ',' . $n;\n    $c[$key] = ($c[$key] ?? 0) + 1;\n    if ($m === 0) {\n        return $n + 1;\n    }\n    return $n ? A1($m - 1, A1($m, $n - 1)) : A1($m - 1, 1);\n}\n\nfunction test(int $m, int $n): array {\n    global $c;\n    $c = [];\n    A1($m, $n);\n    return $c;\n}\n</code></pre>\n<p>The arguments indeed repeat.</p>\n<p>But surprisingly caching doesn't help at all:</p>\n<pre><code>In [9]: %timeit Ackermann = cache(A); Ackermann(3, 4)\n1.3 ms ± 10.1 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)\n</code></pre>\n<p>Caching only helps when the function is called with the same arguments again, as explained:</p>\n<pre><code>In [14]: %timeit Ackermann(3, 2)\n101 ns ± 0.47 ns per loop (mean ± std. dev. of 7 runs, 10,000,000 loops each)\n</code></pre>\n<p>I have tested it with different arguments numerous times, and it always gives the same efficiency boost (which is none).</p>",
  "Title: Why is array_shift($b) over 200 times slower than unset($b[0]) for an array of bytes?\nBody: <p>Letting them compete three times (a million shifts/unsets each time):</p>\n<pre><code>&lt;?php\nfor ($i = 0; $i &lt; 3; $i++) {\n    $b = array_fill(0, 1000000, 0);\n    $t1_start = microtime(true);\n    for ($j = 0; $j &lt; 1000000; $j++) {\n        array_shift($b);\n    }\n    $t1 = microtime(true) - $t1_start;\n\n    $b = array_fill(0, 1000000, 0);\n    $t2_start = microtime(true);\n    for ($j = 0; $j &lt; 1000000; $j++) {\n        unset($b[0]);\n    }\n    $t2 = microtime(true) - $t2_start;\n\n    echo ($t1 / $t2) . PHP_EOL;\n}\n</code></pre>\n<p>Time ratios:</p>\n<pre><code>274.6037053753368\n219.38099365582403\n252.08691226683823\n</code></pre>\n<p>Why is <code>array_shift</code> that much slower at doing the same thing?</p>",
  "Title: Why isn’t the derived class destructor called when unsetting an array through a base-class reference?\n\nBody: <p>I have an <code>Animal</code> class with a destructor, and a derived class <code>Cat</code> with its own destructor.</p>\n<pre><code>&lt;?php\n\nclass Animal\n{\n    public function __construct()\n    {\n        echo \"Animal constructor\\n\";\n    }\n\n    public function __destruct()\n    {\n        echo \"Animal destructor\\n\";\n    }\n}\n\nclass Cat extends Animal\n{\n    public function __construct()\n    {\n        parent::__construct();\n        echo \"Cat constructor\\n\";\n    }\n\n    public function __destruct()\n    {\n        echo \"Cat destructor\\n\";\n    }\n}\n\n$j = [new Cat()];\n/** @var Animal[] $j */\nunset($j);\n</code></pre>\n<p>This gives the output:</p>\n<blockquote>\n<p>Animal constructor<br />\nCat constructor<br />\nAnimal destructor</p>\n</blockquote>\n<p>I don’t understand why the <code>Cat</code> destructor isn’t called. I thought PHP destructors were effectively virtual—what am I missing?</p>",
  "Title: Convenient way to declare 2D (or even higher dimension) arrays with SplFixedArray.\nBody: <p>I'm about to convert a lot of old PHP code to be more modern and memory‑efficient.</p>\n<p>There are many raw 2D arrays in that code like:</p>\n<pre><code>$bar = [];\nfor ($x = 0; $x &lt; XSIZE; $x++) {\n    for ($y = 0; $y &lt; YSIZE; $y++) {\n        $bar[$x][$y] = new Foo();\n    }\n}\n</code></pre>\n<p>And I'm about to replace these declarations with nested <code>SplFixedArray</code>:</p>\n<pre><code>$bar = new SplFixedArray(XSIZE);\nfor ($x = 0; $x &lt; XSIZE; $x++) {\n    $bar[$x] = new SplFixedArray(YSIZE);\n}\n</code></pre>\n<p>This is convenient because the usage stays the same and I can control sizes more strictly than with raw arrays.</p>\n<p>But IMO the nested <code>SplFixedArray</code> is somewhat cumbersome and not easy to read, and with 3D arrays (although I have none) it would even be worse.</p>\n<p>Right now I'm using this helper function to make the declaration more readable:</p>\n<pre><code>function declare2dArray(int $x, int $y): SplFixedArray {\n    $outer = new SplFixedArray($x);\n    for ($i = 0; $i &lt; $x; $i++) {\n        $outer[$i] = new SplFixedArray($y);\n    }\n    return $outer;\n}\n...\n$bar = declare2dArray(XSIZE, YSIZE);\n</code></pre>\n<p>But I feel this to be a hack, and I'm wondering if there is a cleaner, more PHP way to do something similar.</p>",
  "Title: GCC removes a bounds check in the right operand of &&, but not in the left operand, why?\nBody: <p>I have the following C/C++ code snippet:</p>\n<pre><code>#define ARRAY_LENGTH 666\n\nint g_sum = 0;\nextern int *g_ptrArray[ ARRAY_LENGTH ];\n\nvoid test()\n{\n    unsigned int idx = 0;\n\n    // either enable or disable the check \"idx &lt; ARRAY_LENGTH\" in the while loop\n    while( g_ptrArray[ idx ] != nullptr /* &amp;&amp; idx &lt; ARRAY_LENGTH */ )\n    {\n        g_sum += *g_ptrArray[ idx ];\n        ++idx;\n    }\n\n    return;\n}\n</code></pre>\n<hr />\n<p>When I compile the above code using GCC compiler in version 12.2.0 with the option <code>-Os</code> for both cases:</p>\n<ol>\n<li>the while loop condition is <code>g_ptrArray[ idx ] != nullptr</code></li>\n<li>the while loop condition is <code>g_ptrArray[ idx ] != nullptr &amp;&amp; idx &lt; ARRAY_LENGTH</code></li>\n</ol>\n<p>I get the following assembly:</p>\n<pre><code>test():\n        ldr     r2, .L4\n        ldr     r1, .L4+4\n.L2:\n        ldr     r3, [r2], #4\n        cbnz    r3, .L3\n        bx      lr\n.L3:\n        ldr     r3, [r3]\n        ldr     r0, [r1]\n        add     r3, r3, r0\n        str     r3, [r1]\n        b       .L2\n.L4:\n        .word   g_ptrArray\n        .word   .LANCHOR0\ng_sum:\n        .space  4\n</code></pre>\n<p>As you can see the assembly does !NOT! do any checking of the variable <code>idx</code> against the value <code>ARRAY_LENGTH</code>.</p>\n<hr />\n<h2>My question</h2>\n<p>How is that possible?\nHow can the compiler generate the exactly same assembly for both cases and ignore the <code>idx &lt; ARRAY_LENGTH</code> condition if it is present in the code? Explain me the rule or procedure, how the compiler comes to the conclusion that it can completely remove the condition.</p>\n<p>The output assembly shown in Compiler Explorer (see both assemblies are identical):</p>\n<ol>\n<li><p>the while condition is <code>g_ptrArray[ idx ] != nullptr</code>:</p>\n<ul>\n<li><a href=\"https://godbolt.org/z/M13oEcKqM\" rel=\"noreferrer\">https://godbolt.org/z/M13oEcKqM</a></li>\n</ul>\n</li>\n<li><p>the while condition is <code>g_ptrArray[ idx ] != nullptr &amp;&amp; idx &lt; ARRAY_LENGTH</code>:</p>\n<ul>\n<li><a href=\"https://godbolt.org/z/T6e3PWjn6\" rel=\"noreferrer\">https://godbolt.org/z/T6e3PWjn6</a></li>\n</ul>\n</li>\n</ol>\n<p>NOTE: If I swap the order of conditions to be <code>idx &lt; ARRAY_LENGTH &amp;&amp; g_ptrArray[ idx ] != nullptr</code>, the output assembly contains the check for value of <code>idx</code> as you can see here: <a href=\"https://godbolt.org/z/fvbsTfr9P\" rel=\"noreferrer\">https://godbolt.org/z/fvbsTfr9P</a>.</p>",
  "Title: Are multidimensional array accesses sequenced?\nBody: <p>Take the following:</p>\n<pre><code>function a(): int {\n    echo \"a\\n\";\n    return 0;\n}\n\nfunction b(): int {\n    echo \"b\\n\";\n    return 1;\n}\n\nfunction c(): int {\n    echo \"c\\n\";\n    return 2;\n}\n\nfunction d(): int {\n    echo \"d\\n\";\n    return 3;\n}\n</code></pre>\n<p>Will the following have predictable behavior?</p>\n<pre><code>$arr = array_fill(0, 4, array_fill(0, 4, array_fill(0, 4, array_fill(0, 4, 0))));\n$arr[a()][b()][c()][d()] = 1;\n</code></pre>\n<p>Is it guaranteed to print in this order:</p>\n<pre class=\"lang-none prettyprint-override\"><code>a\nb\nc\nd\n</code></pre>\n<p>I am aware that constructs such as the following are invalid or problematic in some languages:</p>\n<pre><code>$i = 0;\n$i = $i++;\n</code></pre>\n<p>Put another way, is the following valid in PHP:</p>\n<pre><code>$i = 0;\n$arr = array_fill(0, 4, array_fill(0, 4, array_fill(0, 4, array_fill(0, 4, 0))));\n$arr[$i++][$i++][$i++][$i++] = 1;\n</code></pre>\n<p>Or does it invoke undefined or unspecified behavior due to unsequenced modification and access to <code>$i</code>?</p>\n<p>According to the PHP language rules, is there a defined sequence point between each successive <code>[]</code> while indexing a multidimensional array?</p>\n<p>To be clear, neither of these examples have to do with precedence, the placement of implicit parenthesis, the order in which the operators operate on their operands. The question is about sequencing, the order in which the <em>operands themselves</em> are evaluated.</p>",
  "Title: How to use array input in a custom GitHub Action written in PHP\nBody: <p>I’m building a custom GitHub Action in PHP and need to accept an array input.</p>\n<p>I currently pass a space-separated string in the workflow:</p>\n<pre class=\"lang-yaml prettyprint-override\"><code>      - uses: actions/my-custom-ci\n        with:\n          subdirectories: src/main/java src/test/java\n</code></pre>\n<p>But I want to use YAML list syntax instead:</p>\n<pre class=\"lang-yaml prettyprint-override\"><code>      - uses: actions/my-custom-ci\n        with:\n          subdirectories:\n            - src/main/java\n            - src/test/java\n</code></pre>\n<p>Is it possible for a PHP-based GitHub Action to receive array input? If yes, how should I parse and handle it in PHP?</p>",
  "Title: Merging users with multiple refs and count their collective assets.\nBody: <p>There is a set of users. A person can have multiple users, but <code>ref1</code> and <code>ref2</code> might be alike and can therefore link users together. <code>ref1</code> and <code>ref2</code> does not overlap, one value in <code>ref1</code> does not exist in <code>ref2</code>.</p>\n<p>A user can own multiple assets. I want to &quot;merge&quot; users that has one or more refs alike and then count how many assets they own together. There could be missing entries in the user table, in that case I just want to propagate the owner into ref2 and set the asset_count and asset_ids.</p>\n<p>Here is an example schema to illustrate:</p>\n<p><strong>Example assets</strong></p>\n<pre><code>SELECT * FROM assets;\n</code></pre>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>id</th>\n<th>name</th>\n<th>owner</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>#1</td>\n<td>a</td>\n</tr>\n<tr>\n<td>2</td>\n<td>#2</td>\n<td>b</td>\n</tr>\n<tr>\n<td>3</td>\n<td>#3</td>\n<td>c</td>\n</tr>\n<tr>\n<td>4</td>\n<td>#4</td>\n<td>a</td>\n</tr>\n<tr>\n<td>5</td>\n<td>#5</td>\n<td>c</td>\n</tr>\n<tr>\n<td>6</td>\n<td>#6</td>\n<td>d</td>\n</tr>\n<tr>\n<td>7</td>\n<td>#7</td>\n<td>e</td>\n</tr>\n<tr>\n<td>8</td>\n<td>#8</td>\n<td>d</td>\n</tr>\n<tr>\n<td>9</td>\n<td>#9</td>\n<td>a</td>\n</tr>\n<tr>\n<td>10</td>\n<td>#10</td>\n<td>a</td>\n</tr>\n<tr>\n<td>11</td>\n<td>#11</td>\n<td>z</td>\n</tr>\n</tbody>\n</table>\n</div><hr />\n<p><strong>Example users</strong></p>\n<pre><code>SELECT * FROM users;\n</code></pre>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>id</th>\n<th>username</th>\n<th>ref1</th>\n<th>ref2</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>bobo</td>\n<td>a</td>\n<td>d</td>\n</tr>\n<tr>\n<td>2</td>\n<td>toto</td>\n<td>b</td>\n<td>e</td>\n</tr>\n<tr>\n<td>3</td>\n<td>momo</td>\n<td>c</td>\n<td>d</td>\n</tr>\n<tr>\n<td>4</td>\n<td>lolo</td>\n<td>a</td>\n<td>f</td>\n</tr>\n<tr>\n<td>5</td>\n<td>popo</td>\n<td>c</td>\n<td>f</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p><strong>What I want to get in the end</strong></p>\n<pre><code>SELECT * FROM results;\n</code></pre>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>ids</th>\n<th>usernames</th>\n<th>refs1</th>\n<th>refs2</th>\n<th>asset_ids</th>\n<th>asset_count</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1,3,4,5</td>\n<td>bobo,momo,lolo,popo</td>\n<td>a,c</td>\n<td>d,f</td>\n<td>1,3,4,5,6,8,9,10</td>\n<td>8</td>\n</tr>\n<tr>\n<td>2</td>\n<td>toto</td>\n<td>b</td>\n<td>e</td>\n<td>2,7</td>\n<td>2</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td></td>\n<td>z</td>\n<td>11</td>\n<td>1</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>I've tried different approaches, but this is what I currently have:</p>\n<p><strong>Closest I have got</strong></p>\n<pre><code>SELECT\n  ARRAY_AGG(DISTINCT u.id) AS ids,\n  ARRAY_AGG(DISTINCT u.username) AS usernames,\n  ARRAY_AGG(DISTINCT u.ref1) AS refs1,\n  ARRAY_AGG(DISTINCT u.ref2) AS refs2,\n  COUNT(DISTINCT a.id) AS asset_count\nFROM assets a\nJOIN users u ON a.owner = u.ref1 OR a.owner = u.ref2\nGROUP BY a.owner\nORDER BY MIN(a.id);\n</code></pre>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>ids</th>\n<th>usernames</th>\n<th>refs1</th>\n<th>refs2</th>\n<th>asset_count</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1,4</td>\n<td>bobo,lolo</td>\n<td>a</td>\n<td>d,f</td>\n<td>4</td>\n</tr>\n<tr>\n<td>2</td>\n<td>toto</td>\n<td>b</td>\n<td>e</td>\n<td>1</td>\n</tr>\n<tr>\n<td>3,5</td>\n<td>momo,popo</td>\n<td>c</td>\n<td>d,f</td>\n<td>2</td>\n</tr>\n<tr>\n<td>1,3</td>\n<td>bobo,momo</td>\n<td>a,c</td>\n<td>d</td>\n<td>2</td>\n</tr>\n<tr>\n<td>2</td>\n<td>toto</td>\n<td>b</td>\n<td>e</td>\n<td>1</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>If I merge the above table on ids, I almost get the result I want (without the missing entries in the user table). The merging can easily be done in code, but then I cannot paginate etc. I want to to this in DB layer if possible.</p>\n<p>I want either a solution to the problem or a good explanation of why it is not possible to do (with examples).</p>\n<p>Please check out my <a href=\"https://www.db-fiddle.com/f/4jyoMCicNSZpjMt4jFYoz5/8836\" rel=\"noreferrer\">DB Fiddle</a>.</p>",
  "Title: sort() on SplFixedArray subset triggers “Index invalid or out of range” error.\nBody: <p>The code below throws a RuntimeException: “Index invalid or out of range”. I don’t understand why, <code>$w</code> is guaranteed to be &lt;= <code>$arr1-&gt;getSize()</code>.</p>\n<pre><code>&lt;?php\ndeclare(strict_types=1);\n\nfunction test_func(): bool {\n    // ...\n}\n\nfunction tempfunc(): int\n{\n    $arr1 = new SplFixedArray(5);\n    $w = 0;\n\n    for ($i = 0; $i &lt; 5; $i++) {\n        if (test_func()) {\n            $arr1[$w] = [3.0, 4];\n            $w++;\n        }\n    }\n\n    // sort only the first $w elements\n    $tmp = array_slice($arr1-&gt;toArray(), 0, $w);\n    sort($tmp);\n\n    return 0;\n}\n</code></pre>",
  "Title: Why is this PHP program producing an array of arrays rather than a simple array?\nBody: <pre><code>&lt;?php\n$f = [];\nforeach (new DirectoryIterator(getenv('HOME')) as $file) {\n    if ($file-&gt;isDot()) continue;\n    $filename = $file-&gt;getBasename();\n    $f[$filename][] = [$file-&gt;getPathname(), mt_rand() / mt_getrandmax()];\n}\n\n$keys = array_keys($f);\n$randomKey = $keys[array_rand($keys)];\n$p = [$randomKey =&gt; $f[$randomKey]]; // just need any old random element\n\necho gettype($p), PHP_EOL;\necho gettype(array_values($p)), \" has \", count(array_values($p)), \" elements\", PHP_EOL;\necho gettype(array_values($p)[0]), \" has \", count(array_values($p)[0]), \" elements\", PHP_EOL;\n\necho PHP_EOL;\necho PHP_VERSION, PHP_EOL;\necho PHP_OS, PHP_EOL;\n</code></pre>\n<p>Output:</p>\n<pre><code>array\narray has 1 elements\narray has 2 elements\n\n8.2.x\nDarwin\n</code></pre>\n<p>Why is <code>array_values($p)</code> an array containing another array, rather than a simple flat array?</p>",
  "Title: Insert one array into another at a specific index in PHP?\nBody: <p>In PHP I can merge arrays with <code>array_merge()</code>, but it appends the second array to the end of the first.</p>\n<pre><code>$arr1 = [1, 4, 5];\n$arr2 = [2, 3];\n\n$result = array_merge($arr1, $arr2);\n\n// Output:\n// [1, 4, 5, 2, 3]\n</code></pre>\n<p>How can I insert the second array so it becomes part of the first array starting at index 1, like this?</p>\n<pre><code>[1, 2, 3, 4, 5]\n</code></pre>\n<p>I tried using <code>array_splice($arr1, 1, 0, $arr2)</code> but I’m not sure how to apply it correctly. What’s the proper way to do this?</p>",
  "Title: Can you initialize a `const` byte array from a string literal in PHP?\nBody: <p>In PHP, strings are byte sequences, but arrays are a distinct type. I want a constant array of bytes that comes directly from a string literal rather than listing each element manually.</p>\n<p>For example:</p>\n<pre><code>const BYTES = \"test\"; // this is a string, not an array\nconst BYTES = ['t', 'e', 's', 't']; // this is an array, but it's manual\n</code></pre>\n<p>Is there any PHP syntax that lets me initialize a <code>const</code> array of bytes from a string literal, or do I have to build the array at runtime (e.g., with <code>str_split()</code>)?</p>",
  "Title: Is PHP wrong to allow the initialization of a readonly array property with another array reference?\nBody: <p>While (re)implementing a simple immutable map, I wrote this:</p>\n<pre class=\"lang-php prettyprint-override\"><code>&lt;?php\nfinal class FlatMap\n{\n    /** @var array&lt;array{int,string}&gt; */\n    private readonly array $elements;\n\n    public function __construct(array $arr)\n    {\n        $this-&gt;elements = $arr; // works in PHP?\n    }\n\n    public function get(int $key): string\n    {\n        foreach ($this-&gt;elements as [$k, $v]) {\n            if ($k === $key) {\n                return $v;\n            }\n        }\n        throw new RuntimeException('Key not found');\n    }\n}\n\n$m = new FlatMap([\n    [4, 'a'],\n    [-1, 'b'],\n    [42, 'c'],\n]);\n\nassert($m-&gt;get(4) === 'a');\nassert($m-&gt;get(-1) === 'b');\nassert($m-&gt;get(42) === 'c');\n</code></pre>\n<p>I naively thought to set the private array <code>$elements</code> as <code>readonly</code> and initialize it in the constructor; PHP accepts it and everything seems fine.</p>\n<p>In hindsight, is this actually safe? Am I relying on any non‑obvious behavior around array copying?</p>\n<p>Also, what would you do to avoid copying the array elements by hand?</p>",
  "Title: why a pair of int[N] arrays is not allowed in C++?\nBody: <p>Why can't the C++ code below be compiled?</p>\n<pre><code>#include &lt;utility&gt;\n\nint main() {\n    int x[6];\n    int y[6];\n    std::pair&lt;int[6], int[6]&gt; a(x, y);\n    return 0;\n}\n</code></pre>\n<p>For example MSVC gives the following error:</p>\n<blockquote>\n<p>error C2661: 'std::pair&lt;int [6],int [6]&gt;::pair': no overloaded function takes 2 argument</p>\n</blockquote>\n<p>Thanks for the comments about using C++ alternatives to construct arrays, but I also want to know the reason that the code can't be compiled.</p>",
  "Title: array_splice() usage causing TypeError in VS Code Debug Console\n\nBody: <p>I am getting the following error on VS Code Debug Console;</p>\n<p>\"Uncaught TypeError: array_splice() expects parameter 1 to be array\"</p>\n<p>when I run this code;</p>\n<pre><code>&lt;?php\n$months = [\"Jan\", \"Mar\", \"Apr\", \"May\"];\n\n// Inserting an element at index 1\n$months2 = array_splice($months, 1, 0, \"Feb\");\nprint_r($months2); // [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\"]\n</code></pre>\n<p>I copied this pattern from a tutorial and I’m trying to learn how to insert into an array.</p>\n<p>Any help would be highly appreciated. Thank you.</p>",
  "Title: Is a two-dimensional array implemented as a continuous one-dimensional array？\nBody: <p>I have a question about the memory layout of a two-dimensional array in PHP.\nIf I define one like <code>$a = [[1,2,3,4],[5,6,7,8],[9,10,11,12]]</code>, is the memory allocated to this array continuous?</p>\n<p>Or in other words, is a two-dimensional array implemented as a continuous one-dimensional array?</p>\n<p>If the answer is yes, is accessing <code>$a[0][6]</code> equivalent to accessing <code>$a[1][2]</code>?</p>\n<p>I wrote the following PHP program.</p>\n<pre><code>&lt;?php\n$a = [\n    [1, 2, 3, 4],\n    [5, 6, 7, 8],\n    [9, 10, 11, 12],\n];\necho $a[0][6], \" \", $a[1][2], PHP_EOL;\n</code></pre>\n<p>I find that the output is <code>7 7</code>.</p>\n<p><code>$a[0][6]</code> seems illegal, but it points to <code>$a[1][2]</code>. I want to know why and whether such access is legal in PHP.</p>",
  "Title: How to shuffle array of items but allow weights to influence the order.\n\nBody: <p>I'm trying to write a PHP function to shuffle an array.</p>\n<p>By default, I want the shuffle order to be random (but subject to a seed).\n(I already have access to this function: <code>function random(int $seed): float</code>)</p>\n<p>However, I want to also allow influencing the order via weights per item.</p>\n<p>In other words, I want the the default item weight to be 1, and if an item has a weight of 10, it should be 10 times more likely to appear sooner in the shuffled order.</p>\n<p>Am I even thinking about this correctly? Is this a reasonable goal?</p>\n<p>I was thinking that I'd need to use the Fisher-Yates algorithm but adapted to honor a weights array of the same length as the main array, and the main array will be shuffled such that higher weighted items are more likely to appear first.</p>\n<pre><code>function removeDuplicates(array $array): array {\n  $uniqueValues = [];\n  $result = [];\n  foreach ($array as $item) {\n    $key = is_object($item) ? spl_object_id($item) : (string)$item;\n    if (!isset($uniqueValues[$key])) {\n      $uniqueValues[$key] = true;\n      $result[] = $item;\n    }\n  }\n  return $result;\n}\n\nfunction duplicateItemsBasedOnWeights(array $array, array $weights): array {\n  $result = [];\n  foreach ($array as $index =&gt; $element) {\n    for ($position = 0; $position &lt; $weights[$index]; $position++) {\n      $result[] = $element;\n    }\n  }\n  return $result;\n}\n\nfunction shuffleWithWeights(array $array, array $weights, int $seed): array {\n  $arrayWithDuplicateValuesBasedOnWeights = duplicateItemsBasedOnWeights($array, $weights);\n\n  $shuffledArrayWithDuplicateValuesBasedOnWeights = shuffleArrayUsingFisherYates($arrayWithDuplicateValuesBasedOnWeights, $seed);\n\n  return removeDuplicates($shuffledArrayWithDuplicateValuesBasedOnWeights);\n}\n</code></pre>\n<p>I've looked at empirical results by calling it a bunch of different times with these values (and a different seed each time), and the results don't seem distributed how I'd hoped, so I must have been approaching this problem incorrectly.</p>\n<pre><code>$items = [1, 2, 3, 4, 5];\n$weights = [1, 1, 1, 200, 1000];\n</code></pre>\n<p>In my real-world cases, I'll be shuffling 70,000 objects (which would explore to <em>many</em> more than that if I use my current approach of creating duplicate items based on item weight).</p>",
  "Title: Why does a nested array object prevent providing storage?\nBody: <p>On <a href=\"https://en.cppreference.com/w/cpp/language/lifetime\" rel=\"noreferrer\">Lifetime</a> under <strong>Providing storage</strong>, it says:</p>\n<blockquote>\n<p>As a special case, objects can be created in arrays of unsigned char or std::byte (since C++17) (in which case it is said that the array provides storage for the object) if</p>\n<ul>\n<li>the lifetime of the array has begun and not ended</li>\n<li>the storage for the new object fits entirely within the array</li>\n<li>there is no array object that satisfies these constraints nested within the array.</li>\n</ul>\n</blockquote>\n<p>Why is the third condition there?</p>\n<p>Even if there's a nested array (I believe it means an array which starts at some index of the outer array and ends at an index that's no farther, not an array which is an item of the outer array, as the term nested would probably be understood in most languages), what difficulty does it pose to the standard authors or implementations to enable a segment of the outer array disjoint with the nested array to provide storage?</p>\n<p>And, if the nested array doesn't have any array nested in it, do I understand correctly that it can provide storage? If so, why can't the outer array provide storage in the same place, i.e. with the segment providing storage not straddling the start or end of any nested (perhaps indirectly) array?</p>\n<p>And, even with straddling, what problems could arise that the standard included this requirement to avoid?</p>\n<p>Additionally, can a nested array not satisfy the second condition, i.e. overlap it partially? Can such arrays even exist? In what sense and under what conditions is then one nested in another? Can both ever be nested in each other?</p>",
  "Title: Why can I declare a fixed-size array with a class constant in some cases and not others?\nBody: <p>I'm trying to create a class that includes a 2D fixed-size array along with some member functions.</p>\n<p>When I write:</p>\n<pre><code>class Board {\n    const BOARDSIZE = 8;\n\n    public SplFixedArray $data;\n}\n</code></pre>\n<p>and then try to initialize <code>$data</code> with <code>self::BOARDSIZE</code> in the property declaration, PHP complains. However, when I write:</p>\n<pre><code>const BOARDSIZE = 8;\n\nclass Board {\n    public SplFixedArray $data;\n}\n</code></pre>\n<p>or just hardcode:</p>\n<pre><code>class Board {\n    public SplFixedArray $data;\n}\n</code></pre>\n<p>and initialize it with <code>new SplFixedArray(8)</code> in the constructor, there is no error.</p>\n<p>I've searched around and can't figure out why it won't accept one and not the other. I'd rather not declare <code>BOARDSIZE</code> as a global constant because I don't want it just floating around in a large project, but I also don't want to have to write 8 every time a member function of the class needs the board size for flexibility down the line.</p>\n<p>Is there a way to have a class-local constant representing the size of the board that I can use to initialize a fixed-size array?</p>",
  "Title: Obtain palindromic array by performing these operations.\nBody: <p>An array is called palindromic if it remains the same after reversing the order of its elements.</p>\n<p>You have an array of strings arr. For each i, <code>arr[i]</code> consists of at least two characters. For each pair of consecutive elements <code>arr[i]</code> and <code>arr[i + 1]</code>, you can:</p>\n<ol>\n<li>Move the rightmost character of <code>arr[i]</code> to the leftmost position in <code>arr[i + 1]</code>. For instance, &quot;abc&quot; and &quot;def&quot; will become &quot;ab&quot; and &quot;cdef&quot;. This operation can be applied only once to any pair of consecutive elements.</li>\n<li>Move the leftmost character of <code>arr[i + 1]</code> to the rightmost position in <code>arr[i]</code>. For instance, &quot;abc&quot; and &quot;def&quot; will become &quot;abcd&quot; and &quot;ef&quot;. Again, this operation can be applied only once to any pair of consecutive elements.</li>\n<li>Do nothing to the pair of consecutive elements.</li>\n</ol>\n<p>Is it possible to obtain a palindromic array from arr by performing these operations?</p>\n<p>Consider the case when arr = <code>{&quot;aa&quot;, &quot;bab&quot;, &quot;cde&quot;, &quot;aba&quot;, &quot;ab&quot;}</code>. Here the output should be true and here is why:</p>\n<p>Move first char from 1st index to the last position of 0th index, arr = <code>{&quot;aab&quot;, &quot;ab&quot;, &quot;cde&quot;, &quot;aba&quot;, &quot;ab&quot;}</code>\nMove last char from 3rd index to the first position of 4th index, arr = <code>{&quot;aab&quot;, &quot;ab&quot;, &quot;cde&quot;, &quot;ab&quot;, &quot;aab&quot;}</code>, which is a palindromic array.</p>\n<p>I tried solutions such as two pointer, etc. but doesn't seem to work. Can someone provide a Php approach or algorithm for this?</p>",
  "Title: Sorting an array of objects in PHP\n\nBody: <p>Hello everyone, I still can’t sort the array correctly in PHP. I need to sort the following array:</p>\n<pre><code>$arr = [\n    ['id' => 3123124, 'parentId' => 0, 'title' => 'title', 'type' => 'block'],\n    ['id' => 3542132, 'parentId' => 3123124, 'title' => 'title', 'type' => 'child'],\n    ['id' => 12345, 'parentId' => 88888, 'title' => 'title', 'type' => 'block'],\n    ['id' => 24124, 'parentId' => 12345, 'title' => 'title', 'type' => 'child'],\n    ['id' => 99999, 'parentId' => 45324, 'title' => 'title', 'type' => 'child'],\n    ['id' => 986648, 'parentId' => 3123124, 'title' => 'title', 'type' => 'block'],\n    ['id' => 77777, 'parentId' => 88888, 'title' => 'title', 'type' => 'child'],\n    ['id' => 54232, 'parentId' => 3123124, 'title' => 'title', 'type' => 'child'],\n    ['id' => 54308, 'parentId' => 15075, 'title' => 'title', 'type' => 'child'],\n    ['id' => 66666, 'parentId' => 88888, 'title' => 'title', 'type' => 'block'],\n    ['id' => 56445, 'parentId' => 12345, 'title' => 'title', 'type' => 'child'],\n    ['id' => 88888, 'parentId' => 45324, 'title' => 'title', 'type' => 'block'],\n    ['id' => 15075, 'parentId' => 12345, 'title' => 'title', 'type' => 'block'],\n    ['id' => 84356, 'parentId' => 66666, 'title' => 'title', 'type' => 'child'],\n    ['id' => 45324, 'parentId' => 0, 'title' => 'title', 'type' => 'block'],\n];\n\n$newArr = [\n    ['id' => 3123124, 'parentId' => 0, 'title' => 'title', 'type' => 'block'],\n    ['id' => 3542132, 'parentId' => 3123124, 'title' => 'title', 'type' => 'child'],\n    ['id' => 54232, 'parentId' => 3123124, 'title' => 'title', 'type' => 'child'],\n    ['id' => 986648, 'parentId' => 3123124, 'title' => 'title', 'type' => 'block'],\n    ['id' => 45324, 'parentId' => 0, 'title' => 'title', 'type' => 'block'],\n    ['id' => 99999, 'parentId' => 45324, 'title' => 'title', 'type' => 'child'],\n    ['id' => 88888, 'parentId' => 45324, 'title' => 'title', 'type' => 'block'],\n    ['id' => 77777, 'parentId' => 88888, 'title' => 'title', 'type' => 'child'],\n    ['id' => 12345, 'parentId' => 88888, 'title' => 'title', 'type' => 'block'],\n    ['id' => 56445, 'parentId' => 12345, 'title' => 'title', 'type' => 'child'],\n    ['id' => 24124, 'parentId' => 12345, 'title' => 'title', 'type' => 'child'],\n    ['id' => 15075, 'parentId' => 12345, 'title' => 'title', 'type' => 'block'],\n    ['id' => 54308, 'parentId' => 15075, 'title' => 'title', 'type' => 'child'],\n    ['id' => 66666, 'parentId' => 88888, 'title' => 'title', 'type' => 'block'],\n    ['id' => 84356, 'parentId' => 66666, 'title' => 'title', 'type' => 'child'],\n];\n</code></pre>\n<ul>\n<li><code>$arr</code> – array to sort</li>\n<li><code>$newArr</code> – expected result</li>\n</ul>\n<p>The top-level elements have <code>parentId = 0</code>, followed by their children that share the same <code>parentId</code> matching the parent <code>id</code>, and so on. There can be any number of levels. If several elements share the same <code>parentId</code>, then <code>child</code> comes first, then the most recent <code>block</code> and its children underneath (if any).</p>\n<p>I tried building a new array based on <code>parentId</code>, but I lost the correct order. How can I sort this properly in PHP?</p>",
  "Title: libcublas.so.*[0-9] not found in the system path\nBody: <p>I'm trying to use a CUDA-backed PHP library in my Laravel project. I use Composer as my dependency manager, installed the package with Composer, and when I autoload it I get this error:</p>\n<pre><code>libcublas.so.*[0-9] not found in the system path [my project and vendor paths]\n</code></pre>\n<p>How can I solve that?</p>",
  "Title: Symfony returns “TemplateNotFound” when using Bootstrap 4 form theme\nBody: <p>Using Symfony Forms with the Bootstrap 4 theme, I only get a <code>TemplateNotFoundException</code> whenever I try to render a form.</p>\n<p>I’m new to Symfony forms and followed the official docs for enabling the Bootstrap 4 theme. As far as I know the installation is correct (installed with <code>composer</code> and configured in <code>config/packages/twig.yaml</code>). I’m running this in a local Windows environment.</p>\n<p>I created a new project with minimal content and the same problem persists. The project is called <code>stuff</code> and the single bundle is the default <code>App</code> namespace.</p>\n<p><strong>config/packages/twig.yaml</strong></p>\n<pre><code>twig:\n    default_path: '%kernel.project_dir%/templates'\n    form_themes:\n        - 'bootstrap_4_layout.html.twig'\n</code></pre>\n<p><strong>src/Entity/Mine.php</strong></p>\n<pre><code>namespace App\\Entity;\n\nuse Symfony\\Component\\Validator\\Constraints as Assert;\n\nclass Mine\n{\n    #[Assert\\NotBlank]\n    private ?string $name = null;\n\n    #[Assert\\Email]\n    private ?string $email = null;\n\n    public function getName(): ?string { return $this-&gt;name; }\n    public function setName(?string $name): self { $this-&gt;name = $name; return $this; }\n\n    public function getEmail(): ?string { return $this-&gt;email; }\n    public function setEmail(?string $email): self { $this-&gt;email = $email; return $this; }\n}\n</code></pre>\n<p><strong>src/Form/MineType.php</strong></p>\n<pre><code>namespace App\\Form;\n\nuse App\\Entity\\Mine;\nuse Symfony\\Component\\Form\\AbstractType;\nuse Symfony\\Component\\Form\\Extension\\Core\\Type\\EmailType;\nuse Symfony\\Component\\Form\\Extension\\Core\\Type\\TextType;\nuse Symfony\\Component\\Form\\FormBuilderInterface;\n\nclass MineType extends AbstractType\n{\n    public function buildForm(FormBuilderInterface $builder, array $options): void\n    {\n        $builder\n            -&gt;add('name', TextType::class)\n            -&gt;add('email', EmailType::class);\n    }\n}\n</code></pre>\n<p><strong>src/Controller/DefaultController.php</strong></p>\n<pre><code>namespace App\\Controller;\n\nuse App\\Entity\\Mine;\nuse App\\Form\\MineType;\nuse Symfony\\Bundle\\FrameworkBundle\\Controller\\AbstractController;\nuse Symfony\\Component\\HttpFoundation\\Response;\nuse Symfony\\Component\\Routing\\Annotation\\Route;\n\nclass DefaultController extends AbstractController\n{\n    #[Route('/', name: 'home')]\n    public function index(): Response\n    {\n        $form = $this-&gt;createForm(MineType::class, new Mine());\n\n        return $this-&gt;render('test.html.twig', [\n            'form' =&gt; $form-&gt;createView(),\n        ]);\n    }\n}\n</code></pre>\n<p><strong>templates/test.html.twig</strong></p>\n<pre><code>{% form_theme form 'bootstrap_4_layout.html.twig' %}\n&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n    &lt;title&gt;TestThing&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    {{ form_start(form) }}\n        {{ form_widget(form) }}\n    {{ form_end(form) }}\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n<p><strong>composer show</strong></p>\n<pre><code>symfony/framework-bundle\nsymfony/twig-bundle\nsymfony/form\nsymfony/validator\nsymfony/asset\ntwig/twig\n</code></pre>\n<p><strong>Error on the debug page</strong></p>\n<pre><code>Unable to find template \"bootstrap_4_layout.html.twig\"\n</code></pre>\n<p><em><strong>Template-loader postmortem</strong></em></p>\n<pre><code>Template-loader postmortem\nSymfony tried loading these templates, in this order:\n\n- templates/bootstrap_4_layout.html.twig (not found)\n- vendor/symfony/twig-bridge/Resources/views/Form/bootstrap_4_layout.html.twig (not found)\n</code></pre>\n<p>It looks like Symfony can’t see the form theme templates. Or maybe I’m missing a package?</p>\n<p>I wanted to quickly tidy up a form before moving on, but hours later I still can’t get the Bootstrap 4 theme to work. What am I missing?</p>\n<p><strong>Other things I’ve tried</strong></p>\n<ul>\n<li>Using a different theme name in <code>form_themes</code> (this changes the error but still says it can’t find the template)</li>\n<li>Removing Bootstrap from my frontend assets (no difference)</li>\n<li>Creating an empty template file at the path shown (it just renders unstyled)</li>\n<li>Using <code>{{ form(form) }}</code> instead of <code>form_start/form_widget/form_end</code> (same result)</li>\n</ul>",
  "Title: How to fetch data server-side in the latest Laravel? Tried controller fetch but it’s not running and getting undefined.\n\nBody: <p>I am working on a Django Rest Framework with Laravel, and I am getting stuck with fetching data from the API. I have data in this url <code>http://127.0.0.1:8000/api/campaigns</code> and when I visit the url I see the data.</p>\n<p>The problem is when I fetch and dump the data with Laravel, I get <code>undefined</code>. Also when I try mapping the data in the view, I get the error:</p>\n<blockquote>\n<p>Unhandled Runtime Error</p>\n<p>Error: Cannot read properties of undefined (reading 'map')</p>\n</blockquote>\n<p>Here is my <code>IndexController.php</code> file where the data fetching is done:</p>\n<pre><code>&lt;?php\n\nnamespace App\\Http\\Controllers;\n\nuse Illuminate\\Support\\Facades\\Http;\n\nclass IndexController extends Controller\n{\n    public function index()\n    {\n        $response = Http::get('http://127.0.0.1:8000/api/campaigns');\n        $data = $response-&gt;json();\n\n        logger()-&gt;info($data);\n\n        return view('index', ['data' =&gt; $data]);\n    }\n}\n</code></pre>\n<p>Here is my Blade view where I try to render the data:</p>\n<pre><code>&lt;h1&gt;Available Campaigns&lt;/h1&gt;\n\n@foreach($data as $element)\n    &lt;div&gt;\n        &lt;div&gt;\n            &lt;img src=&quot;{{ $element['logo'] }}&quot; height=&quot;120&quot; width=&quot;100&quot; alt=&quot;image&quot; /&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n@endforeach\n</code></pre>\n<p>Here is a screenshot of the data I am getting when I visit the URL:</p>\n<p><a href=\"https://i.stack.imgur.com/4vU7y.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/4vU7y.png\" alt=\"Image\" /></a></p>\n<p>Here is the file structure for the Laravel app inside the front end:</p>\n<p><a href=\"https://i.stack.imgur.com/MnfjC.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/MnfjC.png\" alt=\"File Structure\" /></a></p>\n<p>Also, note that I am using the latest version of Laravel. Any help will be highly appreciated. Thanks.</p>",
  "Title: EasyAdmin showing a white box instead of the theme toggle icon  \nBody: As I open the EasyAdmin page, a wide white box appears instead of the theme icon (Symfony 6.3 / EasyAdmin 4).  \n\nScreenshot of production UI:  \n[screenshot omitted]  \n\nWhile testing in a Docker container, everything looks fine.  \n\nScreenshot from Docker:  \n[screenshot omitted]  \n\nI reviewed the documentation about overriding the base layout template, but I’m not sure that’s the issue.  \n\nAfter deployment on an EC cloud instance, the logs don’t show anything unusual.  \n\nNginx (1.23) serves my static assets. I ran:  \n```\nphp bin/console asset:install\n```  \n\nAll other static files work correctly across the site.  \n\nI inspected the element `<button class=\"theme-toggle\">` and didn’t see anything abnormal.  \n\nEverything looks normal to me, and production otherwise matches the Docker container.",
  "Title: How to safely and atomically decrement a counter with Laravel and PostgreSQL?\nBody: <p>I’ve been reading up on PostgreSQL transaction isolation and how that relates to Laravel’s <code>DB::transaction()</code> (e.g. <a href=\"https://www.postgresql.org/docs/15/transaction-iso.html\" rel=\"noreferrer\">PostgreSQL docs</a>), but I’m far from fluent in this topic and I’m not sure I understand what I’ve read.</p>\n<p>We’ve got a PostgreSQL-backed Laravel app that involves quota objects. Simplified, it’s just this:</p>\n<pre class=\"lang-php prettyprint-override\"><code>class Quota extends Model\n{\n    public function obj()\n    {\n        return $this-&gt;hasOne(AnotherModel::class);\n    }\n\n    protected $fillable = ['count'];\n}\n</code></pre>\n<p>An instance of this controls how many times a certain operation can be performed against the <code>obj</code> instance. <code>count</code> is initialized to a certain number, and will only ever decrement until it hits zero.</p>\n<p>Any number of processes/threads can concurrently perform these operations. Basically, we need to atomically decrement (with UPDATE) the <code>count</code> of a single database row without deadlocking and without two processes/threads ever e.g. starting with a <code>count</code> of 100 and both trying to decrement it to 99.</p>\n<p>My naive approach would be this:</p>\n<pre class=\"lang-php prettyprint-override\"><code>DB::transaction(function () use ($instance) {\n    DB::statement('SET TRANSACTION ISOLATION LEVEL SERIALIZABLE');\n    Quota::where('obj_id', $instance-&gt;id)-&gt;update([\n        'count' =&gt; DB::raw('count - 1'),\n    ]);\n});\n</code></pre>\n<p>However, I’m not sure if this is subject to this issue:</p>\n<blockquote>\n<p>if at COMMIT the database cannot determine that the transaction could have been performed serially with respect to the read/writes of other transactions, then it will fail with a database error. This can happen even if they updated different rows.</p>\n</blockquote>\n<p>All the processes/threads performing operations against the same <code>obj</code> would be decrementing the same column of the same row, so... maybe? I don’t actually know what’s involved in PostgreSQL “determin[ing] that the transaction could have been performed serially”.</p>\n<p>An alternate approach could be:</p>\n<pre class=\"lang-php prettyprint-override\"><code>DB::transaction(function () use ($instance) {\n    Quota::where('obj_id', $instance-&gt;id)\n        -&gt;lockForUpdate()\n        -&gt;update([\n            'count' =&gt; DB::raw('count - 1'),\n        ]);\n});\n</code></pre>\n<p>This seems to do row-level locking, and my understanding is that the isolation level change isn’t needed, but I don’t know if this is sufficient for correct handling of concurrent operations.</p>\n<p>Is one of these approaches preferable here, and are some modifications still necessary to guarantee atomicity and deadlock avoidance? We could use something like <code>symfony/lock</code> to also prevent concurrent DB operations at the Laravel controller level, but this feels like a more natural fit to do at the DB level.</p>",
  "Title: how to resolve guzzlehttp/psr7: Call to undefined function GuzzleHttp\\\\Psr7\\\\parse_header()\nBody: <p>My application was running fine till few days back, but now all of a sudden i'm seeing this error and not sure what it means, please help.</p>\n<p>Error:</p>\n<pre><code>Fatal error: Uncaught Error: Call to undefined function GuzzleHttp\\Psr7\\parse_header()\nin /myproj/vendor/myvendor/mypackage/src/Request.php on line 17\nStack trace:\n#0 /myproj/vendor/myvendor/mypackage/src/Router.php(22): MyVendor\\MyPackage\\Request->parseHeaders()\n#1 /myproj/routes/api.php(8): MyVendor\\MyPackage\\Router->registerRoutes()\n#2 {main}\n</code></pre>\n<p>my line 8 of routes/api.php is:</p>\n<pre><code>use MyVendor\\MyPackage\\Router;\n</code></pre>\n<p>and i could see the parse_header function in the guzzlehttp/psr7 functions.php file PFA</p>\n<p><a href=\"https://i.stack.imgur.com/c70Wy.png\" rel=\"noreferrer\">functions.php file</a></p>",
  "Title: Doctrine MongoDB ODM EmbeddedDocument validation error when field name differs from database key  \nBody: <p>I have a PHP app using <code>doctrine/mongodb-odm</code> with embedded documents. The documents look like this:</p>\n<pre><code>/**\n * @Document\n */\nclass Blog\n{\n    /** @Id */\n    private $id;\n\n    /** @Field(type=\"string\", name=\"Name\") */\n    private $name;\n\n    /** @Field(type=\"string\") */\n    private $tagline;\n}\n\n/**\n * @Document\n */\nclass Entry\n{\n    /** @Id */\n    private $id;\n\n    /** @EmbedOne(targetDocument=Blog::class) */\n    private $blog;\n}\n</code></pre>\n<p>When I run the app, I get a validation error indicating that the embedded document field name cannot differ from the database key.</p>\n<p>I need to keep the PHP property as <code>$name</code>, but the existing database uses <code>Name</code> (camelCase) and I can’t change it.</p>\n<p>How can I avoid this error and keep different property names and database field names for embedded documents?</p>",
  "Title: MySQL 8 or later is required (found 5.7.33) when running Laravel migrations  \nBody: <p>I get this error when running migrations for my project.</p>\n<p>I ran this command:</p>\n<pre><code>php artisan migrate\n</code></pre>\n<p><strong>But the error persists</strong></p>\n<pre><code>MySQL 8 or later is required (found 5.7.33).\n</code></pre>\n<p>Is there any way to run migrations anyway, or should I downgrade my PHP version?</p>\n<p><strong>PHP version</strong></p>\n<pre><code>PHP 8.1\n</code></pre>",
  "Title: Microservices architecture with Laravel.\nBody: <p>I have some questions about creating microservices with Laravel.</p>\n<p>Let's say we have an online shop or a larger system with many database requests and users. I want to practice and simulate a simple microservice to learn something new.</p>\n<p>We want to create a microservices-based system with the following components:</p>\n<ol>\n<li>A Laravel-based microservice with its admin panel and full functionality (excluding a dedicated REST layer).</li>\n<li>One or more microservices with a React/Angular frontend.</li>\n<li>Several additional microservices to separate functionalities.\nI'm unsure about the architecture. Let's assume we want to manage data using the Laravel admin panel.</li>\n</ol>\n<p>The simplest solution would be to add an API layer to the first microservice and extend its functionality (REST app) - instead of creating different services (3.).</p>\n<ol>\n<li>But what if we want to separate functionality into different microservices?</li>\n<li>Should the microservices in point 3 be connected to the same database and treated as different Laravel projects (with an API layer)?</li>\n<li>Can we use Go, FastAPI, or Java Spring for the third microservice? If yes, should all models be duplicated and registered in the first microservice?</li>\n<li>Alternatively, is there a better way to approach this?</li>\n</ol>\n<p>It would be great to hear your perspective and methods on how to proceed with this.</p>\n<p>Have a wonderful day!</p>",
  "Title: Laravel \"Detected change in ..., reloading\" Error in Docker.\nBody: <p>I'm having a problem which I don't understand, and therefore can't resolve.</p>\n<p>I have a Dockerized Laravel project, which I created using the Laravel installer months ago. Today, my development environment has started displaying the following error on every request:</p>\n<p><a href=\"https://i.stack.imgur.com/jq1A9.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/jq1A9.png\" alt=\"code of error\" /></a></p>\n<p>I am not currently having this issue in production. I tried rolling back to commits that worked properly before (1 week old commits, for example), and I'm still getting this error.</p>\n<p>The reloading is causing connections to the database to close and therefore my project isn't working properly at all.</p>\n<p>Does anyone know what causes this, and how I might fix it? It feels like an issue with my Docker setup, but that hasn't changed in months, so I don't understand why that would change now.</p>\n<p>Many Thanks for any help anyone can offer!</p>",
  "Title: libsodium/ext-sodium errors while building arm64 PHP images for PHP/Laravel.\nBody: <p>Summary:\nI am trying to build an ARM64 image for my project to be able to run it faster locally on my MacBook M1 (Pro), instead of using normal x64 images which run extremely slow (long startup time, long response time for local dev HTTP server, long test running times).</p>\n<p>I have the following Dockerfile:</p>\n<pre><code>FROM arm64v8/php:8.1-fpm\n\n# Install system dependencies\nRUN apt-get update &amp;&amp; apt-get install -y \\\n    git \\\n    curl \\\n    libpq-dev \\\n    build-essential \\\n    libssl-dev \\\n    libffi-dev \\\n    libsodium-dev \\\n    unzip\n\n# Install PHP extensions\nRUN docker-php-ext-install pdo pdo_pgsql\nRUN docker-php-ext-install sodium\n\n# Install Composer\nRUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer\n\n# Set the working directory in the container\nWORKDIR /app\n\n# Copy composer files\nCOPY composer.json composer.lock ./\n\n# Install PHP dependencies\nRUN composer install --no-interaction --prefer-dist\n\n# Copy the PHP project files to the container\nCOPY . .\n\n# Expose the PHP-FPM port\nEXPOSE 9000\n\n# Start PHP-FPM\nCMD [\"php-fpm\"]\n</code></pre>\n<p><code>composer.json</code>:</p>\n<pre><code>{\n  \"require\": {\n    \"php\": \"^8.1\",\n    \"ext-sodium\": \"*\",\n    \"laravel/framework\": \"^8.83\",\n    \"guzzlehttp/guzzle\": \"^7.5\",\n    \"predis/predis\": \"^2.0\",\n    \"firebase/php-jwt\": \"^6.4\",\n    \"ramsey/uuid\": \"^4.4\",\n    \"monolog/monolog\": \"^2.9\"\n  }\n}\n</code></pre>\n<p>Traceback:\n<code>https://pastebin.com/1xtwdfXY</code> (too long to paste here)</p>\n<p>I have already tried everything you can find online, including:</p>\n<ul>\n<li>Installing libsodium via apt instead of via Composer</li>\n<li>Enabling the sodium extension explicitly with <code>docker-php-ext-install sodium</code></li>\n<li>Installing libsodium locally on the host machine (macOS) via <code>brew install libsodium</code></li>\n</ul>\n<p>Sources:</p>\n<ul>\n<li><code>https://github.com/jedisct1/libsodium/issues/721</code></li>\n<li><code>https://github.com/jedisct1/libsodium/issues/1302</code></li>\n<li><code>https://stackoverflow.com/questions/65517524/pynacl-building-problems</code></li>\n</ul>",
  "Title: Laravel Spatie Permission - Class 'Spatie\\\\Permission\\\\Middlewares\\\\RoleMiddleware' not found even when spatie/laravel-permission is properly installed.\n\nBody: <p>\"Class 'Spatie\\\\Permission\\\\Middlewares\\\\RoleMiddleware' not found\"</p>\n<p>I keep getting this error in my Laravel project even when spatie/laravel-permission is installed and configured???</p>\n<p>I tried reinstalling, dumping autoload, and switching to PHP 8 but nothing changed. All other imports work except the MIDDLEWARE one...</p>\n<p>Help pls?</p>\n<p>app/Http/Kernel.php:</p>\n<pre><code>&lt;?php\n\nnamespace App\\Http;\n\nuse Illuminate\\Foundation\\Http\\Kernel as HttpKernel;\n\nclass Kernel extends HttpKernel\n{\n    protected $middleware = [\n        \\Illuminate\\Foundation\\Http\\Middleware\\CheckForMaintenanceMode::class,\n        \\Illuminate\\Http\\Middleware\\ValidatePostSize::class,\n        \\App\\Http\\Middleware\\TrimStrings::class,\n        \\Illuminate\\Foundation\\Http\\Middleware\\ConvertEmptyStringsToNull::class,\n    ];\n\n    protected $middlewareGroups = [\n        'web' =&gt; [\n            \\App\\Http\\Middleware\\EncryptCookies::class,\n            \\Illuminate\\Cookie\\Middleware\\AddQueuedCookiesToResponse::class,\n            \\Illuminate\\Session\\Middleware\\StartSession::class,\n            \\Illuminate\\View\\Middleware\\ShareErrorsFromSession::class,\n            \\App\\Http\\Middleware\\VerifyCsrfToken::class,\n            \\Illuminate\\Routing\\Middleware\\SubstituteBindings::class,\n        ],\n\n        'api' =&gt; [\n            \\Illuminate\\Routing\\Middleware\\ThrottleRequests::class.':api',\n            \\Illuminate\\Routing\\Middleware\\SubstituteBindings::class,\n        ],\n    ];\n\n    protected $routeMiddleware = [\n        'auth' =&gt; \\App\\Http\\Middleware\\Authenticate::class,\n        'verified' =&gt; \\Illuminate\\Auth\\Middleware\\EnsureEmailIsVerified::class,\n\n        // Downloaded Middleware\n        'role' =&gt; \\Spatie\\Permission\\Middlewares\\RoleMiddleware::class,\n        'permission' =&gt; \\Spatie\\Permission\\Middlewares\\PermissionMiddleware::class,\n        'role_or_permission' =&gt; \\Spatie\\Permission\\Middlewares\\RoleOrPermissionMiddleware::class,\n    ];\n}\n</code></pre>\n<p>Tried composer require spatie/laravel-permission again, composer dump-autoload, other Stack Overflow solutions, and the package docs… nothing worked until now.</p>\n<p>Update: removed links because of spam filter</p>\n<p>Error location:</p>\n<pre><code>protected $routeMiddleware = [\n    'auth' =&gt; \\App\\Http\\Middleware\\Authenticate::class,\n\n    // Downloaded Middleware\n    'role' =&gt; \\Spatie\\Permission\\Middlewares\\RoleMiddleware::class,\n];\n</code></pre>",
  "Title: Laravel 10, \"Call to a member function on null\" when adding a child page.\nBody: <p>I am trying to integrate a simple CMS-like pages section into an existing Laravel project, but I am getting the above error when I add a child page.</p>\n<p>In my config/app.php I have the usual providers (no custom service providers yet):</p>\n<pre><code>'providers' =&gt; [\n    Illuminate\\Auth\\AuthServiceProvider::class,\n    Illuminate\\Broadcasting\\BroadcastServiceProvider::class,\n    Illuminate\\Bus\\BusServiceProvider::class,\n    Illuminate\\Cache\\CacheServiceProvider::class,\n    Illuminate\\Foundation\\Providers\\FoundationServiceProvider::class,\n    Illuminate\\Hashing\\HashServiceProvider::class,\n    Illuminate\\Mail\\MailServiceProvider::class,\n    Illuminate\\Notifications\\NotificationServiceProvider::class,\n    Illuminate\\Pagination\\PaginationServiceProvider::class,\n    Illuminate\\Pipeline\\PipelineServiceProvider::class,\n    Illuminate\\Queue\\QueueServiceProvider::class,\n    Illuminate\\Redis\\RedisServiceProvider::class,\n    Illuminate\\Auth\\Passwords\\PasswordResetServiceProvider::class,\n    Illuminate\\Session\\SessionServiceProvider::class,\n    Illuminate\\Translation\\TranslationServiceProvider::class,\n    Illuminate\\Validation\\ValidationServiceProvider::class,\n    Illuminate\\View\\ViewServiceProvider::class,\n]\n</code></pre>\n<p>My middleware in app/Http/Kernel.php:</p>\n<pre><code>protected $middleware = [\n    \\Illuminate\\Foundation\\Http\\Middleware\\CheckForMaintenanceMode::class,\n    \\Illuminate\\Foundation\\Http\\Middleware\\ValidatePostSize::class,\n    \\Illuminate\\Foundation\\Http\\Middleware\\TrimStrings::class,\n    \\Illuminate\\Foundation\\Http\\Middleware\\ConvertEmptyStringsToNull::class,\n];\n\nprotected $middlewareGroups = [\n    'web' =&gt; [\n        \\App\\Http\\Middleware\\EncryptCookies::class,\n        \\Illuminate\\Cookie\\Middleware\\AddQueuedCookiesToResponse::class,\n        \\Illuminate\\Session\\Middleware\\StartSession::class,\n        \\Illuminate\\View\\Middleware\\ShareErrorsFromSession::class,\n        \\App\\Http\\Middleware\\VerifyCsrfToken::class,\n        \\Illuminate\\Routing\\Middleware\\SubstituteBindings::class,\n    ],\n];\n</code></pre>\n<p>My routes/web.php:</p>\n<pre><code>use App\\Http\\Controllers\\PageController;\n\nRoute::get('/', [PageController::class, 'home']);\nRoute::get('/news', [PageController::class, 'newsIndex']);\n\nRoute::prefix('admin')->group(function () {\n    Route::get('/pages', [PageController::class, 'index']);\n    Route::get('/pages/{parent}/create', [PageController::class, 'createChild']);\n    Route::post('/pages/{parent}', [PageController::class, 'storeChild']);\n});\n\nRoute::get('/news/{page}', [PageController::class, 'show'])->name('news.show');\n</code></pre>\n<p>My controller:</p>\n<pre><code>namespace App\\Http\\Controllers;\n\nuse App\\Models\\Page;\nuse Illuminate\\Http\\Request;\n\nclass PageController extends Controller\n{\n    public function storeChild(Request $request, $parent)\n    {\n        $parentPage = Page::find($parent);\n\n        $page = new Page();\n        $page-&gt;title = $request-&gt;input('title');\n        $page-&gt;body = $request-&gt;input('body');\n\n        $parentPage-&gt;children()-&gt;save($page);\n\n        return redirect('/admin/pages');\n    }\n\n    public function show(Page $page)\n    {\n        return view('pages.show', ['page' =&gt; $page]);\n    }\n}\n</code></pre>\n<p>My model:</p>\n<pre><code>namespace App\\Models;\n\nuse Illuminate\\Database\\Eloquent\\Model;\n\nclass Page extends Model\n{\n    protected $fillable = ['title', 'body', 'parent_id'];\n\n    public function parent()\n    {\n        return $this-&gt;belongsTo(Page::class, 'parent_id');\n    }\n\n    public function children()\n    {\n        return $this-&gt;hasMany(Page::class, 'parent_id');\n    }\n}\n</code></pre>\n<p>My Blade template:</p>\n<pre><code>@extends('layouts.app')\n\n@section('content')\n    &lt;h1&gt;{{ $page-&gt;title }}&lt;/h1&gt;\n    {!! $page-&gt;body !!}\n@endsection\n</code></pre>\n<p>I have created the root page and confirmed routes are correct, migrated the database, but I still get the same error when I try to add a child page in the admin. Here is the stack trace:</p>\n<p>Environment:</p>\n<p>Request Method: POST\nRequest URL: http://127.0.0.1:8000/admin/pages/2</p>\n<pre><code>PHP Version: 8.2\nLaravel Version: 10.x\n\nError: Call to a member function on null\n\n#0 app/Http/Controllers/PageController.php(23): PageController-&gt;storeChild()\n#1 vendor/laravel/framework/src/Illuminate/Routing/Controller.php(54): call_user_func_array()\n#2 vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher.php(43): ControllerDispatcher-&gt;dispatch()\n#3 vendor/laravel/framework/src/Illuminate/Routing/Route.php(260): Route-&gt;runController()\n#4 vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Route-&gt;run()\n</code></pre>\n<p>What am I missing that causes this error when adding a child page?</p>",
  "Title: Laravel Passport refresh token is empty when login\nBody: <p>I’m having trouble with Laravel Passport. When I register a new account it returns both access token and refresh token in the response, but when I log in with credentials I only get the access token and the refresh token is completely empty. I configured everything as described in the docs and the tutorial I’m following. Any idea what’s wrong?</p>\n<p>UPDATE: I found that the refresh token is set in the response header, but I can’t figure out why it’s not in the response body and shows up empty.</p>\n<p>config/auth.php</p>\n<pre><code>return [\n    'guards' =&gt; [\n        'api' =&gt; [\n            'driver' =&gt; 'passport',\n            'provider' =&gt; 'users',\n        ],\n    ],\n];\n</code></pre>\n<p>config/passport.php</p>\n<pre><code>return [\n    'tokens_can' =&gt; [\n        // ...\n    ],\n    'implicit_grant' =&gt; false,\n    'personal_access_client' =&gt; [\n        'id' =&gt; env('PASSPORT_PERSONAL_ACCESS_CLIENT_ID'),\n        'secret' =&gt; env('PASSPORT_PERSONAL_ACCESS_CLIENT_SECRET'),\n    ],\n];\n</code></pre>\n<p>Response:</p>\n<pre><code>{\n    \"access_token\": \"eyJhbGciOiJ.....\",\n    \"refresh_token\": \"\",\n    \"user\": {\n        \"id\": 2,\n        \"name\": \"test_user_0\",\n        \"email\": \"test0@mysite.co\"\n    }\n}\n</code></pre>",
  "Title: \"Composer: ext-pgsql missing on Windows in a project PHP environment when installing doctrine/dbal\"\n\nBody: <p>Composer version: 2.6.5</p>\n<p>PHP version: 8.1.11</p>\n<p>OS: Windows 11</p>\n<p>My PHP project is using a project-specific PHP environment. Installing a PostgreSQL client library fails.\nComposer reports that the <code>ext-pgsql</code> extension is missing. I haven’t found a solution for my setup even though there are solutions for other platforms.</p>\n<p><code>composer require doctrine/dbal</code> also does not work.</p>\n<p>The full error is below:</p>\n<pre><code>\nC:\\Aavash files\\COMP206\\Project\\Movie4AllMoods> composer require doctrine/dbal\n./composer.json has been updated\nRunning composer update doctrine/dbal\nLoading composer repositories with package information\nUpdating dependencies\nYour requirements could not be resolved to an installable set of packages.\n\n  Problem 1\n    - doctrine/dbal is locked to version 3.7.0 and an update of this package was not requested.\n    - doctrine/dbal 3.7.0 requires ext-pgsql * -> it is missing from your system. Install or enable PHP's pgsql extension.\n  Problem 2\n    - doctrine/dbal 3.7.0 requires ext-pgsql * -> it is missing from your system. Install or enable PHP's pgsql extension.\n</code></pre>\n<p>I tried updating Composer and reinstalling PHP but that didn’t help. It works globally, but fails in this project-specific environment. I’ve tried everything but nothing seems to work.</p>",
  "Title: How does a Symfony Messenger worker run the code defined elsewhere in a handler?\nBody: <p>I tried reading official documentation as well as other SO threads, but it is still not clear how Symfony Messenger works.</p>\n<p>From what I understand:</p>\n<ol>\n<li><strong>Symfony app</strong>: Messenger is installed in a Symfony app where a message handler class defines the work to be performed.</li>\n<li><strong>Message transport</strong>: A transport (like RabbitMQ or Redis) gets the message from 1. and queues it.</li>\n<li><strong>Worker</strong>: A completely separate Messenger worker (e.g., <code>messenger:consume</code>) picks up the message and runs it. This worker can be in a completely different machine even, so long as it has access to the transport.</li>\n</ol>\n<p>So, then the burning question is:</p>\n<p><strong>How does the worker get the code defined in the message handler to run the job?</strong></p>\n<p>Basically, how does 3. get what's defined in 1. if they are only connected using a transport? Is the PHP code stored in the transport as a string? What is the data structure of the queued message?</p>",
  "Title: Dokku: how to change heroku stack to heroku-20 or heroku-22 (from heroku-18)\nBody: <p>I have been working on a PHP project using Dokku (thus Heroku) for deployments. Up until today, all deployments worked just fine, but since this morning, I get this error message:</p>\n<p><em>Requested runtime 'php-8.2.12' is not available for this stack (heroku-18).</em></p>\n<p>I know that php-8.2.12 is available on heroku-18 so I assume I (finally) have to change stack since heroku-18 is deprecated.</p>\n<p>I have tried using this command on Dokku:</p>\n<p>dokku buildpacks:add --index 1 {APP-NAME} <a href=\"https://github.com/heroku/heroku-buildpack-php.git\" rel=\"nofollow noreferrer\">https://github.com/heroku/heroku-buildpack-php.git</a>,</p>\n<p>but it doesn't solve my problem (heroku-18 is still being used).</p>\n<p>Any help would be greatly appreciated</p>",
  "Title: How to use the OpenAI stream=true property with a Laravel/Symfony StreamedResponse, and still save the content returned?\n\nBody: <p>I'm trying to use the <code>stream=true</code> property with the OpenAI PHP client as follows.</p> ([platform.openai.com](https://platform.openai.com/docs/guides/streaming-responses?utm_source=openai))\n<pre><code>$client = OpenAI::client(getenv('OPENAI_API_KEY'));\n\n$stream = $client->completions()->create([\n    'model' => 'text-davinci-003',\n    'prompt' => 'Write me a story about dogs.',\n    'temperature' => 0.7,\n    'max_tokens' => MAX_TOKENS,\n    'frequency_penalty' => 1.0,\n    'presence_penalty' => 1.0,\n    'stream' => true,\n]);\n</code></pre>\n<p>Unfortunately, I don't know what to do from here to return it to my React frontend. Typically, I've used standard response objects, setting a status and JSON data. From what I’ve read, it seems I need to use Symfony’s <code>StreamedResponse</code> (or Laravel’s response()->stream()) to return a streaming response, but I'm not sure how to integrate that with the iterator/stream object from <code>$stream</code>, and still persist the final output once streaming is complete. How do I stream the chunks to the client and also save the full generated text after the stream finishes?</p>",
  "Title: Too many db connections (PHP / async server)\n\nBody: <p>I have deployed a PHP app behind an async server (RoadRunner) and I’m getting a lot of <code>FATAL: sorry, too many clients already</code> from PostgreSQL.</p>\n<p>I’ve seen people mention that long‑running PHP workers can leak or hold connections, but I can’t find a concrete fix so far.</p>\n<p>Is there a recommended way to deal with this, or should I switch back to traditional PHP‑FPM (or avoid async workers)?</p>\n<p>It seems like a blocking issue for using async PHP altogether. Shouldn’t it be better documented (unless I missed it)?</p>",
  "Title: How can a child validator access a parent field value when validating a nested array with many items in Laravel?\n\nBody: <p>If I validate a parent payload as an array of items, how can a child validator access the parent’s <code>batch_key</code> for the current item?</p>\n<pre><code class=\"language-php\">&lt;?php\n\nuse Illuminate\\Http\\Request;\nuse Illuminate\\Support\\Facades\\Validator;\n\nclass MyController extends Controller\n{\n    public function store(Request $request)\n    {\n        $data = $request-&gt;all();\n\n        $validator = Validator::make($data, [\n            '*.batch_key' =&gt; 'required|string',\n            '*.child' =&gt; 'required|array',\n            '*.child.*.field1' =&gt; ['required', 'string', function ($attribute, $value, $fail) use ($data) {\n                // How do I get the parent batch_key for this child item and compare it to field1?\n                // Example: if batch_key != field1 then fail\n            }],\n        ]);\n\n        $validator-&gt;validate();\n    }\n}\n</code></pre>\n<p>Request data:</p>\n<pre><code>[\n   {\n      \"batch_key\":\"batch_key_value_1\",\n      \"child\":[\n         {\"field1\":\"value1\"},\n         {\"field1\":\"value2\"},\n         {\"field1\":\"value3\"}\n      ]\n   },\n   {\n      \"batch_key\":\"batch_key_value_2\",\n      \"child\":[\n         {\"field1\":\"value4\"},\n         {\"field1\":\"value5\"},\n         {\"field1\":\"value6\"}\n      ]\n   }\n]\n</code></pre>",
  "Title: Error \"Call to undefined method DataFrame::append()\"\nBody: <p>I am trying to append an associative array to a DataFrame object in PHP, but I get this error:</p>\n<blockquote>\n<p>Call to undefined method DataFrame::append()</p>\n</blockquote>\n<p>I thought DataFrame had an <code>append</code> method.</p>\n<p>Code snippet:</p>\n<pre class=\"lang-php prettyprint-override\"><code>$df = (new DataFrame($df))->append($newRow, true);\n</code></pre>\n<p>I was expecting the associative array <code>$newRow</code> to be added as a new row.</p>\n<p>How can I fix it?</p>",
  "Title: Doctrine DBAL 3: Call to undefined method Connection::execute() when running a SELECT for time‑series data\nBody: <p>First of all, I'm totally new to the dev world. I'm taking AI / Data Science courses and I need to use a SQL database to make predictions, then use those predictions in PowerBI. I'm stuck with my PHP code and I don't know where the problem is.</p>\n<pre class=\"lang-php prettyprint-override\"><code>&lt;?php\nrequire __DIR__ . '/vendor/autoload.php';\n\nuse Doctrine\\DBAL\\DriverManager;\n\n$conn = DriverManager::getConnection([\n    'dbname' =&gt; 'data',\n    'user' =&gt; 'root',\n    'password' =&gt; 'Password',\n    'host' =&gt; 'localhost',\n    'driver' =&gt; 'pdo_mysql',\n]);\n\n$sql = \"SELECT Cle_Produit, Date_Facturation, SUM(Quantite) AS Total_Quantite\n        FROM ventes\n        GROUP BY Cle_Produit, Date_Facturation\";\n\n$result = $conn-&gt;execute($sql);\n$rows = $result-&gt;fetchAllAssociative();\n\n// Later I pivot the data by Date_Facturation and Cle_Produit,\n// run a forecasting step, then write a CSV.\n</code></pre>\n<p>It returns this message:</p>\n<blockquote>\n<p>Fatal error: Uncaught Error: Call to undefined method Doctrine\\DBAL\\Connection::execute() in C:\\...\\app.php on line 19</p>\n</blockquote>\n<p>Please, can somebody help me?</p>\n<p>I want this script to create a CSV file with the forecast. I want the forecasting step to use the table <code>ventes</code> from the database <code>data</code>, and it should use the columns <code>Cle_Produit</code>, <code>Quantite</code> and <code>Date_Facturation</code>.</p>",
  "Title: Class not found after unserializing a DataFrame in PHP\nBody: <p>I used a PHP workflow to load a serialized DataFrame from an artifact store. It unserializes successfully, but when I try to view its index, I get a <code>Class not found</code> error. Why?</p>\n<p>I’ve seen other answers saying this can happen when you unserialize a DataFrame created with an older version of the library. However, my error is slightly different, and updating the package with Composer (<code>composer update</code>) doesn’t fix it.</p>",
  "Title: 'Spreadsheet' object has no method 'save'\nBody: <p>I was trying the following code that I found.</p>\n<pre><code>&lt;?php\nrequire 'vendor/autoload.php';\n\nuse PhpOffice\\PhpSpreadsheet\\Spreadsheet;\nuse PhpOffice\\PhpSpreadsheet\\Chart\\Chart;\nuse PhpOffice\\PhpSpreadsheet\\Chart\\Legend;\nuse PhpOffice\\PhpSpreadsheet\\Chart\\Title;\nuse PhpOffice\\PhpSpreadsheet\\Chart\\PlotArea;\nuse PhpOffice\\PhpSpreadsheet\\Chart\\DataSeries;\nuse PhpOffice\\PhpSpreadsheet\\Chart\\DataSeriesValues;\n\n$data = [\n    ['Name', 'Age', 'Gender'],\n    ['John', 25, 'M'],\n    ['Jane', 30, 'F'],\n    ['Adam', 35, 'M'],\n];\n\n$spreadsheet = new Spreadsheet();\n$sheet = $spreadsheet-&gt;getActiveSheet();\n$sheet-&gt;setTitle('Sheet1');\n$sheet-&gt;fromArray($data, null, 'A1');\n\n// Example: Adding a chart\n$series = new DataSeries(\n    DataSeries::TYPE_LINECHART,\n    null,\n    range(0, 0),\n    [],\n    [new DataSeriesValues(DataSeriesValues::DATASERIES_TYPE_STRING, 'Sheet1!$B$1', null, 1)],\n    [new DataSeriesValues(DataSeriesValues::DATASERIES_TYPE_NUMBER, 'Sheet1!$B$2:$B$4', null, 3)]\n);\n$plotArea = new PlotArea(null, [$series]);\n$legend = new Legend(Legend::POSITION_RIGHT, null, false);\n$title = new Title('Ages');\n$chart = new Chart('chart1', $title, $legend, $plotArea);\n$chart-&gt;setTopLeftPosition('D2');\n$chart-&gt;setBottomRightPosition('K15');\n$sheet-&gt;addChart($chart);\n\n$spreadsheet-&gt;save('output.xlsx');\n</code></pre>\n<p>But I get the following error:</p>\n<pre><code>Call to undefined method PhpOffice\\PhpSpreadsheet\\Spreadsheet::save()\n</code></pre>\n<p>Does anyone know how to solve it?\nThanks in advance!\nGiuseppe</p>\n<p>Trying to save data to an Excel file with PhpSpreadsheet</p>",
  "Title: Error: OptionEngine object has no attribute execute\n\nBody: <p>SQLAlchemy v2.0.0 works differently and they changed some of the API.</p>\n<p>After investigating I found a solution. My code was simply:</p>\n<pre><code>$settingsDf = $pdo-&gt;query($query)-&gt;fetchAll(PDO::FETCH_ASSOC);\n</code></pre>\n<p>The error was like the title, \"OptionEngine object has no attribute execute\".</p>\n<p>I will answer my own post below.</p>\n<p>I tried using various versions but didn’t like the idea of being locked to historic components.</p>",
  "Title: Databricks: Issue while creating a Spark DataFrame from a PHP array\n\nBody: <p>I have a PHP array of tabular data that I want to convert into a Spark DataFrame in Databricks. Usually this works, but all of a sudden I started getting the error below. The error mentions <code>iteritems</code> (which I know is related to pandas), but I’m not using Python directly. I tried switching the Databricks runtime and rerunning, but I still get the same error. What is the solution for this, and which runtime or configuration should I use so Spark can create the DataFrame?</p>\n<pre><code>&lt;?php\n$data = [\n    'i' =&gt; [1, 2, 3],\n    'j' =&gt; [1, 2, 3],\n];\n\n// pass $data to Spark to create a DataFrame\n</code></pre>\n<pre><code>error:-\nUserWarning: createDataFrame attempted Arrow optimization because 'spark.sql.execution.arrow.pyspark.enabled' is set to true; however, failed by the reason below:\n  'DataFrame' object has no attribute 'iteritems'\nAttempting non-optimization as 'spark.sql.execution.arrow.pyspark.fallback.enabled' is set to true.\n  warn(msg)\nAttributeError: 'DataFrame' object has no attribute 'iteritems'\n</code></pre>",
  "Title: Error: query string isn’t executable in PDO\nBody: <p>I have a problem with the following code:</p>\n<pre><code>&lt;?php\n$pdo = new PDO('sqlite::memory:');\n\n$pdo-&gt;exec('CREATE TABLE df (column1 INTEGER, column2 INTEGER)');\n$pdo-&gt;exec('INSERT INTO df (column1, column2) VALUES (1, 4), (2, 5), (3, 6)');\n\n$query = \"SELECT * FROM df WHERE column1 &gt; 1\";\n\n$stmt = $pdo-&gt;prepare($query);\n$stmt-&gt;execute();\n\n$newDataframe = $stmt-&gt;fetchAll(PDO::FETCH_ASSOC);\n\nprint_r($newDataframe);\n</code></pre>\n<p>When I run it, I get an error indicating the query string can’t be executed. I’m on the latest PHP version and using PDO with SQLite. Could someone help me please?</p>",
  "Title: Array to SQL table throws error TypeError: __construct() got multiple values for argument 'schema'.\nBody: I have a dataset in PHP as an array of associative arrays called `$purchaseRows`. I want to load it into a SQL table so I can run SQL queries with Doctrine DBAL. I tried this:\n\n```php\nuse Doctrine\\DBAL\\DriverManager;\nuse Doctrine\\DBAL\\Schema\\Schema;\n\n$connection = DriverManager::getConnection($params);\n\n$schema = new Schema();\n$table = $schema->createTable('purchase_df');\n$table->addColumn('id', 'integer');\n$table->setPrimaryKey(['id']);\n\n$platform = $connection->getDatabasePlatform();\nforeach ($schema->toSql($platform) as $sql) {\n    $connection->executeStatement($sql);\n}\n\nforeach ($purchaseRows as $row) {\n    $connection->insert('purchase_df', $row);\n}\n```\n\nIt throws:\n\n```\nTypeError: __construct() got multiple values for argument 'schema'\n```\n\nI need to run queries like:\n\n```php\n$connection->executeQuery(\"SELECT * FROM purchase_df WHERE condition\");\n```\n\nOn the server I only have `doctrine/dbal` installed (no ORM). This code works locally in my IDE but fails in our hosted environment. A week ago it was working there too. Help me fix this.\n\nNote: PHP version 8.1\nPackage: doctrine/dbal\nVersion: 3.0.0",
  "Title: Different behavior when casting DateTime values to string with map and type casting in PHP\nBody: <p>I’m working with datetime values in PHP and want to convert a column of <code>DateTime</code> objects to strings. I expected two approaches to produce the same output, but they don’t.</p>\n<p>Here’s a minimal example.</p>\n<pre><code class=\"language-php\">&lt;?php\n\n// Create an array of dates according to ISO8601\n$rows = [\n    ['dt_column' =&gt; '2023-01-01'],\n    ['dt_column' =&gt; '2023-01-02'],\n    ['dt_column' =&gt; '2023-01-02'],\n];\n\n// Convert the strings to DateTime objects\n// (I expect the time portion to be 00:00:00)\nforeach ($rows as $i =&gt; $row) {\n    $rows[$i]['dt_column'] = new DateTime($row['dt_column']);\n}\n\n// Convert DateTime to string using casting\nforeach ($rows as $i =&gt; $row) {\n    $rows[$i]['str_from_cast'] = (string) $row['dt_column'];\n}\n\n// Convert DateTime to string using map with format\nforeach ($rows as $i =&gt; $row) {\n    $rows[$i]['str_from_map'] = $row['dt_column']-&gt;format('Y-m-d H:i:s');\n}\n\nprint_r($rows);\n</code></pre>\n<p><strong>Output</strong></p>\n<pre><code>Array\n(\n    [0] =&gt; Array\n        (\n            [dt_column] =&gt; DateTime Object (...)\n            [str_from_cast] =&gt; 2023-01-01\n            [str_from_map] =&gt; 2023-01-01 00:00:00\n        )\n\n    [1] =&gt; Array\n        (\n            [dt_column] =&gt; DateTime Object (...)\n            [str_from_cast] =&gt; 2023-01-02\n            [str_from_map] =&gt; 2023-01-02 00:00:00\n        )\n\n    [2] =&gt; Array\n        (\n            [dt_column] =&gt; DateTime Object (...)\n            [str_from_cast] =&gt; 2023-01-02\n            [str_from_map] =&gt; 2023-01-02 00:00:00\n        )\n)\n</code></pre>\n<p>When I cast the <code>DateTime</code> object to string, the time portion is missing, but when I format it explicitly the time is preserved.</p>\n<p>Why does this happen?</p>\n<p>(PHP 8.x)</p>",
  "Title: Improving performance for a nested for loop iterating over dates.\nBody: <p>I am looking to learn how to improve the performance of code over a large dataset (10 million rows) and my solution loops over multiple dates <code>(2023-01-10, 2023-01-20, 2023-01-30)</code> for different combinations of <code>category_a</code> and <code>category_b</code>.</p>\n<p>The working approach is shown below, which iterates over the dates for different pairings of the two-category data by first locating a subset of a particular pair. However, I would want to refactor it to see if there is an approach that is more efficient.</p>\n<p>My input (<code>$df</code>) looks like:</p>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th style=\"text-align: right;\"></th>\n<th style=\"text-align: left;\">date</th>\n<th style=\"text-align: right;\">category_a</th>\n<th style=\"text-align: right;\">category_b</th>\n<th style=\"text-align: right;\">outflow</th>\n<th style=\"text-align: right;\">open</th>\n<th style=\"text-align: right;\">inflow</th>\n<th style=\"text-align: right;\">max</th>\n<th style=\"text-align: right;\">close</th>\n<th style=\"text-align: right;\">buy</th>\n<th style=\"text-align: left;\">random_str</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: left;\">2023-01-10</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">10</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: left;\">a</td>\n</tr>\n<tr>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: left;\">2023-01-20</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">nan</td>\n<td style=\"text-align: right;\">nan</td>\n<td style=\"text-align: left;\">a</td>\n</tr>\n<tr>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: left;\">2023-01-30</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: right;\">10</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">nan</td>\n<td style=\"text-align: right;\">nan</td>\n<td style=\"text-align: left;\">a</td>\n</tr>\n<tr>\n<td style=\"text-align: right;\">3</td>\n<td style=\"text-align: left;\">2023-01-10</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">10</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: left;\">b</td>\n</tr>\n<tr>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: left;\">2023-01-20</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">nan</td>\n<td style=\"text-align: right;\">nan</td>\n<td style=\"text-align: left;\">b</td>\n</tr>\n<tr>\n<td style=\"text-align: right;\">5</td>\n<td style=\"text-align: left;\">2023-01-30</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">nan</td>\n<td style=\"text-align: right;\">nan</td>\n<td style=\"text-align: left;\">b</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>with 2 pairs <code>(4, 1)</code> and <code>(4,2)</code> over the days and my expected output (<code>$results</code>) looks like this:</p>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th style=\"text-align: right;\"></th>\n<th style=\"text-align: left;\">date</th>\n<th style=\"text-align: right;\">category_a</th>\n<th style=\"text-align: right;\">category_b</th>\n<th style=\"text-align: right;\">outflow</th>\n<th style=\"text-align: right;\">open</th>\n<th style=\"text-align: right;\">inflow</th>\n<th style=\"text-align: right;\">max</th>\n<th style=\"text-align: right;\">close</th>\n<th style=\"text-align: right;\">buy</th>\n<th style=\"text-align: left;\">random_str</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: left;\">2023-01-10</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">10</td>\n<td style=\"text-align: right;\">-1</td>\n<td style=\"text-align: right;\">23</td>\n<td style=\"text-align: left;\">a</td>\n</tr>\n<tr>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: left;\">2023-01-20</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">-1</td>\n<td style=\"text-align: right;\">23</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">10</td>\n<td style=\"text-align: left;\">a</td>\n</tr>\n<tr>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: left;\">2023-01-30</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: right;\">1</td>\n<td style=\"text-align: right;\">10</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">10</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">nan</td>\n<td style=\"text-align: left;\">a</td>\n</tr>\n<tr>\n<td style=\"text-align: right;\">3</td>\n<td style=\"text-align: left;\">2023-01-10</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">10</td>\n<td style=\"text-align: right;\">-2</td>\n<td style=\"text-align: right;\">24</td>\n<td style=\"text-align: left;\">b</td>\n</tr>\n<tr>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: left;\">2023-01-20</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">-2</td>\n<td style=\"text-align: right;\">24</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: left;\">b</td>\n</tr>\n<tr>\n<td style=\"text-align: right;\">5</td>\n<td style=\"text-align: left;\">2023-01-30</td>\n<td style=\"text-align: right;\">4</td>\n<td style=\"text-align: right;\">2</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">0</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">20</td>\n<td style=\"text-align: right;\">nan</td>\n<td style=\"text-align: left;\">b</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>I have a working solution using PHP arrays to take a subset then loop over it to get a solution but I would like to see how I can improve the performance of this using perhaps <code>amphp/parallel</code>, <code>spatie/async</code>, generators, or moving the logic into SQL. Another great idea was to rewrite it in BigQuery SQL.</p>\n<p>I am not sure what the best solution would be and I would appreciate any help in improving the performance.</p>\n<p><em><strong>Minimum working example</strong></em></p>\n<p>The code below generates the input dataset.</p>\n<pre><code>&lt;?php\n\n// prepare the input data\n$df = [\n    ['date' =&gt; '2023-01-10', 'category_a' =&gt; 4, 'category_b' =&gt; 1, 'outflow' =&gt; 1.0, 'open' =&gt; 0.0, 'inflow' =&gt; 0.0, 'max' =&gt; 10.0, 'close' =&gt; 0.0, 'buy' =&gt; 0.0, 'random_str' =&gt; 'a'],\n    ['date' =&gt; '2023-01-20', 'category_a' =&gt; 4, 'category_b' =&gt; 1, 'outflow' =&gt; 2.0, 'open' =&gt; 0.0, 'inflow' =&gt; 0.0, 'max' =&gt; 20.0, 'close' =&gt; null, 'buy' =&gt; null, 'random_str' =&gt; 'a'],\n    ['date' =&gt; '2023-01-30', 'category_a' =&gt; 4, 'category_b' =&gt; 1, 'outflow' =&gt; 10.0, 'open' =&gt; 0.0, 'inflow' =&gt; 0.0, 'max' =&gt; 20.0, 'close' =&gt; null, 'buy' =&gt; null, 'random_str' =&gt; 'a'],\n    ['date' =&gt; '2023-01-10', 'category_a' =&gt; 4, 'category_b' =&gt; 2, 'outflow' =&gt; 2.0, 'open' =&gt; 0.0, 'inflow' =&gt; 0.0, 'max' =&gt; 10.0, 'close' =&gt; 0.0, 'buy' =&gt; 0.0, 'random_str' =&gt; 'b'],\n    ['date' =&gt; '2023-01-20', 'category_a' =&gt; 4, 'category_b' =&gt; 2, 'outflow' =&gt; 2.0, 'open' =&gt; 0.0, 'inflow' =&gt; 0.0, 'max' =&gt; 20.0, 'close' =&gt; null, 'buy' =&gt; null, 'random_str' =&gt; 'b'],\n    ['date' =&gt; '2023-01-30', 'category_a' =&gt; 4, 'category_b' =&gt; 2, 'outflow' =&gt; 0.0, 'open' =&gt; 0.0, 'inflow' =&gt; 0.0, 'max' =&gt; 20.0, 'close' =&gt; null, 'buy' =&gt; null, 'random_str' =&gt; 'b'],\n];\n\n// get unique pairs of category_a and category_b\n$uniquePairs = [];\nforeach ($df as $row) {\n    $key = $row['category_a'] . '-' . $row['category_b'];\n    $uniquePairs[$key] = ['category_a' =&gt; $row['category_a'], 'category_b' =&gt; $row['category_b']];\n}\n$uniquePairs = array_values($uniquePairs);\n\n// get unique dates sorted\n$uniqueDates = array_unique(array_column($df, 'date'));\nsort($uniqueDates);\n</code></pre>\n<p>Using this input dataset, the code below is what I am trying to optimize.</p>\n<pre><code>&lt;?php\n\n$day0 = $uniqueDates[0];\n\n// group rows by pair\n$grouped = [];\nforeach ($df as $row) {\n    $key = $row['category_a'] . '-' . $row['category_b'];\n    $grouped[$key][] = $row;\n}\n\n$results = [];\n\nforeach ($uniquePairs as $pair) {\n    $categoryA = $pair['category_a'];\n    $categoryB = $pair['category_b'];\n    $key = $categoryA . '-' . $categoryB;\n\n    $subset = $grouped[$key];\n\n    // index by date for faster updates\n    $byDate = [];\n    foreach ($subset as $row) {\n        $byDate[$row['date']] = $row;\n    }\n\n    // day 0\n    $byDate[$day0]['close'] = $byDate[$day0]['open'] + $byDate[$day0]['inflow'] - $byDate[$day0]['outflow'];\n\n    // loop over dates\n    for ($i = 1; $i &lt; count($uniqueDates); $i++) {\n        $date = $uniqueDates[$i];\n        $prevDate = $uniqueDates[$i - 1];\n\n        $byDate[$date]['open'] = $byDate[$prevDate]['close'];\n        $byDate[$date]['close'] = $byDate[$date]['open'] + $byDate[$date]['inflow'] - $byDate[$date]['outflow'];\n\n        if ($byDate[$date]['close'] &lt; $byDate[$date]['max']) {\n            $byDate[$prevDate]['buy'] = $byDate[$date]['max'] - $byDate[$date]['close'] + $byDate[$date]['inflow'];\n        } elseif ($byDate[$date]['close'] &gt; $byDate[$date]['max']) {\n            $byDate[$prevDate]['buy'] = 0;\n        } else {\n            $byDate[$prevDate]['buy'] = $byDate[$date]['inflow'];\n        }\n\n        $byDate[$date]['inflow'] = $byDate[$prevDate]['buy'];\n        $byDate[$date]['close'] = $byDate[$date]['open'] + $byDate[$date]['inflow'] - $byDate[$date]['outflow'];\n    }\n\n    foreach ($uniqueDates as $d) {\n        $results[] = $byDate[$d];\n    }\n}\n</code></pre>\n<p>After which we can check that the solution is the same as what we expected.</p>\n<pre><code>&lt;?php\n\n$expected = [\n    ['date' =&gt; '2023-01-10', 'category_a' =&gt; 4, 'category_b' =&gt; 1, 'outflow' =&gt; 1, 'open' =&gt; 0.0, 'inflow' =&gt; 0.0, 'max' =&gt; 10, 'close' =&gt; -1.0, 'buy' =&gt; 23.0, 'random_str' =&gt; 'a'],\n    ['date' =&gt; '2023-01-20', 'category_a' =&gt; 4, 'category_b' =&gt; 1, 'outflow' =&gt; 2, 'open' =&gt; -1.0, 'inflow' =&gt; 23.0, 'max' =&gt; 20, 'close' =&gt; 20.0, 'buy' =&gt; 10.0, 'random_str' =&gt; 'a'],\n    ['date' =&gt; '2023-01-30', 'category_a' =&gt; 4, 'category_b' =&gt; 1, 'outflow' =&gt; 10, 'open' =&gt; 20.0, 'inflow' =&gt; 10.0, 'max' =&gt; 20, 'close' =&gt; 20.0, 'buy' =&gt; null, 'random_str' =&gt; 'a'],\n    ['date' =&gt; '2023-01-10', 'category_a' =&gt; 4, 'category_b' =&gt; 2, 'outflow' =&gt; 2, 'open' =&gt; 0.0, 'inflow' =&gt; 0.0, 'max' =&gt; 10, 'close' =&gt; -2.0, 'buy' =&gt; 24.0, 'random_str' =&gt; 'b'],\n    ['date' =&gt; '2023-01-20', 'category_a' =&gt; 4, 'category_b' =&gt; 2, 'outflow' =&gt; 2, 'open' =&gt; -2.0, 'inflow' =&gt; 24.0, 'max' =&gt; 20, 'close' =&gt; 20.0, 'buy' =&gt; 0.0, 'random_str' =&gt; 'b'],\n    ['date' =&gt; '2023-01-30', 'category_a' =&gt; 4, 'category_b' =&gt; 2, 'outflow' =&gt; 0, 'open' =&gt; 20.0, 'inflow' =&gt; 0.0, 'max' =&gt; 20, 'close' =&gt; 20.0, 'buy' =&gt; null, 'random_str' =&gt; 'b'],\n];\n\nassert($results === $expected);\n</code></pre>\n<p><em><strong>SQL to create first table</strong></em></p>\n<p>The solution can also be in SQL, if so you can use the following code to create the initial table.</p>\n<p>I am busy trying to implement a solution in BigQuery SQL using a user defined function to keep the logic going too. This would be a nice approach to solving the problem too.</p>\n<pre><code>WITH data AS (\n  SELECT \n    DATE '2023-01-10' as date, 4 as category_a, 1 as category_b, 1 as outflow, 0 as open, 0 as inflow, 10 as max, 0 as close, 0 as buy, 'a' as random_str\n  UNION ALL\n  SELECT \n    DATE '2023-01-20' as date, 4 as category_a, 1 as category_b, 2 as outflow, 0 as open, 0 as inflow, 20 as max, NULL as close, NULL as buy, 'a' as random_str\n  UNION ALL\n  SELECT \n    DATE '2023-01-30' as date, 4 as category_a, 1 as category_b, 10 as outflow, 0 as open, 0 as inflow, 20 as max, NULL as close, NULL as buy, 'a' as random_str\n  UNION ALL\n  SELECT \n    DATE '2023-01-10' as date, 4 as category_a, 2 as category_b, 2 as outflow, 0 as open, 0 as inflow, 10 as max, 0 as close, 0 as buy, 'b' as random_str\n  UNION ALL\n  SELECT \n    DATE '2023-01-20' as date, 4 as category_a, 2 as category_b, 2 as outflow, 0 as open, 0 as inflow, 20 as max, NULL as close, NULL as buy, 'b' as random_str\n  UNION ALL\n  SELECT \n    DATE '2023-01-30' as date, 4 as category_a, 2 as category_b, 0 as outflow, 0 as open, 0 as inflow, 20 as max, NULL as close, NULL as buy, 'b' as random_str\n)\n\nSELECT \n  ROW_NUMBER() OVER (ORDER BY date) as \" \",\n  date,\n  category_a,\n  category_b,\n  outflow,\n  open,\n  inflow,\n  max,\n  close,\n  buy,\n  random_str\nFROM data\n</code></pre>",
  "Title: Why does PhpSpreadsheet fail when reading an Excel file with an error about ReadOnlyWorksheet missing defined names?\nBody: <p>This bug suddenly came up today after reading Excel files was working fine. It fails regardless of which PHP version I use.</p>\n<p>Do folks know the fix?</p>\n<pre><code>  /Users/aizenman/My Drive/code/daily_new_clients/code/run_daily_housekeeping.php:38\n    main()\n  /Users/aizenman/My Drive/code/daily_new_clients/code/run_daily_housekeeping.php:25\n    $sb = Diana\\Superbills::loadSuperbillsBirths($args['site'], $ath);\n  /Users/aizenman/My Drive/code/daily_new_clients/code/diana/Superbills.php:148\n    $spreadsheet = \\PhpOffice\\PhpSpreadsheet\\IOFactory::load(SUPERBILLS_EXCEL);\n    $sheet = $spreadsheet->getSheetByName('Births');\n    // parse dates for columns \"DOS\" and \"DOB\"\n</code></pre>\n<p>The error mentions a ReadOnlyWorksheet not having defined names. How do I resolve this?</p>",
  "Title: Error while iterating over dataframe column entries: \"Call to undefined method Series::iteritems()\"\nBody: <p>Using my dataframe library version 2, I get an error when calling <code>iteritems</code>.</p>\n<pre class=\"lang-php prettyprint-override\"><code>foreach ($column->iteritems() as $eventId => $region) {\n    // ...\n}\n</code></pre>\n<p>The following error message appears:</p>\n<pre><code>Fatal error: Uncaught Error: Call to undefined method Series::iteritems()\n</code></pre>",
  "Title: Call to undefined method PDO::connect() when inserting a dataframe into MySQL\n\nBody: <p>I am trying to store data retrieved from a website into a MySQL database using a dataframe object. When I call my insert helper, it throws: <code>Call to undefined method PDO::connect()</code>. I tested the connection and the table exists, so I don’t think it’s a connection or schema issue. Is there something wrong with the way I’m passing the connection?</p>\n<pre><code>&lt;?php\n$config = parse_ini_file('db_init.ini', true);\n$password = $config['section_a']['Password'];\n$host = $config['section_a']['Host'];\n$database = $config['section_a']['Database'];\n\n$dsn = \"mysql:host={$host};dbname={$database};charset=utf8mb4\";\n$conn = new PDO($dsn, 'root', $password, [\n    PDO::ATTR_ERRMODE =&gt; PDO::ERRMODE_EXCEPTION,\n]);\n\n// $df is a dataframe-like object produced by my scraper\n$dfWriter-&gt;toSql(\"tableName\", $conn, [\n    'if_exists' =&gt; 'append',\n    'index' =&gt; false,\n]);\n</code></pre>\n<p>The full stack trace looks like this:</p>\n<pre><code>Fatal error: Uncaught Error: Call to undefined method PDO::connect()\nin /Users/chent/Desktop/PFSDataParser/src/DbWriter.php:89\nStack trace:\n#0 /Users/chent/Desktop/PFSDataParser/src/FetchPFS.php(287): insert_to_db(...)\n#1 /Users/chent/Desktop/PFSDataParser/src/FetchPFS.php(304): main()\n#2 {main}\n  thrown in /Users/chent/Desktop/PFSDataParser/src/DbWriter.php on line 89\n</code></pre>\n<p>I can run SQL directly through PDO (e.g., <code>CREATE TABLE IF NOT EXISTS</code> and <code>SELECT *</code>), and those work fine.</p>",
  "Title: Alternative to Collection::concat() on empty datasets, now that it’s deprecated?\n\nBody: <p>I have two collections of rows (think dataframe-like data) that can both be empty, and I want to concatenate them.</p>\n<p>Before I could just do:</p>\n<pre><code>$output = $df1-&gt;concat($df2);\n</code></pre>\n<p>But after upgrading my collection library I now get a deprecation notice about concatenating empty collections.</p>\n<p>An easy fix would be:</p>\n<pre><code>if (!$df1-&gt;isEmpty() &amp;&amp; !$df2-&gt;isEmpty()) {\n    $result = $df1-&gt;concat($df2);\n} elseif (!$df1-&gt;isEmpty()) {\n    $result = $df1-&gt;values();\n} elseif (!$df2-&gt;isEmpty()) {\n    $result = $df2-&gt;values();\n} else {\n    $result = collect();\n}\n</code></pre>\n<p>But that seems pretty ugly. Does anyone have a better solution?</p>",
  "Title: PsySH Console Throws \"Object of class ... could not be converted to bool\" error.\nBody: <p>I am new to PHP and use PsySH as my REPL, and I mainly use it for data analysis. A few days ago I reinstalled PsySH for some reasons. Now when I directly enter dataset-related commands (for example, methods that print a summary of a dataset object like <code>$df</code>) in the interactive console, I see an error message after the output (I do get the right output though). It shows:</p>\n<pre><code>Fatal error: Uncaught Error: Object of class ... could not be converted to bool\n</code></pre>\n<p>Weirdly, this only shows up when I attempt to type the commands manually, and only when I use dataset-related commands. When I run the commands from scripts, or even simply use the up arrow key to select commands in the console, the error message won't show; It only shows when I manually type the commands.</p>\n<p>I've looked the error up on the internet but found no discussion. How do I deal with this error?</p>\n<p>I reinstalled PsySH and PHP, but nothing seemed to help.</p>",
  "Title: JpGraph plot, TypeError when rendering graph?\nBody: <p>It was working perfectly earlier but for some reason now I am getting strange errors.</p>\n<p>PHP version: <code>8.2</code></p>\n<p>jpgraph version: <code>4.x</code></p>\n<p>sample data:</p>\n<pre><code>$rows = [\n    ['cap' =&gt; 1, 'Date' =&gt; '2022-01-04'],\n    ['cap' =&gt; 2, 'Date' =&gt; '2022-01-06'],\n    ['cap' =&gt; 3, 'Date' =&gt; '2022-01-07'],\n    ['cap' =&gt; 4, 'Date' =&gt; '2022-01-08'],\n];\n</code></pre>\n<pre><code>use Amenadiel\\JpGraph\\Graph;\nuse Amenadiel\\JpGraph\\Plot;\n\n$x = array_column($rows, 'cap');\n$y = array_column($rows, 'Date');\n\n$graph = new Graph\\Graph(600, 400);\n$graph-&gt;SetScale('textlin');\n\n$graph-&gt;xaxis-&gt;SetTickLabels($y);\n\n$linePlot = new Plot\\LinePlot($x);\n$graph-&gt;Add($linePlot);\n\n$graph-&gt;Stroke();\n</code></pre>\n<p>I get a stack trace:</p>\n<pre class=\"lang-none prettyprint-override\"><code>TypeError\n#0 ...</code></pre>",
  "Title: Deprecation warning about numeric index access when transforming columns in PHP data\n\nBody: <p>I'm running into a deprecation warning in PHP 8.x while transforming columns in a tabular dataset (array of associative arrays).</p>\n<p>I have a list of column names to convert with a custom function. The new values depend on multiple columns, so I map over rows and update each column in-place:</p>\n<pre><code>$columnsToConvert = ['col1','col2','col3'];\n\nforeach ($columnsToConvert as $k) {\n    $rows = array_map(function ($row) use ($k) {\n        $values = [$row[$k], $row['colx']];\n        return convert_my_data(value_1_in: $values[0], value_2_in: $values[1]);\n    }, $rows);\n}\n</code></pre>\n<p>This worked fine before, but now I get a deprecation warning about treating numeric keys as positional access and being required to use explicit keys instead.</p>\n<p>I'm not doing anything fancy with ArrayAccess, and I’m not sure what the “correct” future-proof way to write this is. How should I rewrite this to avoid the deprecation warning?</p>\n<p>Using previous methods in PHP that did work.</p>",
  "Title: Repeat rows in a PHP collection based on a column  \nBody: <p>I have a PHP data set like this (using <code>tightenco/collect</code> Collections):</p>\n<pre><code>$data = collect([\n    ['col1' =&gt; 1, 'col2' =&gt; 4, 'col3' =&gt; 7],\n    ['col1' =&gt; 2, 'col2' =&gt; 5, 'col3' =&gt; 8],\n    ['col1' =&gt; 3, 'col2' =&gt; 6, 'col3' =&gt; 9],\n]);\n\n$data\n// [\n//   ['col1' =&gt; 1, 'col2' =&gt; 4, 'col3' =&gt; 7],\n//   ['col1' =&gt; 2, 'col2' =&gt; 5, 'col3' =&gt; 8],\n//   ['col1' =&gt; 3, 'col2' =&gt; 6, 'col3' =&gt; 9],\n// ]\n</code></pre>\n<p>I would like to create a new collection like this:</p>\n<pre><code>$dataNew\n// [\n//   ['col1' =&gt; 1, 'col2' =&gt; 4, 'col3' =&gt; 7],\n//   ['col1' =&gt; 1, 'col2' =&gt; 5, 'col3' =&gt; 8],\n//   ['col1' =&gt; 1, 'col2' =&gt; 6, 'col3' =&gt; 9],\n//   ['col1' =&gt; 2, 'col2' =&gt; 4, 'col3' =&gt; 7],\n//   ['col1' =&gt; 2, 'col2' =&gt; 5, 'col3' =&gt; 8],\n//   ['col1' =&gt; 2, 'col2' =&gt; 6, 'col3' =&gt; 9],\n//   ['col1' =&gt; 3, 'col2' =&gt; 4, 'col3' =&gt; 7],\n//   ['col1' =&gt; 3, 'col2' =&gt; 5, 'col3' =&gt; 8],\n//   ['col1' =&gt; 3, 'col2' =&gt; 6, 'col3' =&gt; 9],\n// ]\n</code></pre>\n<p>Is there a built-in or combination of built-in Collection methods in PHP that can achieve this?</p>\n<p>Even if there are duplicates in <code>$data</code>, I would like the output to be the same format. In other words:</p>\n<pre><code>$data\n// [\n//   ['col1' =&gt; 1, 'col2' =&gt; 4, 'col3' =&gt; 7],\n//   ['col1' =&gt; 2, 'col2' =&gt; 5, 'col3' =&gt; 8],\n//   ['col1' =&gt; 2, 'col2' =&gt; 6, 'col3' =&gt; 8],\n// ]\n\n$dataNew\n// [\n//   ['col1' =&gt; 1, 'col2' =&gt; 4, 'col3' =&gt; 7],\n//   ['col1' =&gt; 1, 'col2' =&gt; 5, 'col3' =&gt; 8],\n//   ['col1' =&gt; 1, 'col2' =&gt; 6, 'col3' =&gt; 8],\n//   ['col1' =&gt; 2, 'col2' =&gt; 4, 'col3' =&gt; 7],\n//   ['col1' =&gt; 2, 'col2' =&gt; 5, 'col3' =&gt; 8],\n//   ['col1' =&gt; 2, 'col2' =&gt; 6, 'col3' =&gt; 8],\n//   ['col1' =&gt; 2, 'col2' =&gt; 4, 'col3' =&gt; 7],\n//   ['col1' =&gt; 2, 'col2' =&gt; 5, 'col3' =&gt; 8],\n//   ['col1' =&gt; 2, 'col2' =&gt; 6, 'col3' =&gt; 8],\n// ]\n</code></pre>",
  "Title: Correlation calculation fails with non‑numeric value\n\nBody: <p>I’m getting a strange error while trying to calculate a Pearson correlation in Php. I’m following this tutorial for the idea, but implementing it in Php:</p>\n<pre><code>https://www.geeksforgeeks.org/python-pandas-dataframe-corr/\n</code></pre>\n<p>I’m using <code>php-ai/php-ml</code> and calling:</p>\n<pre><code>$corr = \\Phpml\\Math\\Statistic\\Correlation::pearson($x, $y);\n</code></pre>\n<p>The error doesn’t give much detail, just that a string can’t be converted to a float. I thought the correlation method would ignore strings and empty values automatically.</p>\n<pre><code>$x = [1, 2, 3, \"Avery Bradley\", 5];\n$y = [5, 4, 3, 2, 1];\n\n$corr = \\Phpml\\Math\\Statistic\\Correlation::pearson($x, $y);\n</code></pre>",
  "Title: What datatype is considered “list-like” in Php?\nBody: <p>In the documentation for an API that says a parameter accepts <code>set or list-like</code>, what is considered list-like in Php? For a Php associative array <code>$tempDict</code>, would <code>array_keys($tempDict)</code> and <code>array_values($tempDict)</code> be considered list-like?</p>",
  "Title: Can strtoupper/mb_strtoupper produce a longer string than the input?\nBody: <p>I want to uppercase a string in PHP using the mbstring functions, e.g.</p>\n<pre><code>$upper = mb_strtoupper($source, 'UTF-8');\n</code></pre>\n<p>Is the output always the same length as the input? If I were to preallocate a buffer based on the input length, is that always safe?</p>\n<p>If not, can someone provide an example of a string that becomes longer when uppercased (and which locale or language causes it)?</p>",
  "Title: PHP warn or prohibit literal string concatenation  \nBody: <p>Is there a way to warn or prohibit literal string concatenations such as:</p>  \n<pre><code>$a = \"foo\" . \" bar\";\n</code></pre>  \n<p>I spent hours finding a bug in a big static array that had</p>  \n<pre><code>$a = [\"foo\" . \"bar\"];\n</code></pre>  \n<p>instead of</p>  \n<pre><code>$a = [\"foo\", \"bar\"];\n</code></pre>",
  "Title: Is constructing an object in an argument list and passing internal data to a function safe?\nBody: <p>Is the PHP code below well‑formed? Will the temporary object be destroyed before or after the function finishes executing?</p>\n<pre class=\"lang-php prettyprint-override\"><code>function my_function(string $s): void {\n    // ...\n}\n\nclass MyString {\n    public function __construct(private string $data) {}\n    public function c_str(): string { return $this->data; }\n    public function __destruct() { /* ... */ }\n}\n\nmy_function((new MyString(\"Something\"))-&gt;c_str());\n</code></pre>\n<p>I know I could do <code>my_function(\"Something\")</code>, but I am using an object to illustrate the point.</p>",
  "Title: How do I split a string by a character without ignoring trailing separators?\nBody: <p>I have a string similar to the following</p>\n<pre><code>$myString = \"apple,banana,orange,\";\n</code></pre>\n<p>And I want to split by <code>,</code> to produce the output:</p>\n<pre><code>array('apple', 'banana', 'orange', '')\n</code></pre>\n<p>I thought <code>explode</code> would accomplish this but it treats the trailing ',' like it doesn't exist</p>\n<pre><code>$myString = \"apple,banana,orange,\";\n\n$parts = explode(',', $myString);\n// $parts is [\"apple\", \"banana\", \"orange\"]\n</code></pre>\n<p>What is the simplest approach to achieve the desired output?</p>\n<p>Some more test cases with example strings and desired outputs</p>\n<pre><code>$string1 = \"apple,banana,orange,\";\n$output1 = array('apple', 'banana', 'orange', '');\n\n$string2 = \"apple,banana,orange,pear\";\n$output2 = array('apple', 'banana', 'orange', 'pear');\n\n$string3 = \",apple,banana,orange\";\n$output3 = array('', 'apple', 'banana', 'orange');\n\n## Examples of non-comma separated strings\n# '|' separator\n$string4 = \"|apple|banana|orange|\";\n$output4 = array('', 'apple', 'banana', 'orange', '');\n\n# 'x' separator\n$string5 = \"xapplexbananaxorangex\";\n$output5 = array('', 'apple', 'banana', 'orange', '');\n</code></pre>\n<p>EDIT:</p>\n<p>Ideally solution should generalize to any splitting character</p>\n<p>Would also prefer a base-PHP solution (although do still link any packages which supply this functionality since their source code might be useful to look through!)</p>",
  "Title: PHP triple double quotes (three double quotes).\nBody: <p>What is the purpose of triple double quotes <code>&quot;&quot;&quot;</code> in PHP? It seems it is used for multiline text. But why not use a single double-quoted string or a heredoc?</p>\n<pre><code>$text = \"\"\"\n  some text\n  some text\n  some text\n  \"\"\";\n</code></pre>",
  "Title: How to replace characters in a string one at a time generating a new string for each replacement?\n\nBody: <p>I have an array of strings</p>\n<pre><code>array(\n  \"YSAHEEHHYDK\", \"HEHISSDYAGK\", \"TFAHTESHISK\", \"ISLGEHEGGGK\",\n  \"LSSGYDGTSYK\", \"FGTGTYAGGEK\", \"VGASTGYSGLK\", \"TASGVGGFSTK\", \"SYASDFGSSAK\",\n  \"LYSYYSSTESK\"\n)\n</code></pre>\n<p>For each string I want to replace \"Y\", \"S\" or \"T\" with \"pY\", \"pS\" or \"pT\". But I don’t want all the replacements in the same final string; I want each replacement to generate a new string, e.g.</p>\n<p>\"YSAHEEHHYDK\" turns into</p>\n<pre><code>array(\n  \"pYSAHEEHHYDK\",\n  \"YpSAHEEHHYDK\",\n  \"YSAHEEHHpYDK\"\n)\n</code></pre>",
  "Title: How to find the max and min values of comma-separated year strings in a PHP array?\nBody: <p>For each row of my data, I want to get the <em>min</em> and <em>max</em> values and\nthe <em>number of years</em> which are originally stored as a string. For example, consider the following data:</p>\n<pre><code>$data = [\n    ['id' =&gt; 1, 'yr' =&gt; \"1543,860,2023\"],\n    ['id' =&gt; 2, 'yr' =&gt; \"2019,2018,2006,2007\"],\n    ['id' =&gt; 3, 'yr' =&gt; \"1998,2012,2000,2020\"],\n    ['id' =&gt; 4, 'yr' =&gt; \"2000\"],\n];\n</code></pre>\n<p>Output needed:</p>\n<pre><code>id                   yr  min_yr  max_yr  nYears\n 1        1543,860,2023     860    2023       3\n 2  2019,2018,2006,2007    2006    2019       4\n 3  1998,2012,2000,2020    1998    2020       4\n 4                 2000    2000    2000       1\n</code></pre>",
  "Title: Confusing string interning in PHP when building strings with concatenation vs other methods\n\nBody: \n```\n<?php\n$a = implode('', ['Jav']);\ndebug_zval_dump($a);\n\n$c = \"Jav\";\ndebug_zval_dump($c);\n```\n\n```\n<?php\n$a = 'Ja' . 'v';\ndebug_zval_dump($a);\n\n$c = \"Jav\";\ndebug_zval_dump($c);\n```\n\nIn my environment, `debug_zval_dump` shows the first `$a` as `interned` = `no`, but the second `$a` as `interned` = `yes`, while the literal `$c` is always `interned` = `yes`. I expected both `$a` values to be interned the same way. Why does PHP treat these two constructions differently? Can someone explain the difference?\n\nMy PHP version: 8.2.9\n\nI see the same behavior when using `sprintf` instead of `implode`.",
  "Title: How do I create a multiline string in Raku?\nBody: <p>In PHP, you can use heredoc syntax to create multiline strings as shown in the following example:</p>\n<pre class=\"lang-php prettyprint-override\"><code>$html = &lt;&lt;&lt;HTML\n  &lt;div&gt;\n    &lt;p&gt;Raku is &lt;b&gt;ofun&lt;/b&gt;.&lt;/p&gt;\n  &lt;/div&gt;\nHTML;\n</code></pre>\n<p>What's the Raku equivalent of this?</p>",
  "Title: Special case when .= for string concatenation is more efficient than =  \nBody: <p>I have this code using PHP 8.2:</p>\n<pre class=\"lang-php prettyprint-override\"><code>&lt;?php\n$code1 = function () {\n    $initialString = '';\n    for ($i = 0; $i &lt; 10000; $i++) {\n        $initialString = $initialString . 'x' . 'y';\n    }\n};\n\n$code2 = function () {\n    $initialString = '';\n    for ($i = 0; $i &lt; 10000; $i++) {\n        $initialString .= 'x' . 'y';\n    }\n};\n\n$time1 = microtime(true);\nfor ($n = 0; $n &lt; 100; $n++) { $code1(); }\n$time1 = microtime(true) - $time1;\n\n$time2 = microtime(true);\nfor ($n = 0; $n &lt; 100; $n++) { $code2(); }\n$time2 = microtime(true) - $time2;\n\necho $time1 . PHP_EOL;\necho $time2 . PHP_EOL;\n</code></pre>\n<p>Why is <code>.=</code> more efficient <strong>in this case</strong>?  \nAs far as I know, there is the same number of concatenations, and the order of execution doesn't change the result.</p>\n<p>Since strings are immutable, it’s not because of in-place shenanigans, and the only thing I found about string concat is about <code>implode</code> efficiency, but I don't want the most efficient approach, just understand why <code>.=</code> seems more efficient than <code>=</code>.</p>\n<p>With this code, performance between forms almost equals:</p>\n<pre class=\"lang-php prettyprint-override\"><code>&lt;?php\n$code1 = function () {\n    $initialString = '';\n    for ($i = 0; $i &lt; 10000; $i++) {\n        $initialString = $initialString . 'x';\n    }\n};\n\n$code2 = function () {\n    $initialString = '';\n    for ($i = 0; $i &lt; 10000; $i++) {\n        $initialString .= 'x';\n    }\n};\n\n$time1 = microtime(true);\nfor ($n = 0; $n &lt; 100; $n++) { $code1(); }\n$time1 = microtime(true) - $time1;\n\n$time2 = microtime(true);\nfor ($n = 0; $n &lt; 100; $n++) { $code2(); }\n$time2 = microtime(true) - $time2;\n\necho $time1 . PHP_EOL;\necho $time2 . PHP_EOL;\n</code></pre>\n<hr />\n<p>I noticed a difference using different PHP versions (<code>'x' . 'y'</code> form):</p>\n<p>PHP 7.4:</p>\n<pre class=\"lang-php prettyprint-override\"><code>echo $time1 . PHP_EOL; // ~0.6\necho $time2 . PHP_EOL; // ~0.3\n</code></pre>\n<p>PHP 8.0:</p>\n<pre class=\"lang-php prettyprint-override\"><code>echo $time1 . PHP_EOL; // ~1.7\necho $time2 . PHP_EOL; // ~0.8\n</code></pre>\n<p>PHP 8.2 for comparison:</p>\n<pre class=\"lang-php prettyprint-override\"><code>echo $time1 . PHP_EOL; // ~0.6\necho $time2 . PHP_EOL; // ~0.1\n</code></pre>\n<hr />\n<p>Similar but not answering the question: <a href=\"https://stackoverflow.com/questions/69079181/how-is-the-s-sc-string-concat-optimization-decided\">How is the s=s+c string concat optimization decided?</a></p>\n<blockquote>\n<p>If s is a string, then s = s + 'c' might modify the string in place, while t = s + 'c' can't. But how does the operation s + 'c' know which scenario it's in?</p>\n</blockquote>\n<p>In a nutshell: Optimization occurs when <code>s = s . 'c'</code>, not when <code>t = s . 'c'</code> because PHP needs to keep a ref to the first string and can't concatenate in place.</p>\n<p>Here, we are always assigning using simple assignment or augmented assignment to the original string, so in-place concatenation should apply in both cases.</p>",
  "Title: Removing second and subsequent occurrences of decimal point in string.\nBody: <p>I want to remove the second and subsequent occurrences of a decimal point in a string. My attempt is below:</p>\n<pre><code>$str = \"3.99-0.13\";\n\necho preg_replace('/\\./', '', $str);\n// 399-0.13\n\necho str_replace('.', '', $str);\n// 399-013\n</code></pre>\n<p>However, I want the output like <code>3.99-013</code> (keep the first dot, remove the rest). Any hint, please.</p>",
  "Title: Why some characters can’t be edited in PHP strings?\nBody: <p>I’m trying to write my own <code>strcat</code> function in PHP, but it has some problems.<br />\nMy input is two strings <code>$c</code> and <code>$a</code>, and my function will return a string where <code>$c</code> is concatenated with <code>$a</code>.</p>\n<p>For example,<br />\nInput: <code>'abc'</code> <code>'xyz'</code><br />\nExpected Output: <code>'xyzabc'</code><br />\nMy function’s Output: <code>'xyza@▲∩'</code></p>\n<p>My function returns some special characters different from my input.</p>\n<p>I debugged my function and found that:</p>\n<ul>\n<li>When <code>$i = 0</code>, <code>$destination[3]</code> = <code>$source[0]</code> = <code>'a'</code></li>\n<li>But when <code>$i = 1</code>, <code>$destination[8]</code> = <code>$source[1]</code> = <code>'b'</code></li>\n<li>And when <code>$i = 2</code>, <code>$destination[9]</code> = <code>$source[2]</code> = <code>'c'</code></li>\n<li>Finally, <code>$destination[10]</code> = <code>'\\0'</code></li>\n</ul>\n<pre class=\"lang-php prettyprint-override\"><code>&lt;?php\nfunction mystrcat(string $destination, string $source): string {\n    for ($i = 0; $i &lt; strlen($source); $i++) {\n        $destination[strlen($destination) + $i] = $source[$i];\n    }\n    $destination[strlen($destination) + strlen($source)] = \"\\0\";\n    return $destination;\n}\n\n$c = trim(fgets(STDIN));\n$a = trim(fgets(STDIN));\n\n$a = mystrcat($a, $c);\necho $a;\n?&gt;\n</code></pre>",
  "Title: How to prevent a function from accidentally becoming recursive in PHP?\nBody: <p>Consider the following PHP code:</p>\n<pre class=\"lang-php\"><code>&lt;?php\ndeclare(strict_types=1);\n\ninterface KeyStringable extends Stringable {}\n\nfunction get_val_from_db_string(string $key, int &amp;$value): void\n{\n    echo \"Getting value from db with int!\\n\";\n}\n\nfunction get_val_from_db_string_float(string $key, float &amp;$value): void\n{\n    echo \"Getting value from db with float!\\n\";\n}\n\n// wrapper to convert Stringable keys to string\nfunction get_val_from_db($key, &amp;$value): void\n{\n    if ($key instanceof Stringable) {\n        get_val_from_db((string)$key, $value);\n        return;\n    }\n\n    if (is_string($key) &amp;&amp; is_int($value)) {\n        get_val_from_db_string($key, $value);\n        return;\n    }\n\n    if (is_string($key) &amp;&amp; is_float($value)) {\n        get_val_from_db_string_float($key, $value);\n        return;\n    }\n\n    // fallback ends up calling itself again for unsupported types\n    get_val_from_db((string)$key, $value);\n}\n\n$key = \"my key\";\n\n$valInt = 0;\nget_val_from_db($key, $valInt); // OK\n\n$valFloat = 0.0;\nget_val_from_db($key, $valFloat); // OK\n\n$valString = \"\";\nget_val_from_db($key, $valString); // BAD: recursion / stack overflow\n</code></pre>\n<p>I have a function <code>get_val_from_db</code> that receives a key name and a value, with special handling for certain value types, plus a wrapper that accepts <code>Stringable</code> keys and converts them to <code>string</code> so legacy calls keep working.</p>\n<p>The problem is that when a new value type is passed (like <code>string</code>), the wrapper ends up calling itself again and again, leading to recursion and a stack overflow. I could add a new case for every type, but I want this to be safer so unsupported types fail with a clear error instead of being captured by the wrapper.</p>\n<p>I don’t want to remove the <code>Stringable</code> conversion because existing calls depend on it. In summary, how can I prevent the wrapper from being selected for unsupported value types and trigger a proper error instead of recursion?</p>\n<pre class=\"lang-php\"><code>function get_val_from_db($key, &amp;$value): void\n{\n    if ($key instanceof Stringable) {\n        // how do I prevent this from calling itself when $value is unsupported?\n        get_val_from_db((string)$key, $value);\n        return;\n    }\n\n    // ...\n}\n</code></pre>\n<p>I have PHP 8.2 available.</p>",
  "Title: How to find longest continuous contiguous set of characters in a string based on a given array in PHP\nBody: <p>I have the following string in PHP.</p>\n<pre><code>$aas = \"QAWDIIKRIDKK\";\n</code></pre>\n<p>And I want to check the longest continuous fragment of that string that contains the characters in the following array:</p>\n<pre><code>$hydrophobicRes = [\"W\", \"F\", \"I\", \"L\", \"V\", \"M\", \"C\", \"A\", \"G\"];\n</code></pre>\n<p>The answer is:</p>\n<pre><code>AW, II\n</code></pre>\n<p>Other example:</p>\n<pre><code>QFILVMD -> FILVM\n</code></pre>\n<p>How can I do that in PHP?</p>",
  "Title: Obtain palindromic array by performing these operations.\nBody: <p>An array is called palindromic if it remains the same after reversing the order of its elements.</p>\n<p>You have an array of strings <code>$arr</code>. For each <code>$i</code>, <code>$arr[$i]</code> consists of at least two characters. For each pair of consecutive elements <code>$arr[$i]</code> and <code>$arr[$i + 1]</code>, you can:</p>\n<ol>\n<li>Move the rightmost character of <code>$arr[$i]</code> to the leftmost position in <code>$arr[$i + 1]</code>. For instance, &quot;abc&quot; and &quot;def&quot; will become &quot;ab&quot; and &quot;cdef&quot;. This operation can be applied only once to any pair of consecutive elements.</li>\n<li>Move the leftmost character of <code>$arr[$i + 1]</code> to the rightmost position in <code>$arr[$i]</code>. For instance, &quot;abc&quot; and &quot;def&quot; will become &quot;abcd&quot; and &quot;ef&quot;. Again, this operation can be applied only once to any pair of consecutive elements.</li>\n<li>Do nothing to the pair of consecutive elements.</li>\n</ol>\n<p>Is it possible to obtain a palindromic array from <code>$arr</code> by performing these operations?</p>\n<p>Consider the case when <code>$arr = array(&quot;aa&quot;, &quot;bab&quot;, &quot;cde&quot;, &quot;aba&quot;, &quot;ab&quot;)</code>. Here the output should be true and here is why:</p>\n<p>Move first char from 1st index to the last position of 0th index, <code>$arr = array(&quot;aab&quot;, &quot;ab&quot;, &quot;cde&quot;, &quot;aba&quot;, &quot;ab&quot;)</code>\nMove last char from 3rd index to the first position of 4th index, <code>$arr = array(&quot;aab&quot;, &quot;ab&quot;, &quot;cde&quot;, &quot;ab&quot;, &quot;aab&quot;)</code>, which is a palindromic array.</p>\n<p>I tried solutions such as two pointer, etc. but doesn't seem to work.</p>",
  "Title: Prepend leading zeros to each line of a file.\nBody: <p>I have a file that looks like this:</p>\n<pre><code>1:line1\n14:line2\n135:line3\n15:line4\n</code></pre>\n<p>I need to prepend leading zeros to each line to make it look like this:</p>\n<pre><code>00001:line1\n00014:line2\n00135:line3\n00015:line4\n</code></pre>\n<p>Is there an easy way to do this in PHP?</p>\n<p>I tried using:</p>\n<pre><code>$lines = file('file', FILE_IGNORE_NEW_LINES);\nforeach ($lines as $line) {\n    printf(\"%05d:%s\\n\", $i, $line);\n}\n</code></pre>\n<p>but this outputs:</p>\n<pre><code>00001:1:line1\n00002:14:line2\n00003:135:line3\n00004:15:line4\n</code></pre>\n<p>I should note I did not write this code, I got it from Google and don't really understand how it works.</p>",
  "Title: Capture the last word on each line.\nBody: <p>I have a file that doesn't have the correct spacing and I would like to add a space between the dollar amount and the word right beside it, i.e., <code>2342.20Hello</code>.</p>\n<p>I tried using <code>preg_replace</code> in PHP to resolve this issue but it didn't seem to work.</p>\n<p>I tried this code but it doesn't seem to work.</p>\n<pre><code>$text = file_get_contents('/tmp/testfile2.txt');\n$text = preg_replace('/([0-9].*)\\.([a-zA-Z].*) /', '$1 $2', $text);\nfile_put_contents('/tmp/testfile2.txt', $text);\n</code></pre>\n<p>I was expecting the file that has:</p>\n<pre><code>2234.3Hello\n8938.3HeyYou\n1239.0New\n</code></pre>\n<p>To look like this:</p>\n<pre><code>2234.3 Hello\n8938.3 HeyYou\n1239.0 New\n</code></pre>\n<p>I'm okay with <code>PHP</code> or <code>Perl</code> commands to accomplish the above.</p>",
  "Title: Fast and efficient substring extraction and comparison in PHP\nBody: <p>I have a problem concerning very fast and efficient comparison between the substrings of two strings in my dataset, which won't run fast enough despite pretty powerful machinery.\nI have a dataset with 2 columns and about 1.5 billion rows, which has this structure:</p>\n<pre><code>$dt = [\n  [\"class1\" => \"002134\", \"class2\" => \"002003\"],\n  [\"class1\" => \"024345\", \"class2\" => \"024234\"],\n  [\"class1\" => \"176234\", \"class2\" => \"002004\"],\n];\n</code></pre>\n<p>What I want is a function that (1) extracts the first 3 digits from each string by row for both vectors, (2) compares the substrings between the two vectors, and (3) creates a new boolean field that reports whether the two substrings are equal or not.</p>\n<p>So the desired result is as follows:</p>\n<pre><code>$dt[0][\"sameclass\"] = true;\n$dt[1][\"sameclass\"] = true;\n$dt[2][\"sameclass\"] = false;\n\nprint_r($dt);\n/*\nArray\n(\n    [0] => Array ( [class1] => 002134 [class2] => 002003 [sameclass] => 1 )\n    [1] => Array ( [class1] => 024345 [class2] => 024234 [sameclass] => 1 )\n    [2] => Array ( [class1] => 176234 [class2] => 002004 [sameclass] => )\n)\n*/\n</code></pre>\n<p>I have tried multiple approaches using <code>substr</code>, custom functions, and even comparing numeric prefixes (e.g., integer division by 1000). However, the bottleneck still seems to be the substring extraction and the loop over rows.</p>\n<p>All versions either run into memory problems or take several hours to a day to run. Since I need to do this repeatedly this does not work for me, and I wanted to ask if you can come up with something faster/ more efficient. Any help would be greatly appreciated!</p>\n<p><strong>EDIT</strong></p>\n<p>I have benchmarked some of the methods suggested here, which indeed show a substantial speedup:</p>\n<pre><code>$dt = [];\nfor ($i = 0; $i < 1000; $i++) {\n  $dt[] = [\"class1\" => \"002134\", \"class2\" => \"002003\"];\n  $dt[] = [\"class1\" => \"024345\", \"class2\" => \"024234\"];\n  $dt[] = [\"class1\" => \"176234\", \"class2\" => \"002004\"];\n}\n\n// Example benchmark ideas:\n// 1) starts_with style check using substr\n// 2) compare substrings from both columns\n// 3) numeric prefix comparison\n\n// Please provide PHP code for a fast, memory-efficient approach,\n// and a simple benchmarking harness if possible.\n</code></pre>\n<p>I will go with the fastest approach that is compatible with a restricted server (no extensions beyond standard PHP). Thank you for the help!</p>",
  "Title: Sorting words from $argv by length  \nBody: <p>I'm attempting to read words from the command line using <code>$argv</code> in PHP and then sort them in descending order based on their lengths. However, my sorting algorithm is producing unexpected output.</p>\n<p>The code I'm using is as follows:</p>\n<pre><code>&lt;?php\n\nfor ($i = 1; $i &lt; $argc - 1; $i++) {\n    for ($j = 1; $j &lt; $argc - $i - 1; $j++) {\n        if (strlen($argv[$j]) &lt; strlen($argv[$j + 1])) {\n            $temp_word = $argv[$j];\n            $argv[$j] = $argv[$j + 1];\n            $argv[$j + 1] = $temp_word;\n        }\n    }\n}\n\necho \"\\n\";\nfor ($i = 1; $i &lt; $argc; $i++) {\n    echo $argv[$i] . \" \";\n}\n</code></pre>\n<pre><code>php test.php I put this words\n\n\npuwordI wordI I  % \n</code></pre>\n<p>Unfortunately, the output is corrupted. I suspect there might be an issue with my sorting logic or how I'm handling the command line arguments. Could someone please review my code and provide guidance on how to correctly sort the words by length?</p>",
  "Title: why is array concatenation treated differently when returned from a function vs a literal in php?\nBody: <p><code>php MyStringsTest.php</code></p>\n<pre><code>&lt;?php\nfunction slist() { return [\"1\", \"2\", \"3\"]; }\n\nuse PHPUnit\\Framework\\TestCase;\n\nfinal class StringTests extends TestCase\n{\n    public function testLiteralJoin()\n    {\n        $this-&gt;assertSame(\"1,2,3\", implode(\",\", [\"1\", \"2\", \"3\"]));\n    }\n\n    public function testLiteralJoinWithArray()\n    {\n        $this-&gt;assertSame(\"1,2,3\", implode(\",\", [\"1\", \"2\", \"3\"]));\n    }\n\n    public function testSlistReturnsArrayOfStrings()\n    {\n        $this-&gt;assertSame([\"1\", \"2\", \"3\"], slist());\n    }\n\n    public function testSlistJoin()\n    {\n        $this-&gt;assertSame(\"1,2,3\", slist());\n    }\n}\n</code></pre>\n<p><code>phpunit MyStringsTest.php</code></p>\n<pre><code>Tests: 4, Assertions: 4, Failures: 1.\nThere was 1 failure:\n\n1) StringTests::testSlistJoin\nFailed asserting that Array (...) is identical to '1,2,3'.\n</code></pre>\n<p>Why is the array treated differently when it comes from a function return vs when it's literally declared?</p>"
]